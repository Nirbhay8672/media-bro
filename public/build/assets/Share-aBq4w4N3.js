import{d as ve,p as E,c as J,a as x,o as w,b as A,f as n,e as $,h as be,g as K,k as Z,F as Q,r as ue,t as W,y as xe,n as M,D as we,E as ke}from"./app-BQiOSmYb.js";import{S as N}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{T as Pe,U as fe}from"./upload-CZGfYEkh.js";import{I as he,X as _e}from"./x-C4kSYos3.js";import{c as me}from"./createLucideIcon--ecsWlj0.js";import{P as Se}from"./plus-BLlo46Xm.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=me("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=me("MinusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var de={exports:{}},ye;function Ue(){return ye||(ye=1,(function(ee){(function(P){var y=ae(),B=ne(),L=ie(),z=se(),F={imagePlaceholder:void 0,cacheBust:!1},b={toSvg:X,toPng:re,toJpeg:q,toBlob:H,toPixelData:ge,impl:{fontFaces:L,images:z,util:y,inliner:B,options:{}}};ee.exports=b;function X(i,a){return a=a||{},Y(a),Promise.resolve(i).then(function(u){return O(u,a.filter,!0)}).then(G).then(te).then(s).then(function(u){return oe(u,a.width||y.width(i),a.height||y.height(i))});function s(u){return a.bgcolor&&(u.style.backgroundColor=a.bgcolor),a.width&&(u.style.width=a.width+"px"),a.height&&(u.style.height=a.height+"px"),a.style&&Object.keys(a.style).forEach(function(f){u.style[f]=a.style[f]}),u}}function ge(i,a){return j(i,a||{}).then(function(s){return s.getContext("2d").getImageData(0,0,y.width(i),y.height(i)).data})}function re(i,a){return j(i,a||{}).then(function(s){return s.toDataURL()})}function q(i,a){return a=a||{},j(i,a).then(function(s){return s.toDataURL("image/jpeg",a.quality||1)})}function H(i,a){return j(i,a||{}).then(y.canvasToBlob)}function Y(i){typeof i.imagePlaceholder>"u"?b.impl.options.imagePlaceholder=F.imagePlaceholder:b.impl.options.imagePlaceholder=i.imagePlaceholder,typeof i.cacheBust>"u"?b.impl.options.cacheBust=F.cacheBust:b.impl.options.cacheBust=i.cacheBust}function j(i,a){return X(i,a).then(y.makeImage).then(y.delay(100)).then(function(u){var f=s(i);return f.getContext("2d").drawImage(u,0,0),f});function s(u){var f=document.createElement("canvas");if(f.width=a.width||y.width(u),f.height=a.height||y.height(u),a.bgcolor){var p=f.getContext("2d");p.fillStyle=a.bgcolor,p.fillRect(0,0,f.width,f.height)}return f}}function O(i,a,s){if(!s&&a&&!a(i))return Promise.resolve();return Promise.resolve(i).then(u).then(function(l){return f(i,l,a)}).then(function(l){return p(i,l)});function u(l){return l instanceof HTMLCanvasElement?y.makeImage(l.toDataURL()):l.cloneNode(!1)}function f(l,d,r){var t=l.childNodes;if(t.length===0)return Promise.resolve(d);return e(d,y.asArray(t),r).then(function(){return d});function e(g,v,_){var S=Promise.resolve();return v.forEach(function(I){S=S.then(function(){return O(I,_)}).then(function(C){C&&g.appendChild(C)})}),S}}function p(l,d){if(!(d instanceof Element))return d;return Promise.resolve().then(r).then(t).then(e).then(g).then(function(){return d});function r(){v(window.getComputedStyle(l),d.style);function v(_,S){_.cssText?S.cssText=_.cssText:I(_,S);function I(C,U){y.asArray(C).forEach(function(o){U.setProperty(o,C.getPropertyValue(o),C.getPropertyPriority(o))})}}}function t(){[":before",":after"].forEach(function(_){v(_)});function v(_){var S=window.getComputedStyle(l,_),I=S.getPropertyValue("content");if(I===""||I==="none")return;var C=y.uid();d.className=d.className+" "+C;var U=document.createElement("style");U.appendChild(o(C,_,S)),d.appendChild(U);function o(c,m,h){var k="."+c+":"+m,T=h.cssText?le(h):ce(h);return document.createTextNode(k+"{"+T+"}");function le(D){var R=D.getPropertyValue("content");return D.cssText+" content: "+R+";"}function ce(D){return y.asArray(D).map(R).join("; ")+";";function R(V){return V+": "+D.getPropertyValue(V)+(D.getPropertyPriority(V)?" !important":"")}}}}}function e(){l instanceof HTMLTextAreaElement&&(d.innerHTML=l.value),l instanceof HTMLInputElement&&d.setAttribute("value",l.value)}function g(){d instanceof SVGElement&&(d.setAttribute("xmlns","http://www.w3.org/2000/svg"),d instanceof SVGRectElement&&["width","height"].forEach(function(v){var _=d.getAttribute(v);_&&d.style.setProperty(v,_)}))}}}function G(i){return L.resolveAll().then(function(a){var s=document.createElement("style");return i.appendChild(s),s.appendChild(document.createTextNode(a)),i})}function te(i){return z.inlineAll(i).then(function(){return i})}function oe(i,a,s){return Promise.resolve(i).then(function(u){return u.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(u)}).then(y.escapeXhtml).then(function(u){return'<foreignObject x="0" y="0" width="100%" height="100%">'+u+"</foreignObject>"}).then(function(u){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+a+'" height="'+s+'">'+u+"</svg>"}).then(function(u){return"data:image/svg+xml;charset=utf-8,"+u})}function ae(){return{escape:g,parseExtension:a,mimeType:s,dataAsUrl:e,isDataUrl:u,canvasToBlob:p,resolveUrl:l,getAndEncode:t,uid:d(),delay:v,asArray:_,escapeXhtml:S,makeImage:r,width:I,height:C};function i(){var o="application/font-woff",c="image/jpeg";return{woff:o,woff2:o,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:c,jpeg:c,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function a(o){var c=/\.([^\.\/]*?)$/g.exec(o);return c?c[1]:""}function s(o){var c=a(o).toLowerCase();return i()[c]||""}function u(o){return o.search(/^(data:)/)!==-1}function f(o){return new Promise(function(c){for(var m=window.atob(o.toDataURL().split(",")[1]),h=m.length,k=new Uint8Array(h),T=0;T<h;T++)k[T]=m.charCodeAt(T);c(new Blob([k],{type:"image/png"}))})}function p(o){return o.toBlob?new Promise(function(c){o.toBlob(c)}):f(o)}function l(o,c){var m=document.implementation.createHTMLDocument(),h=m.createElement("base");m.head.appendChild(h);var k=m.createElement("a");return m.body.appendChild(k),h.href=c,k.href=o,k.href}function d(){var o=0;return function(){return"u"+c()+o++;function c(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function r(o){return new Promise(function(c,m){var h=new Image;h.onload=function(){c(h)},h.onerror=m,h.src=o})}function t(o){var c=3e4;return b.impl.options.cacheBust&&(o+=(/\?/.test(o)?"&":"?")+new Date().getTime()),new Promise(function(m){var h=new XMLHttpRequest;h.onreadystatechange=le,h.ontimeout=ce,h.responseType="blob",h.timeout=c,h.open("GET",o,!0),h.send();var k;if(b.impl.options.imagePlaceholder){var T=b.impl.options.imagePlaceholder.split(/,/);T&&T[1]&&(k=T[1])}function le(){if(h.readyState===4){if(h.status!==200){k?m(k):D("cannot fetch resource: "+o+", status: "+h.status);return}var R=new FileReader;R.onloadend=function(){var V=R.result.split(/,/)[1];m(V)},R.readAsDataURL(h.response)}}function ce(){k?m(k):D("timeout of "+c+"ms occured while fetching resource: "+o)}function D(R){console.error(R),m("")}})}function e(o,c){return"data:"+c+";base64,"+o}function g(o){return o.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function v(o){return function(c){return new Promise(function(m){setTimeout(function(){m(c)},o)})}}function _(o){for(var c=[],m=o.length,h=0;h<m;h++)c.push(o[h]);return c}function S(o){return o.replace(/#/g,"%23").replace(/\n/g,"%0A")}function I(o){var c=U(o,"border-left-width"),m=U(o,"border-right-width");return o.scrollWidth+c+m}function C(o){var c=U(o,"border-top-width"),m=U(o,"border-bottom-width");return o.scrollHeight+c+m}function U(o,c){var m=window.getComputedStyle(o).getPropertyValue(c);return parseFloat(m.replace("px",""))}}function ne(){var i=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:f,shouldProcess:a,impl:{readUrls:s,inline:u}};function a(p){return p.search(i)!==-1}function s(p){for(var l=[],d;(d=i.exec(p))!==null;)l.push(d[1]);return l.filter(function(r){return!y.isDataUrl(r)})}function u(p,l,d,r){return Promise.resolve(l).then(function(e){return d?y.resolveUrl(e,d):e}).then(r||y.getAndEncode).then(function(e){return y.dataAsUrl(e,y.mimeType(l))}).then(function(e){return p.replace(t(l),"$1"+e+"$3")});function t(e){return new RegExp(`(url\\(['"]?)(`+y.escape(e)+`)(['"]?\\))`,"g")}}function f(p,l,d){if(r())return Promise.resolve(p);return Promise.resolve(p).then(s).then(function(t){var e=Promise.resolve(p);return t.forEach(function(g){e=e.then(function(v){return u(v,g,l,d)})}),e});function r(){return!a(p)}}}function ie(){return{resolveAll:i,impl:{readAll:a}};function i(){return a().then(function(s){return Promise.all(s.map(function(u){return u.resolve()}))}).then(function(s){return s.join(`
`)})}function a(){return Promise.resolve(y.asArray(document.styleSheets)).then(u).then(s).then(function(p){return p.map(f)});function s(p){return p.filter(function(l){return l.type===CSSRule.FONT_FACE_RULE}).filter(function(l){return B.shouldProcess(l.style.getPropertyValue("src"))})}function u(p){var l=[];return p.forEach(function(d){try{y.asArray(d.cssRules||[]).forEach(l.push.bind(l))}catch(r){console.log("Error while reading CSS rules from "+d.href,r.toString())}}),l}function f(p){return{resolve:function(){var d=(p.parentStyleSheet||{}).href;return B.inlineAll(p.cssText,d)},src:function(){return p.style.getPropertyValue("src")}}}}}function se(){return{inlineAll:a,impl:{newImage:i}};function i(s){return{inline:u};function u(f){return y.isDataUrl(s.src)?Promise.resolve():Promise.resolve(s.src).then(f||y.getAndEncode).then(function(p){return y.dataAsUrl(p,y.mimeType(s.src))}).then(function(p){return new Promise(function(l,d){s.onload=l,s.onerror=d,s.src=p})})}}function a(s){if(!(s instanceof Element))return Promise.resolve(s);return u(s).then(function(){return s instanceof HTMLImageElement?i(s).inline():Promise.all(y.asArray(s.childNodes).map(function(f){return a(f)}))});function u(f){var p=f.style.getPropertyValue("background");return p?B.inlineAll(p).then(function(l){f.style.setProperty("background",l,f.style.getPropertyPriority("background"))}).then(function(){return f}):Promise.resolve(f)}}}})()})(de)),de.exports}var pe=Ue();const Ie={class:"mx-auto px-4 py-6 sm:px-6 lg:px-8"},Te={class:"grid gap-6 lg:grid-cols-4"},Ae={class:"lg:col-span-1"},$e={class:"space-y-4 max-h-[calc(100vh-2rem)] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600"},Be={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},De={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Re={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Me={class:"p-4 space-y-4"},Fe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},je=["onUpdate:modelValue","placeholder"],Oe={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},We={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Le={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Xe={class:"p-4"},ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},He={class:"space-y-2"},Ne=["id","onChange"],Ye={key:0},Ve=["for"],qe={class:"flex flex-col items-center justify-center py-3"},Ge={key:1,class:"relative group"},Je=["src","alt"],Ke=["onClick"],Ze={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Qe={class:"p-4 border-b border-gray-200 dark:border-gray-700"},er={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},rr={class:"p-4 space-y-4"},tr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},or={class:"flex items-center gap-3"},ar=["disabled"],nr={class:"flex-1"},ir=["value"],sr=["disabled"],lr={class:"lg:col-span-3"},cr={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},ur={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},dr={class:"text-lg font-semibold text-gray-900 dark:text-white"},pr=["disabled"],gr={class:"p-4"},fr={class:"flex justify-center items-start min-h-[400px]"},hr={class:"relative",style:{margin:"20px 0"}},yr=["onMousedown"],mr=["onMousedown"],vr=["src","alt","onClick","onMousedown"],br={key:1,class:"flex flex-col items-center justify-center text-gray-500 text-sm text-center p-2"},Cr=ve({__name:"Share",props:{template:{}},setup(ee){const P=ee,y=E(null),B=E(!1);E(!1),E("");const L=E(null);E(.5),E(0),E(0),E(1);const z=E(!1),F=E({x:0,y:0,posX:0,posY:0}),b=E(null),X=E([]);(()=>{let r;if(Array.isArray(P.template.canvas_data))r=P.template.canvas_data;else if(typeof P.template.canvas_data=="string")try{r=JSON.parse(P.template.canvas_data)}catch{r=[]}else r=[];const t=r.filter(e=>e.type==="image");t.length>0&&console.log("Template image elements:",t),X.value=r.map(e=>({...e,properties:{text:e.properties?.text||"",fontSize:e.properties?.fontSize||16,fontFamily:e.properties?.fontFamily||"Arial",fontWeight:e.properties?.fontWeight||"normal",fontStyle:e.properties?.fontStyle||"normal",textDecoration:e.properties?.textDecoration||"none",textAlign:e.properties?.textAlign||"left",lineHeight:e.properties?.lineHeight||1.2,color:e.properties?.color||"#000000",backgroundColor:e.properties?.backgroundColor||(e.type==="text"?"transparent":"#f3f4f6"),hasBorder:e.properties?.hasBorder||!1,borderWidth:e.properties?.borderWidth||1,borderColor:e.properties?.borderColor||"#000000",borderStyle:e.properties?.borderStyle||"solid",borderRadius:e.properties?.borderRadius||0,boxShadow:e.properties?.boxShadow||"none",textShadow:e.properties?.textShadow||"none",imageUrl:e.properties?.imageUrl||"",imageFit:e.properties?.imageFit||"cover",imagePlaceholder:e.properties?.imagePlaceholder||(e.type==="image"?"Click to upload image":""),imageShape:e.properties?.imageShape||"rectangle"}}))})();const re=J(()=>[...X.value].sort((r,t)=>r.zIndex-t.zIndex)),q=J(()=>X.value.filter(r=>r.type==="text")),H=J(()=>X.value.filter(r=>r.type==="image")),Y=E(!1),j=E({x:0,y:0}),O=E(null),G=(r,t)=>{y.value=t,t.type!=="image"&&(b.value=null),t.type==="text"&&(r.preventDefault(),Y.value=!0,j.value={x:r.clientX-t.x,y:r.clientY-t.y},O.value=t)},te=r=>{Y.value&&O.value&&(O.value.x=r.clientX-j.value.x,O.value.y=r.clientY-j.value.y)},oe=r=>{Y.value=!1,O.value=null},ae=r=>{switch(r){case"circle":return"circle(50% at 50% 50%)";case"triangle":return"polygon(50% 0%, 0% 100%, 100% 100%)";case"star":return"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)";case"diamond":return"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)";case"hexagon":return"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)";case"octagon":return"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)";case"rectangle":default:return"none"}},ne=J(()=>{const e=800/P.template.width,g=600/P.template.height,v=Math.min(e,g,1);return{width:P.template.width+"px",height:P.template.height+"px",transform:`scale(${v})`,transformOrigin:"top center",backgroundImage:P.template.background_image_url?`url(${P.template.background_image_url})`:P.template.background_image?`url(/storage/${P.template.background_image})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),ie=(r,t)=>{const e=r.target.files?.[0];if(!e)return;if(!e.type.startsWith("image/")){alert("Please select a valid image file.");return}if(e.size>10*1024*1024){alert("File size must be less than 10MB.");return}const g=URL.createObjectURL(e);t.properties.imageUrl=g,t.properties.cropScale||(t.properties.cropScale=1),t.properties.cropPositionX||(t.properties.cropPositionX=0),t.properties.cropPositionY||(t.properties.cropPositionY=0),t.uploadedFile=e},se=r=>{const t=r.properties.cropScale||1,e=Math.min(t+.1,3);r.properties.cropScale=e},i=r=>{const t=r.properties.cropScale||1,e=Math.max(t-.1,.5);r.properties.cropScale=e},a=(r,t)=>{r.properties.cropScale=Math.max(.5,Math.min(3,t))},s=(r,t)=>{r.stopPropagation(),b.value=t},u=(r,t)=>{r.stopPropagation(),z.value=!0,L.value=t,b.value=t,F.value={x:r.clientX,y:r.clientY,posX:t.properties.cropPositionX||0,posY:t.properties.cropPositionY||0}},f=r=>{if(!z.value||!L.value)return;const t=r.clientX-F.value.x,e=r.clientY-F.value.y,g=F.value.posX+t,v=F.value.posY+e;L.value.properties.cropPositionX=g,L.value.properties.cropPositionY=v},p=()=>{z.value=!1},l=r=>{r.properties.imageUrl&&r.properties.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(r.properties.imageUrl),r.properties.imageUrl="",r.uploadedFile=null},d=async()=>{B.value=!0,N.fire({title:"Generating Image...",text:"Please wait while we create your image.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{N.showLoading()}});try{const r=document.querySelector(".template-preview-container");if(!r)throw new Error("Preview container not found");await(async()=>{const I=r.querySelectorAll("img"),C=Array.from(I).map(async(U,o)=>{if(U.src.startsWith("blob:"))try{const c=await fetch(U.src);if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const m=await c.blob();return new Promise(h=>{const k=new FileReader;k.onload=()=>{U.src=k.result,h(!0)},k.onerror=()=>{h(!1)},k.readAsDataURL(m)})}catch{return!1}else return!0});await Promise.all(C)})();let e;const g=P.template.width,v=P.template.height;try{const C=g*4,U=v*4;e=await pe.toPng(r,{quality:1,bgcolor:"#ffffff",width:C,height:U,style:{transform:"scale(4)",transformOrigin:"top left",width:g+"px",height:v+"px",imageRendering:"crisp-edges"},pixelRatio:4,cacheBust:!0,filter:o=>!0,useCORS:!0,allowTaint:!0})}catch{try{e=await pe.toPng(r,{quality:1,bgcolor:"#ffffff",width:g*2,height:v*2,style:{transform:"scale(2)",transformOrigin:"top left",width:g+"px",height:v+"px"},pixelRatio:3,cacheBust:!0,useCORS:!0})}catch{e=await pe.toPng(r,{quality:1,bgcolor:"#ffffff",width:g,height:v,pixelRatio:2,cacheBust:!0})}}const _=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),S=document.createElement("a");S.href=e,S.download=`${P.template.name}_${_}.png`,document.body.appendChild(S),S.click(),document.body.removeChild(S);try{const I=await fetch(`/template/${P.template.share_token}/track-download`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json"},body:JSON.stringify({file_name:`${P.template.name}_${_}.png`,file_size:e.length})})}catch{}N.close(),N.fire({icon:"success",title:"Download Complete!",text:"Your image has been downloaded successfully.",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(r){N.close();let t="Unknown error occurred while generating image.";r.message?t=r.message:r.name==="SecurityError"?t="Security error: Cannot access the preview element. Please try refreshing the page.":r.name==="InvalidStateError"?t="Invalid state error: The preview element may not be ready. Please try again.":r.toString().includes("canvas")&&(t="Canvas rendering error: Please check if all images are loaded and try again."),N.fire({icon:"error",title:"Download Failed",text:t,confirmButtonText:"Try Again"})}finally{B.value=!1}};return(r,t)=>(w(),x(Q,null,[A($(be),{title:r.template.name},null,8,["title"]),n("div",{class:"min-h-screen bg-gray-50 dark:bg-gray-900",onMouseup:p,onMousemove:f},[n("div",Ie,[n("div",Te,[n("div",Ae,[n("div",$e,[q.value.length>0?(w(),x("div",Be,[n("div",De,[n("h2",Re,[A($(Pe),{class:"h-5 w-5"}),t[3]||(t[3]=Z(" Text Content ",-1))])]),n("div",Me,[(w(!0),x(Q,null,ue(q.value,(e,g)=>(w(),x("div",{key:e.id,class:"space-y-2"},[n("label",Fe," Text "+W(g+1),1),we(n("textarea",{"onUpdate:modelValue":v=>e.properties.text=v,rows:"2",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm",placeholder:`Enter text ${g+1}`},null,8,je),[[ke,e.properties.text]])]))),128))])])):K("",!0),H.value.length>0?(w(),x("div",Oe,[n("div",We,[n("h2",Le,[A($(he),{class:"h-5 w-5"}),Z(" Image Upload ("+W(H.value.length)+") ",1)])]),n("div",Xe,[n("div",{class:xe(["grid gap-3",H.value.length>3?"grid-cols-2":"grid-cols-1"])},[(w(!0),x(Q,null,ue(H.value,(e,g)=>(w(),x("div",{key:e.id,class:"space-y-2"},[n("label",ze," Image "+W(g+1),1),n("div",He,[n("input",{id:`image-${e.id}`,type:"file",accept:"image/*",onChange:v=>ie(v,e),class:"hidden"},null,40,Ne),e.properties.imageUrl?(w(),x("div",Ge,[n("img",{src:e.properties.imageUrl,alt:`Image ${g+1}`,class:"w-full h-20 object-cover rounded-lg border border-gray-300 dark:border-gray-600"},null,8,Je),n("button",{type:"button",onClick:v=>l(e),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100"},[A($(_e),{class:"w-3 h-3"})],8,Ke)])):(w(),x("div",Ye,[n("label",{for:`image-${e.id}`,class:"flex flex-col items-center justify-center w-full h-20 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"},[n("div",qe,[A($(fe),{class:"w-5 h-5 mb-1 text-gray-500 dark:text-gray-400"}),t[4]||(t[4]=n("p",{class:"text-xs text-gray-500 dark:text-gray-400"},[n("span",{class:"font-semibold"},"Upload")],-1))])],8,Ve)]))])]))),128))],2)])])):K("",!0),b.value&&b.value.properties.imageUrl?(w(),x("div",Ze,[n("div",Qe,[n("h2",er,[A($(he),{class:"h-5 w-5"}),t[5]||(t[5]=Z(" Image Controls ",-1))])]),n("div",rr,[n("div",null,[n("label",tr," Zoom: "+W(Math.round((b.value.properties.cropScale||1)*100))+"% ",1),n("div",or,[n("button",{onClick:t[0]||(t[0]=e=>i(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",disabled:(b.value.properties.cropScale||1)<=.5},[A($(Ee),{class:"w-4 h-4"})],8,ar),n("div",nr,[n("input",{type:"range",value:b.value.properties.cropScale||1,onInput:t[1]||(t[1]=e=>a(b.value,parseFloat(e.target.value))),min:"0.5",max:"3",step:"0.1",class:"w-full"},null,40,ir)]),n("button",{onClick:t[2]||(t[2]=e=>se(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",disabled:(b.value.properties.cropScale||1)>=3},[A($(Se),{class:"w-4 h-4"})],8,sr)])]),t[6]||(t[6]=n("div",{class:"text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg"},[n("p",{class:"font-medium mb-1"},"How to use:"),n("ul",{class:"space-y-1"},[n("li",null,"• Click and drag the image to position it"),n("li",null,"• Use zoom controls to adjust the size"),n("li",null,"• The image will be cropped to the shape")])],-1))])])):K("",!0)])]),n("div",lr,[n("div",cr,[n("div",ur,[n("h2",dr,W(r.template.name),1),n("button",{onClick:d,disabled:B.value,class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"},[A($(Ce),{class:"h-4 w-4"}),Z(" "+W(B.value?"Generating...":"Download Image"),1)],8,pr)]),n("div",gr,[n("div",fr,[n("div",hr,[n("div",{class:"template-preview-container relative overflow-hidden bg-gray-50 dark:bg-gray-700 shadow-lg",style:M(ne.value),onMousemove:te,onMouseup:oe},[(w(!0),x(Q,null,ue(re.value,e=>(w(),x("div",{key:e.id,class:"absolute",style:M({left:e.x+"px",top:e.y+"px",width:e.width+"px",height:e.height+"px",zIndex:e.zIndex,transform:`rotate(${e.rotation}deg)`,filter:e.properties.boxShadow!=="none"?`drop-shadow(${e.properties.boxShadow})`:"none"})},[e.type==="text"?(w(),x("div",{key:0,class:"w-full h-full flex items-center justify-center cursor-move select-none",style:M({color:e.properties.color,backgroundColor:e.properties.backgroundColor,fontSize:e.properties.fontSize+"px",fontFamily:e.properties.fontFamily,fontWeight:e.properties.fontWeight,fontStyle:e.properties.fontStyle,textDecoration:e.properties.textDecoration,textAlign:e.properties.textAlign,lineHeight:e.properties.lineHeight,border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.borderRadius+"px"}),onMousedown:g=>G(g,e)},W(e.properties.text||"Your text here"),45,yr)):e.type==="image"?(w(),x("div",{key:1,class:"w-full h-full flex items-center justify-center overflow-hidden relative group",style:M({backgroundColor:e.properties.backgroundColor||"transparent",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.imageShape==="rectangle"?(e.properties.borderRadius||0)+"px":"0px",clipPath:ae(e.properties.imageShape||"rectangle")}),onMousedown:g=>G(g,e)},[e.properties.imageUrl?(w(),x("img",{key:0,src:e.properties.imageUrl,alt:e.properties.imagePlaceholder,class:"absolute cursor-move select-none",style:M({width:"auto",height:"auto",maxWidth:"none",maxHeight:"none",objectFit:"none",transform:e.properties.cropScale?`translate(-50%, -50%) scale(${e.properties.cropScale}) translate(${e.properties.cropPositionX||0}px, ${e.properties.cropPositionY||0}px)`:"translate(-50%, -50%)",top:"50%",left:"50%",transformOrigin:"center"}),onClick:g=>s(g,e),onMousedown:g=>u(g,e)},null,44,vr)):(w(),x("div",br,[A($(fe),{class:"h-8 w-8 mb-2"}),n("span",null,W(e.properties.imagePlaceholder),1)]))],44,mr)):e.type==="rectangle"?(w(),x("div",{key:2,class:"w-full h-full",style:M({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:(e.properties.borderRadius||0)+"px"})},null,4)):e.type==="circle"?(w(),x("div",{key:3,class:"w-full h-full rounded-full",style:M({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none"})},null,4)):e.type==="triangle"?(w(),x("div",{key:4,class:"w-full h-full",style:M({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 0% 100%, 100% 100%)"})},null,4)):e.type==="star"?(w(),x("div",{key:5,class:"w-full h-full",style:M({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)"})},null,4)):K("",!0)],4))),128))],36)])])])])])])])],32)],64))}});export{Cr as default};
