import{d as Ve,j as y,k as re,c as se,m as Ze,a as c,o as p,f as e,b as a,i as me,g as S,e as o,w as i,p as v,q as H,v as O,F as ae,r as ue,n as oe,t as q,s as ne,x as G,y as je,z as ge,A as Le,h as Je,T as et}from"./app-mDDMLug4.js";import{F as Ge,_ as tt}from"./AppLayout.vue_vue_type_script_setup_true_lang-BMBf6Jb5.js";import{_ as Q}from"./index-5T4qJJOw.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-B83TXI7i.js";import{_ as h}from"./Label.vue_vue_type_script_setup_true_lang-BCUP6ZOH.js";import{_ as pe,a as ze,b as _e,c as ve,d as He}from"./CardTitle.vue_vue_type_script_setup_true_lang-BiCR9QuY.js";import{_ as be,a as we,b as he,c as ke,d as De}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B1UeKcy3.js";import{_ as Oe,a as lt}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-CGX19XjT.js";import{P as qe}from"./plus-D-SsUBc2.js";import{X as Xe}from"./x-_bimYh2h.js";import{c as Ye}from"./createLucideIcon-s0rQ-tjY.js";import{E as Re}from"./eye-B-fdaq3K.js";import{F as We}from"./file-text-CgeTJUd1.js";import"./useAssets-CQmDLjgb.js";import"./useForwardExpose-Dc5V3_WQ.js";import"./VisuallyHidden-M1x2NXyA.js";import"./RovingFocusGroup-BTeHOHaD.js";import"./index-DK8P9mNh.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./loader-circle-CeruoUBO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=Ye("FileSpreadsheetIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=Ye("PencilIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),at={key:0,class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},nt={class:"lg:col-span-1 space-y-4"},st={class:"flex items-center justify-between"},it={class:"space-y-4 py-4"},rt={class:"grid grid-cols-2 gap-2"},ut={key:0,class:"text-xs text-muted-foreground text-center"},dt={class:"space-y-2"},ft=["onClick"],pt={class:"flex items-center justify-between"},vt={class:"text-sm font-medium"},ct=["onClick"],mt={key:0,class:"text-sm text-muted-foreground text-center py-4"},gt=["value"],yt=["value"],xt={class:"grid grid-cols-2 gap-2"},bt=["value"],wt=["value"],ht=["value"],kt={class:"lg:col-span-3 flex flex-col min-h-0"},Ct={class:"flex justify-center items-center h-full overflow-auto p-4 rounded-lg"},Ft={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{"z-index":"1"}},Pt={key:2,class:"absolute inset-0 flex items-center justify-center bg-red-50",style:{"z-index":"1"}},Ut={class:"text-sm text-red-500"},St=["onMousedown","onClick"],Dt={key:1,class:"h-full"},$t={class:"flex justify-center items-center h-full overflow-auto p-4 rounded-lg"},At={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{"z-index":"1"}},zt={key:2,class:"absolute inset-0 flex items-center justify-center bg-red-50",style:{"z-index":"1"}},_t={class:"text-sm text-red-500"},Vt=["onMousedown","onClick"],Ae=3.779527559,Et=Ve({__name:"PdfTemplateBuilder",props:{template:{},showOnlyCanvas:{type:Boolean},selectedFieldId:{},pdfBackgroundUrl:{},currentPageNumber:{}},emits:["update","fieldSelected","pdfImageConverted","pdfPagesDetected","loading"],setup(te,{emit:k}){const b=te,P=k,C=y(null),f=y(null),F=y(null),E=y(!1),D=y(null),K=y(null),W=y(null),U=y(new Map),L=y(new Map),g=y(!1);re(()=>b.selectedFieldId,u=>{if(u){const l=M.value.find(s=>s.id===u);l&&(f.value=l)}else f.value=null},{immediate:!0});const $=y(!1),z=y({x:0,y:0}),B=y(!1),I=y(null),d=y(!1),w=y({label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"});re(d,u=>{u&&(w.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})});const _=se(()=>{if(!C.value)return 1;const u=C.value.parentElement;if(!u)return 1;const l=u.clientWidth-32,s=u.clientHeight-32,x=b.template.width*Ae,j=b.template.height*Ae,V=s/j,r=l/x;return Math.min(V,r)*.98}),de=se(()=>b.template.width*Ae*_.value),fe=se(()=>b.template.height*Ae*_.value),M=se(()=>b.template.fields),J=()=>{P("update",{...b.template,fields:[...M.value]})},T=se(()=>w.value.label?.trim()&&w.value.column?.trim()),Z=()=>{if(!T.value)return;const u={id:Date.now().toString(),x:10,y:10,width:100,height:30,column:w.value.column?.trim()||"",label:w.value.label?.trim()||"",fontSize:w.value.fontSize||16,textAlign:w.value.textAlign||"left",fontFamily:w.value.fontFamily||"Arial",fontColor:w.value.fontColor||"#000000",fontWeight:w.value.fontWeight||"normal",fontStyle:w.value.fontStyle||"normal",textDecoration:w.value.textDecoration||"none"};M.value.push(u),J(),d.value=!1,w.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},f.value=u},ce=u=>{const l=M.value.findIndex(s=>s.id===u);l>-1&&(M.value.splice(l,1),J(),f.value?.id===u&&(f.value=null,P("fieldSelected",null)))},ie=u=>{f.value=u,P("fieldSelected",u)},Ce=u=>{const l=3.779527559,s=u.x*l*_.value,x=u.y*l*_.value,j=u.width*l*_.value,V=u.height&&u.height>0?`${u.height*l*_.value}px`:"auto";return{left:`${s}px`,top:`${x}px`,width:`${j}px`,height:V,fontFamily:u.fontFamily||"Arial",color:u.fontColor||"#000000",fontWeight:u.fontWeight||"normal",fontStyle:u.fontStyle||"normal",textDecoration:u.textDecoration||"none",fontSize:`${(u.fontSize||16)*_.value}px`,textAlign:u.textAlign||"left"}},Fe=(u,l)=>{if(u.target.classList.contains("resize-handle")||u.target.tagName==="BUTTON"||(u.preventDefault(),u.stopPropagation(),$.value=!0,f.value=l,!C.value))return;const s=C.value.getBoundingClientRect(),x=u.clientX-s.left,j=u.clientY-s.top,V=3.779527559,r=x/_.value/V,t=j/_.value/V;z.value={x:r-l.x,y:t-l.y}},Ee=u=>{if(!C.value)return;const l=C.value.getBoundingClientRect(),s=u.clientX-l.left,x=u.clientY-l.top,j=3.779527559,V=s/_.value/j,r=x/_.value/j;if($.value&&f.value){const t=f.value,n=V-z.value.x,m=r-z.value.y,A=t.height>0?t.height:20;t.x=Math.max(0,Math.min(n,b.template.width-t.width)),t.y=Math.max(0,Math.min(m,b.template.height-A)),J()}else if(B.value&&f.value&&I.value){const t=f.value,n=I.value;if(n.includes("e")&&(t.width=Math.max(20,Math.min(V-t.x,b.template.width-t.x))),n.includes("s")&&(t.height=Math.max(20,Math.min(r-t.y,b.template.height-t.y))),n.includes("w")){const m=t.width+(t.x-V);m>=20&&V>=0&&(t.width=m,t.x=V)}if(n.includes("n")){const m=t.height+(t.y-r);m>=20&&r>=0&&(t.height=m,t.y=r)}J()}},Y=(u,l)=>{if(u.stopPropagation(),B.value=!0,I.value=l,f.value){const s=f.value;z.value={x:s.x*_.value,y:s.y*_.value}}},Pe=async()=>{if(b.pdfBackgroundUrl&&F.value){E.value=!0,D.value=null;try{window.pdfjsLib||await new Promise((u,l)=>{const s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",s.onload=()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js",u(!0)},s.onerror=()=>{l(new Error("Failed to load PDF.js"))},document.head.appendChild(s)}),await Me()}catch(u){D.value="Failed to load PDF: "+(u.message||"Unknown error"),E.value=!1}}},ye=async u=>{if(!(!u||!F.value))try{P("loading",!0,`Loading PDF pages (0/${u.numPages})...`);const l=3.779527559,s=b.template.width*l*_.value,x=b.template.height*l*_.value;L.value.clear(),U.value.clear();for(let j=1;j<=u.numPages;j++){P("loading",!0,`Loading PDF pages (${j}/${u.numPages})...`);const V=await u.getPage(j),r=V.getViewport({scale:1}),t=s/r.width,n=x/r.height,m=Math.min(t,n),A=V.getViewport({scale:m}),N=document.createElement("canvas");N.width=A.width,N.height=A.height;const R=N.getContext("2d");if(!R)throw new Error("Could not get canvas context");const ee={canvasContext:R,viewport:A};await V.render(ee).promise,L.value.set(j,N)}g.value=!0,xe(),P("loading",!1),Ne(u)}catch(l){console.error("Error preloading pages:",l),D.value="Failed to preload PDF pages: "+(l.message||"Unknown error"),E.value=!1,P("loading",!1)}},xe=()=>{if(!F.value)return;const u=b.currentPageNumber||1,l=L.value.get(u);if(l&&F.value){const s=F.value,x=s.getContext("2d");x&&(s.width=l.width,s.height=l.height,x.clearRect(0,0,s.width,s.height),x.drawImage(l,0,0))}},Ne=async u=>{try{const s=[];for(let x=1;x<=u.numPages;x++){const j=await u.getPage(x),V=j.getViewport({scale:2.5}),r=document.createElement("canvas");r.width=V.width,r.height=V.height;const t=r.getContext("2d",{alpha:!1,desynchronized:!1,willReadFrequently:!1});if(!t)throw new Error("Could not get export canvas context");t.fillStyle="#FFFFFF",t.fillRect(0,0,r.width,r.height);const n=(r.width-V.width)/2,m=(r.height-V.height)/2;t.save(),t.translate(n,m),t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high";const A={canvasContext:t,viewport:V};await j.render(A).promise,t.restore();const N=r.toDataURL("image/jpeg",.85);s.push(N)}s.length===1?P("pdfImageConverted",s[0]):P("pdfImageConverted",s)}catch(l){console.error("Error converting pages to images:",l)}},Me=async()=>{if(!(!b.pdfBackgroundUrl||!F.value||!window.pdfjsLib))try{let u=K.value;if(!u||!W.value){const l=window.pdfjsLib.getDocument({url:b.pdfBackgroundUrl,withCredentials:!1});W.value=l,u=await l.promise,K.value=u,P("pdfPagesDetected",u.numPages),await ye(u)}else g.value?xe():await ye(u);E.value=!1}catch(u){D.value="Failed to render PDF: "+(u.message||"Unknown error"),E.value=!1}};re(()=>b.currentPageNumber,()=>{F.value&&b.pdfBackgroundUrl&&g.value&&xe()}),re(()=>b.pdfBackgroundUrl,u=>{K.value=null,W.value=null,g.value=!1,L.value.clear(),U.value.clear(),u&&setTimeout(()=>{F.value&&Pe()},200)},{immediate:!0}),re(_,()=>{b.pdfBackgroundUrl&&F.value&&K.value&&g.value&&(g.value=!1,L.value.clear(),U.value.clear(),ye(K.value))}),Ze(()=>{document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",Ue),document.addEventListener("mouseleave",Ue),setTimeout(()=>{b.pdfBackgroundUrl&&F.value&&Pe()},300)});const Ue=()=>{($.value||B.value)&&($.value=!1,B.value=!1,I.value=null)},le=(u,l,s)=>{u[l]=s,J()};return(u,l)=>u.showOnlyCanvas?(p(),c("div",Dt,[a(o(pe),{class:"h-full flex flex-col"},{default:i(()=>[a(o(ve),{class:"flex-1 overflow-auto p-0"},{default:i(()=>[e("div",$t,[e("div",{class:"relative border-2 border-dashed border-gray-400 shadow-lg",ref_key:"canvasRef",ref:C,style:oe({width:de.value+"px",height:fe.value+"px",minWidth:de.value+"px",minHeight:fe.value+"px",aspectRatio:(b.template.width/b.template.height).toString(),backgroundColor:"#d4d4d4"})},[b.pdfBackgroundUrl?(p(),c("canvas",{key:0,ref_key:"pdfCanvasRef",ref:F,class:"absolute inset-0 w-full h-full pointer-events-none",style:{"z-index":"1","object-fit":"contain"}},null,512)):S("",!0),E.value?(p(),c("div",At,[...l[57]||(l[57]=[e("span",{class:"text-sm text-gray-500"},"Loading PDF...",-1)])])):S("",!0),D.value?(p(),c("div",zt,[e("span",_t,q(D.value),1)])):S("",!0),(p(!0),c(ae,null,ue(M.value,s=>(p(),c("div",{key:s.id,class:ne(["absolute border-2 cursor-move select-none",f.value?.id===s.id?"border-blue-600 shadow-lg bg-transparent":"border-blue-400 bg-transparent"]),style:oe({...Ce(s),zIndex:f.value?.id===s.id?30:20}),onMousedown:G(x=>Fe(x,s),["prevent"]),onClick:G(x=>ie(s),["stop"])},[e("div",{class:"pointer-events-none w-full flex",style:oe({textAlign:s.textAlign||"left",justifyContent:s.textAlign==="center"?"center":s.textAlign==="right"?"flex-end":"flex-start",padding:"3px",margin:0})},[e("span",{style:oe({fontFamily:s.fontFamily||"Arial",color:s.fontColor||"#000000",fontWeight:s.fontWeight||"normal",fontStyle:s.fontStyle||"normal",textDecoration:s.textDecoration||"none",fontSize:`${(s.fontSize||16)*_.value}px`,display:"inline-block",width:"100%",lineHeight:1,padding:0,margin:0})},q(s.label||s.column),5)],4),f.value?.id===s.id?(p(),c("div",{key:0,class:"resize-handle absolute bottom-0 right-0 h-2 w-2 cursor-se-resize bg-blue-500",onMousedown:l[21]||(l[21]=G(x=>Y(x,"se"),["stop"]))},null,32)):S("",!0),f.value?.id===s.id?(p(),c("div",{key:1,class:"resize-handle absolute top-0 right-0 h-2 w-2 cursor-ne-resize bg-blue-500",onMousedown:l[22]||(l[22]=G(x=>Y(x,"ne"),["stop"]))},null,32)):S("",!0),f.value?.id===s.id?(p(),c("div",{key:2,class:"resize-handle absolute bottom-0 left-0 h-2 w-2 cursor-sw-resize bg-blue-500",onMousedown:l[23]||(l[23]=G(x=>Y(x,"sw"),["stop"]))},null,32)):S("",!0),f.value?.id===s.id?(p(),c("div",{key:3,class:"resize-handle absolute top-0 left-0 h-2 w-2 cursor-nw-resize bg-blue-500",onMousedown:l[24]||(l[24]=G(x=>Y(x,"nw"),["stop"]))},null,32)):S("",!0)],46,Vt))),128))],4)])]),_:1})]),_:1})])):(p(),c("div",at,[e("div",nt,[a(o(pe),null,{default:i(()=>[a(o(ze),null,{default:i(()=>[e("div",st,[a(o(_e),null,{default:i(()=>[...l[25]||(l[25]=[v("Fields",-1)])]),_:1}),a(o(be),{open:d.value,"onUpdate:open":l[9]||(l[9]=s=>d.value=s)},{default:i(()=>[a(o(Oe),{"as-child":""},{default:i(()=>[a(o(Q),{size:"sm"},{default:i(()=>[a(o(qe),{class:"mr-2 h-4 w-4"}),l[26]||(l[26]=v(" Add Field ",-1))]),_:1})]),_:1}),a(o(we),null,{default:i(()=>[a(o(he),null,{default:i(()=>[a(o(ke),null,{default:i(()=>[...l[27]||(l[27]=[v("Add Field",-1)])]),_:1})]),_:1}),e("div",it,[e("div",null,[a(o(h),null,{default:i(()=>[...l[28]||(l[28]=[v("Label",-1)])]),_:1}),a(o(X),{modelValue:w.value.label,"onUpdate:modelValue":l[0]||(l[0]=s=>w.value.label=s),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[29]||(l[29]=[v("Column Name",-1)])]),_:1}),a(o(X),{modelValue:w.value.column,"onUpdate:modelValue":l[1]||(l[1]=s=>w.value.column=s),placeholder:"e.g., name"},null,8,["modelValue"])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[30]||(l[30]=[v("Font Size",-1)])]),_:1}),a(o(X),{modelValue:w.value.fontSize,"onUpdate:modelValue":l[2]||(l[2]=s=>w.value.fontSize=s),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[31]||(l[31]=[v("Text Align",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":l[3]||(l[3]=s=>w.value.textAlign=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[32]||(l[32]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],512),[[O,w.value.textAlign]])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[33]||(l[33]=[v("Font Family",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":l[4]||(l[4]=s=>w.value.fontFamily=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[34]||(l[34]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[O,w.value.fontFamily]])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[35]||(l[35]=[v("Font Color",-1)])]),_:1}),a(o(X),{modelValue:w.value.fontColor,"onUpdate:modelValue":l[5]||(l[5]=s=>w.value.fontColor=s),type:"color",class:"h-10"},null,8,["modelValue"])]),e("div",rt,[e("div",null,[a(o(h),null,{default:i(()=>[...l[36]||(l[36]=[v("Font Weight",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":l[6]||(l[6]=s=>w.value.fontWeight=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[37]||(l[37]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],512),[[O,w.value.fontWeight]])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[38]||(l[38]=[v("Font Style",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":l[7]||(l[7]=s=>w.value.fontStyle=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[39]||(l[39]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],512),[[O,w.value.fontStyle]])])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[40]||(l[40]=[v("Text Decoration",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":l[8]||(l[8]=s=>w.value.textDecoration=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[41]||(l[41]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],512),[[O,w.value.textDecoration]])]),a(o(Q),{onClick:Z,class:"w-full",disabled:!T.value},{default:i(()=>[...l[42]||(l[42]=[v(" Add Field ",-1)])]),_:1},8,["disabled"]),T.value?S("",!0):(p(),c("p",ut," Please fill in Label and Column Name to add field "))])]),_:1})]),_:1},8,["open"])])]),_:1}),a(o(ve),null,{default:i(()=>[e("div",dt,[(p(!0),c(ae,null,ue(M.value,s=>(p(),c("div",{key:s.id,class:ne(["p-2 border rounded cursor-pointer",f.value?.id===s.id?"border-blue-500 bg-blue-50":"border-gray-200"]),onClick:x=>ie(s)},[e("div",pt,[e("span",vt,q(s.label||s.column),1),e("button",{onClick:G(x=>ce(s.id),["stop"]),class:"text-red-500 hover:text-red-700"},[a(o(Xe),{class:"h-4 w-4"})],8,ct)])],10,ft))),128)),M.value.length===0?(p(),c("p",mt,' No fields yet. Click "Add Field" to create one. ')):S("",!0)])]),_:1})]),_:1}),f.value?(p(),me(o(pe),{key:0},{default:i(()=>[a(o(ze),null,{default:i(()=>[a(o(_e),null,{default:i(()=>[...l[43]||(l[43]=[v("Field Properties",-1)])]),_:1})]),_:1}),a(o(ve),{class:"space-y-4"},{default:i(()=>[e("div",null,[a(o(h),null,{default:i(()=>[...l[44]||(l[44]=[v("Font Size",-1)])]),_:1}),a(o(X),{value:f.value.fontSize,type:"number",onInput:l[10]||(l[10]=s=>le(f.value,"fontSize",parseFloat(s.target.value)))},null,8,["value"])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[45]||(l[45]=[v("Text Align",-1)])]),_:1}),e("select",{value:f.value.textAlign,onChange:l[11]||(l[11]=s=>le(f.value,"textAlign",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[46]||(l[46]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],40,gt)]),e("div",null,[a(o(h),null,{default:i(()=>[...l[47]||(l[47]=[v("Font Family",-1)])]),_:1}),e("select",{value:f.value.fontFamily||"Arial",onChange:l[12]||(l[12]=s=>le(f.value,"fontFamily",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[48]||(l[48]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],40,yt)]),e("div",null,[a(o(h),null,{default:i(()=>[...l[49]||(l[49]=[v("Font Color",-1)])]),_:1}),a(o(X),{value:f.value.fontColor||"#000000",type:"color",class:"h-10",onInput:l[13]||(l[13]=s=>le(f.value,"fontColor",s.target.value))},null,8,["value"])]),e("div",xt,[e("div",null,[a(o(h),null,{default:i(()=>[...l[50]||(l[50]=[v("Font Weight",-1)])]),_:1}),e("select",{value:f.value.fontWeight||"normal",onChange:l[14]||(l[14]=s=>le(f.value,"fontWeight",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[51]||(l[51]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],40,bt)]),e("div",null,[a(o(h),null,{default:i(()=>[...l[52]||(l[52]=[v("Font Style",-1)])]),_:1}),e("select",{value:f.value.fontStyle||"normal",onChange:l[15]||(l[15]=s=>le(f.value,"fontStyle",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[53]||(l[53]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],40,wt)])]),e("div",null,[a(o(h),null,{default:i(()=>[...l[54]||(l[54]=[v("Text Decoration",-1)])]),_:1}),e("select",{value:f.value.textDecoration||"none",onChange:l[16]||(l[16]=s=>le(f.value,"textDecoration",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[55]||(l[55]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],40,ht)])]),_:1})]),_:1})):S("",!0)]),e("div",kt,[a(o(pe),{class:"flex-1 flex flex-col min-h-0"},{default:i(()=>[a(o(ve),{class:"p-0 flex-1 overflow-hidden min-h-0"},{default:i(()=>[e("div",Ct,[e("div",{class:"relative border-2 border-dashed border-gray-400 shadow-lg",ref_key:"canvasRef",ref:C,style:oe({width:de.value+"px",height:fe.value+"px",minWidth:de.value+"px",minHeight:fe.value+"px",aspectRatio:(b.template.width/b.template.height).toString(),backgroundColor:"#d4d4d4"})},[b.pdfBackgroundUrl?(p(),c("canvas",{key:0,ref_key:"pdfCanvasRef",ref:F,class:"absolute inset-0 w-full h-full pointer-events-none",style:{"z-index":"1","object-fit":"contain","background-color":"#d4d4d4"}},null,512)):S("",!0),E.value?(p(),c("div",Ft,[...l[56]||(l[56]=[e("span",{class:"text-sm text-gray-500"},"Loading PDF...",-1)])])):S("",!0),D.value?(p(),c("div",Pt,[e("span",Ut,q(D.value),1)])):S("",!0),(p(!0),c(ae,null,ue(M.value,s=>(p(),c("div",{key:s.id,class:ne(["absolute border-2 cursor-move select-none",f.value?.id===s.id?"border-blue-600 shadow-lg bg-transparent":"border-blue-400 bg-transparent"]),style:oe({...Ce(s),zIndex:f.value?.id===s.id?30:20}),onMousedown:G(x=>Fe(x,s),["prevent"]),onClick:G(x=>ie(s),["stop"])},[e("div",{class:"pointer-events-none w-full flex",style:oe({textAlign:s.textAlign||"left",justifyContent:s.textAlign==="center"?"center":s.textAlign==="right"?"flex-end":"flex-start",padding:"3px",margin:0})},[e("span",{style:oe({fontFamily:s.fontFamily||"Arial",color:s.fontColor||"#000000",fontWeight:s.fontWeight||"normal",fontStyle:s.fontStyle||"normal",textDecoration:s.textDecoration||"none",fontSize:`${(s.fontSize||16)*_.value}px`,display:"inline-block",width:"100%",lineHeight:1,padding:0,margin:0})},q(s.label||s.column),5)],4),f.value?.id===s.id?(p(),c("div",{key:0,class:"resize-handle absolute bottom-0 right-0 h-2 w-2 cursor-se-resize bg-blue-500",onMousedown:l[17]||(l[17]=G(x=>Y(x,"se"),["stop"]))},null,32)):S("",!0),f.value?.id===s.id?(p(),c("div",{key:1,class:"resize-handle absolute top-0 right-0 h-2 w-2 cursor-ne-resize bg-blue-500",onMousedown:l[18]||(l[18]=G(x=>Y(x,"ne"),["stop"]))},null,32)):S("",!0),f.value?.id===s.id?(p(),c("div",{key:2,class:"resize-handle absolute bottom-0 left-0 h-2 w-2 cursor-sw-resize bg-blue-500",onMousedown:l[19]||(l[19]=G(x=>Y(x,"sw"),["stop"]))},null,32)):S("",!0),f.value?.id===s.id?(p(),c("div",{key:3,class:"resize-handle absolute top-0 left-0 h-2 w-2 cursor-nw-resize bg-blue-500",onMousedown:l[20]||(l[20]=G(x=>Y(x,"nw"),["stop"]))},null,32)):S("",!0)],46,St))),128))],4)])]),_:1})]),_:1})])]))}}),Nt={class:"space-y-4"},Mt={key:0,class:"text-center py-4"},Lt={key:1,class:"mt-4"},jt={class:"flex items-center justify-between"},Tt={class:"flex items-center gap-2"},Gt={key:1,class:"space-y-4"},Rt={key:0,class:"text-center py-4"},Wt={key:1,class:"mt-4"},Bt={class:"flex items-center justify-between"},It={class:"flex items-center gap-2"},Ht=Ve({__name:"ExcelUploader",props:{excelData:{},noCard:{type:Boolean}},emits:["uploaded","viewFile","loading","cancelRequest"],setup(te,{expose:k,emit:b}){const P=te,C=b,f=y(!1),F=y(null),E=y(P.excelData||[]);let D=null;k({cancelUpload:()=>{D&&(D.abort(),D=null),f.value=!1,C("loading",!1),F.value&&(F.value.value="")}}),je(()=>{D&&D.abort()});const W=async L=>{const $=L.target.files?.[0];if($){if(!$.name.match(/\.(xlsx|xls|csv)$/i)){alert("Please upload a valid Excel file (.xlsx, .xls, or .csv)");return}f.value=!0,C("loading",!0,"Uploading Excel file...");try{const z=new FormData;z.append("excel_file",$),C("loading",!0,"Uploading Excel file..."),D=new AbortController;let B=!1;const I=await ge.post("/pdf-templates/upload-excel",z,{headers:{"Content-Type":"multipart/form-data"},signal:D.signal,onUploadProgress:d=>{if(d.total&&!B){const w=Math.round(d.loaded*100/d.total);w<100?C("loading",!0,`Uploading Excel file... ${w}%`):(B=!0,C("loading",!0,"Processing Excel file..."))}}});C("loading",!0,"Processing Excel file..."),E.value=I.data.data||[],C("uploaded",{data:I.data.data||[],columns:I.data.columns||[]})}catch(z){if(ge.isCancel(z)||z.name==="AbortError"||z.code==="ERR_CANCELED"){console.log("Excel upload was cancelled");return}alert("Error uploading file: "+(z.response?.data?.message||z.message))}finally{f.value=!1,C("loading",!1),D=null,F.value&&(F.value.value="")}}},U=()=>{F.value?.click()};return(L,g)=>L.noCard?(p(),c("div",Gt,[e("input",{ref_key:"fileInput",ref:F,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:W},null,544),e("button",{type:"button",onClick:U,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(o($e),{class:"h-4 w-4"}),g[8]||(g[8]=e("span",null,"Upload File",-1))]),f.value?(p(),c("div",Rt,[...g[9]||(g[9]=[e("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):S("",!0),E.value.length>0?(p(),c("div",Wt,[e("div",Bt,[e("div",It,[a(o($e),{class:"h-5 w-5 text-green-500"}),g[10]||(g[10]=e("span",{class:"text-sm font-semibold text-gray-700"}," File uploaded ",-1))]),a(o(Q),{size:"sm",variant:"outline",onClick:g[1]||(g[1]=$=>C("viewFile")),class:"flex items-center gap-2"},{default:i(()=>[a(o(Re),{class:"h-4 w-4"}),g[11]||(g[11]=v(" View File ",-1))]),_:1})])])):S("",!0)])):(p(),me(o(pe),{key:0},{default:i(()=>[a(o(ze),null,{default:i(()=>[a(o(_e),null,{default:i(()=>[...g[2]||(g[2]=[v("Upload Excel File",-1)])]),_:1}),a(o(He),null,{default:i(()=>[...g[3]||(g[3]=[v(" Upload an Excel file (.xlsx, .xls, or .csv) containing your data ",-1)])]),_:1})]),_:1}),a(o(ve),null,{default:i(()=>[e("div",Nt,[e("input",{ref_key:"fileInput",ref:F,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:W},null,544),e("button",{type:"button",onClick:U,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(o($e),{class:"h-4 w-4"}),g[4]||(g[4]=e("span",null,"Upload File",-1))]),f.value?(p(),c("div",Mt,[...g[5]||(g[5]=[e("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):S("",!0),E.value.length>0?(p(),c("div",Lt,[e("div",jt,[e("div",Tt,[a(o($e),{class:"h-5 w-5 text-green-500"}),g[6]||(g[6]=e("span",{class:"text-sm font-semibold text-gray-700"}," File uploaded ",-1))]),a(o(Q),{size:"sm",variant:"outline",onClick:g[0]||(g[0]=$=>C("viewFile")),class:"flex items-center gap-2"},{default:i(()=>[a(o(Re),{class:"h-4 w-4"}),g[7]||(g[7]=v(" View File ",-1))]),_:1})])])):S("",!0)])]),_:1})]),_:1}))}}),Ot={class:"space-y-4"},qt={key:0,class:"text-center py-4"},Xt={key:1,class:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md"},Yt={class:"flex items-center gap-2 text-sm text-green-700"},Qt={key:1,class:"space-y-4"},Kt={key:0,class:"text-center py-2"},Zt={key:1,class:"p-2 bg-green-50 border border-green-200 rounded-md"},Jt={class:"flex items-center gap-2 text-xs text-green-700"},el=Ve({__name:"PdfUploader",props:{pdfUrl:{},noCard:{type:Boolean}},emits:["uploaded","loading","cancelRequest"],setup(te,{emit:k}){const b=te,P=k,C=y(!1),f=y(null),F=y(b.pdfUrl||"");let E=null;je(()=>{E&&E.abort()});const D=async W=>{const L=W.target.files?.[0];if(L){if(!L.name.match(/\.(pdf)$/i)){alert("Please upload a valid PDF file (.pdf)");return}C.value=!0,P("loading",!0,"Uploading PDF...");try{if(L.size>52428800){alert(`File size (${(L.size/1024/1024).toFixed(2)}MB) exceeds the maximum allowed size of 50MB.`),C.value=!1,P("loading",!1);return}P("loading",!0,"Uploading PDF...");const $=new FormData;$.append("pdf_file",L),E=new AbortController;let z=!1;const B=await ge.post("/pdf-templates/upload-pdf",$,{headers:{"Content-Type":"multipart/form-data"},timeout:12e4,signal:E.signal,onUploadProgress:I=>{if(I.total&&!z){const d=Math.round(I.loaded*100/I.total);d<100?P("loading",!0,`Uploading PDF... ${d}%`):(z=!0,P("loading",!0,"Processing PDF..."))}}});P("loading",!0,"Processing PDF..."),F.value=B.data.file_url||"",P("uploaded",{file_path:B.data.file_path,file_url:B.data.file_url,dimensions:B.data.dimensions})}catch(g){if(ge.isCancel(g)||g.name==="AbortError"||g.code==="ERR_CANCELED"){console.log("PDF upload was cancelled");return}console.error("PDF Upload Error:",g);let $="Error uploading file. ";if(g.response){const z=g.response.data?.errors;z&&z.pdf_file?$+=z.pdf_file[0]||g.response.data?.message||"Unknown error":$+=g.response.data?.message||`Server error (${g.response.status})`}else g.request?$+="No response from server. Please check your connection.":$+=g.message||"Unknown error occurred";alert($)}finally{C.value=!1,P("loading",!1),E=null,f.value&&(f.value.value="")}}},K=()=>{f.value?.click()};return(W,U)=>W.noCard?(p(),c("div",Qt,[e("input",{ref_key:"fileInput",ref:f,type:"file",accept:".pdf",class:"hidden",onChange:D},null,544),e("button",{type:"button",onClick:K,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(o(Ge),{class:"h-4 w-4"}),U[5]||(U[5]=e("span",null,"Upload File",-1))]),C.value?(p(),c("div",Kt,[...U[6]||(U[6]=[e("p",{class:"text-sm text-gray-600"},"Uploading...",-1)])])):S("",!0),F.value?(p(),c("div",Zt,[e("div",Jt,[a(o(We),{class:"h-3 w-3"}),U[7]||(U[7]=e("span",null,"PDF uploaded",-1))])])):S("",!0)])):(p(),me(o(pe),{key:0},{default:i(()=>[a(o(ze),null,{default:i(()=>[a(o(_e),null,{default:i(()=>[...U[0]||(U[0]=[v("Upload PDF Template",-1)])]),_:1}),a(o(He),null,{default:i(()=>[...U[1]||(U[1]=[v(" Upload a PDF file (.pdf) to use as template background ",-1)])]),_:1})]),_:1}),a(o(ve),null,{default:i(()=>[e("div",Ot,[e("input",{ref_key:"fileInput",ref:f,type:"file",accept:".pdf",class:"hidden",onChange:D},null,544),e("button",{type:"button",onClick:K,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(o(Ge),{class:"h-4 w-4"}),U[2]||(U[2]=e("span",null,"Upload File",-1))]),C.value?(p(),c("div",qt,[...U[3]||(U[3]=[e("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):S("",!0),F.value?(p(),c("div",Xt,[e("div",Yt,[a(o(We),{class:"h-4 w-4"}),U[4]||(U[4]=e("span",null,"PDF uploaded successfully",-1))])])):S("",!0)])]),_:1})]),_:1}))}}),tl={class:"relative z-10"},ll={class:"bg-white rounded-lg p-8 shadow-2xl max-w-md w-full mx-4 border border-gray-200"},ol={class:"flex flex-col items-center space-y-6"},al={key:0,class:"w-24 h-24"},nl={key:1,class:"w-24 h-24 relative"},sl={key:2,class:"w-24 h-24"},il={key:3,class:"w-24 h-24"},rl={key:4,class:"relative w-12 h-12"},ul={class:"text-gray-700 font-medium text-center text-lg"},dl={key:5,class:"w-full max-w-xs mt-4 space-y-3"},fl={key:0,class:"h-2 bg-gray-200 rounded-full overflow-hidden"},pl={class:"flex items-center justify-between mb-4 flex-shrink-0"},vl={class:"flex items-center gap-4"},cl={class:"flex items-center gap-2"},ml={class:"flex items-center gap-1"},gl={class:"flex-1 flex gap-4 overflow-hidden min-h-0"},yl={class:"flex items-center justify-between mb-3"},xl={class:"space-y-4 py-4"},bl={class:"flex items-center gap-2"},wl={class:"grid grid-cols-2 gap-4"},hl={class:"space-y-2"},kl=["onClick"],Cl={class:"flex items-center justify-between"},Fl={class:"flex flex-col"},Pl={class:"flex items-center gap-1 ml-2"},Ul=["onClick"],Sl=["onClick"],Dl={key:0,class:"text-sm text-muted-foreground text-center py-4"},$l={class:"border-t pt-4"},Al={class:"border-t pt-4"},zl={class:"space-y-4 py-4"},_l={class:"grid grid-cols-2 gap-2"},Vl={class:"flex gap-2"},El={class:"flex-1 min-w-0 overflow-hidden"},Nl={class:"flex-1 overflow-auto"},Ml={key:0,class:"text-center py-8 text-gray-500"},Ll={key:1,class:"space-y-4"},jl={class:"border rounded-lg overflow-hidden"},Tl={class:"bg-white"},Gl={class:"aspect-[1/1.414] w-full",style:{"min-height":"600px"}},Rl=["src"],Wl=["src"],Bl=["data"],Il={class:"flex items-center justify-center h-full text-gray-500"},Hl=["href"],Ol={key:3,class:"flex items-center justify-center h-full text-red-500"},ql={class:"flex justify-end gap-2 pt-4 border-t"},Xl={class:"flex-1 overflow-auto"},Yl={key:0,class:"text-center py-8 text-gray-500"},Ql={key:1,class:"border rounded-lg overflow-hidden"},Kl={class:"overflow-x-auto"},Zl={class:"w-full text-sm"},Jl={class:"bg-slate-700 sticky top-0 z-10 shadow-md"},eo={class:"bg-white"},to={class:"p-3 bg-gray-50 border-t text-sm text-gray-600 text-center"},Be=210,Ie=297,lo=Ve({__name:"Index",setup(te){const k=y({name:"",width:Be,height:Ie,pages:[{id:"1",fields:[{id:"default-1",x:10,y:10,width:100,height:30,label:"Name",column:"name",fontSize:20,textAlign:"center",fontFamily:"Helvetica",fontColor:"#ffffff",fontWeight:"bold",fontStyle:"normal",textDecoration:"none"}]}]}),b=y([]),P=y([]),C=y({}),f=y([]),F=y(!1),E=y(!1),D=y(null),K=y(0),W=y(!1),U=y(!1),L=y(!1),g=y(null),$=y(null),z=y(""),B=y(""),I=y([]),d=y({label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"}),w=y(0),_=se(()=>k.value.pages[w.value]||k.value.pages[0]),de=se(()=>k.value.pages.some(r=>r.fields.length>0)),fe=se(()=>b.value.length>0),M=y(!1),J=y("Processing..."),T=y("default");let Z=null;const ce=y(null),ie=y(null),Ce=()=>{Z&&(Z.abort(),Z=null),F.value=!1,M.value=!1,T.value="default",J.value="Processing..."},Fe=()=>{ce.value&&typeof ce.value.cancelUpload=="function"&&ce.value.cancelUpload(),ie.value&&typeof ie.value.cancelUpload=="function"&&ie.value.cancelUpload()};je(()=>{M.value&&(M.value=!1),Z&&Z.abort(),D.value&&(URL.revokeObjectURL(D.value),D.value=null)});const Ee=r=>{w.value=r,g.value=null},Y=r=>{k.value={...r}},Pe=r=>{z.value=r.file_url||"",B.value=r.file_path||"",r.dimensions&&(k.value.width=r.dimensions.width||Be,k.value.height=r.dimensions.height||Ie)},ye=r=>{I.value=r},xe=r=>{if(r>k.value.pages.length){const t=k.value.pages.length;for(let n=t;n<r;n++){const m=(n+1).toString();k.value.pages.push({id:m,fields:[]})}}else r<k.value.pages.length&&r>0&&(k.value.pages=k.value.pages.slice(0,r),w.value>=k.value.pages.length&&(w.value=k.value.pages.length-1));Y(k.value)},Ne=r=>{b.value=r.data||[],P.value=r.columns||[];const t={};k.value.pages.forEach(n=>{n.fields.forEach(m=>{if(m.column){let A=P.value.find(N=>N.toLowerCase()===m.column.toLowerCase());A||(A=P.value.find(N=>N.toLowerCase()===m.label?.toLowerCase())),A||(A=P.value.find(N=>N.toLowerCase().includes(m.column.toLowerCase())||m.column.toLowerCase().includes(N.toLowerCase()))),A&&(t[m.column]=A)}})}),C.value=t},Me=async()=>{if(!de.value){alert("Please create a template first");return}if(!fe.value){alert("Please upload an Excel file first");return}const r=[];if(k.value.pages.forEach(t=>{t.fields.forEach(n=>{if(n.column&&!C.value[n.column]){const m=P.value.find(A=>A.toLowerCase()===n.column.toLowerCase()||A.toLowerCase()===n.label.toLowerCase());m?C.value[n.column]=m:r.push(n.label||n.column)}})}),r.length>0){alert(`Please map the following fields to Excel columns:
${r.join(", ")}

You can map them by matching field column names with Excel column names.`);return}if(Object.keys(C.value).length===0){alert("No column mappings found. Please ensure your field column names match Excel column names.");return}Z&&Z.abort(),Z=new AbortController,F.value=!0;try{const t=Date.now(),n=setTimeout(()=>{},3e4);let m;try{m=await ge.post("/pdf-templates/generate",{template:k.value,excel_data:b.value,column_mapping:C.value,pdf_file_path:B.value||null,pdf_page_image:I.value||null},{timeout:18e5,signal:Z.signal,maxContentLength:1/0,maxBodyLength:1/0,onUploadProgress:R=>{}}),clearTimeout(n)}catch(R){throw clearTimeout(n),R}const A=Date.now()-t;if(!m||!m.data)throw new Error("No data received from server");if(m.data.success===!1)throw new Error(m.data.message||"PDF generation failed");const N=m.data.pdfs||[];if(!Array.isArray(N))throw new Error("Invalid response format from server: pdfs is not an array");if(N.length===0)throw new Error("No PDFs were generated. Please check your template and data.");if(f.value=N,f.value.length>0&&f.value[0]?.base64)try{D.value&&URL.revokeObjectURL(D.value);const R=f.value[0].base64.trim();if(R&&R.length>0){const ee=atob(R),Te=new Array(ee.length);for(let Se=0;Se<ee.length;Se++)Te[Se]=ee.charCodeAt(Se);const Qe=new Uint8Array(Te),Ke=new Blob([Qe],{type:"application/pdf"});D.value=URL.createObjectURL(Ke)}}catch{D.value=null}F.value=!1,M.value=!1,T.value="default",await Le(),K.value++,await Le(),E.value=!0}catch(t){if(ge.isCancel(t)||t.name==="AbortError"||t.code==="ERR_CANCELED"){F.value=!1;return}let n="Error generating PDFs. ";if(t.code==="ECONNABORTED"||t.message?.includes("timeout"))n+="The request timed out. Please try again with fewer rows or check server logs.";else if(t.response){const m=t.response.data;if(m?.errors){const A=Object.values(m.errors).flat();n+=A.join(", ")||"Validation error occurred."}else n+=m?.message||`Server error (${t.response.status}). Check server logs.`}else t.request?n+="No response from server. Please check your connection and server logs.":n+=t.message||"Unknown error occurred.";alert(n)}finally{F.value=!1,Z=null}},Ue=r=>{try{const t=atob(r.base64),n=new Array(t.length);for(let ee=0;ee<t.length;ee++)n[ee]=t.charCodeAt(ee);const m=new Uint8Array(n),A=new Blob([m],{type:"application/pdf"}),N=URL.createObjectURL(A),R=document.createElement("a");R.href=N,R.download=r.filename,document.body.appendChild(R),R.click(),document.body.removeChild(R),setTimeout(()=>URL.revokeObjectURL(N),100)}catch{const n=document.createElement("a");n.href=`data:application/pdf;base64,${r.base64}`,n.download=r.filename,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},le=async()=>{if(f.value.length!==0)for(let r=0;r<f.value.length;r++)Ue(f.value[r]),r<f.value.length-1&&await new Promise(t=>setTimeout(t,200))},u=se(()=>d.value.label?.trim()&&d.value.column?.trim()),l=()=>{if(!u.value)return;const r={id:Date.now().toString(),x:10,y:10,width:100,height:0,column:d.value.column.trim(),label:d.value.label.trim(),fontSize:d.value.fontSize||16,textAlign:d.value.textAlign||"left",fontFamily:d.value.fontFamily||"Arial",fontColor:d.value.fontColor||"#000000",fontWeight:d.value.fontWeight||"normal",fontStyle:d.value.fontStyle||"normal",textDecoration:d.value.textDecoration||"none"};_.value.fields.push(r),Y(k.value),W.value=!1,d.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},g.value=r},s=r=>{const t=k.value.pages.find(n=>n.fields.some(m=>m.id===r));if(t){const n=t.fields.findIndex(m=>m.id===r);n>-1&&(t.fields.splice(n,1),Y(k.value),g.value?.id===r&&(g.value=null))}},x=r=>{g.value=r},j=r=>{$.value=r,d.value={label:r.label,column:r.column,fontSize:r.fontSize,textAlign:r.textAlign,fontFamily:r.fontFamily||"Arial",fontColor:r.fontColor||"#000000",fontWeight:r.fontWeight||"normal",fontStyle:r.fontStyle||"normal",textDecoration:r.textDecoration||"none"},U.value=!0},V=()=>{if(!$.value)return;const r=k.value.pages.find(t=>t.fields.some(n=>n.id===$.value.id));if(r){const t=r.fields.find(n=>n.id===$.value.id);t&&(t.label=d.value.label.trim(),t.column=d.value.column.trim(),t.fontSize=d.value.fontSize||16,t.textAlign=d.value.textAlign||"left",t.fontFamily=d.value.fontFamily||"Arial",t.fontColor=d.value.fontColor||"#000000",t.fontWeight=d.value.fontWeight||"normal",t.fontStyle=d.value.fontStyle||"normal",t.textDecoration=d.value.textDecoration||"none",Y(k.value),U.value=!1,$.value=null)}};return re(W,r=>{r&&(d.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})}),re(U,r=>{!r&&$.value===null&&(d.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})}),re(f,(r,t)=>{r&&r.length>0&&(!t||t.length===0)&&Le().then(()=>{E.value=!0})},{deep:!0}),(r,t)=>(p(),c(ae,null,[a(o(Je),{title:"PDF Template"}),a(tt,null,{default:i(()=>[a(et,{"enter-active-class":"transition-opacity duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:i(()=>[M.value?(p(),c("div",{key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center",style:{"pointer-events":"all"},onClick:t[1]||(t[1]=G(()=>{},["stop"])),onMousedown:t[2]||(t[2]=G(()=>{},["stop"])),onTouchstart:t[3]||(t[3]=G(()=>{},["stop"]))},[e("div",{class:ne(["absolute inset-0 bg-black transition-opacity duration-300",M.value?"opacity-50":"opacity-0"]),style:{"backdrop-filter":"blur(2px)"}},null,2),e("div",tl,[e("div",ll,[e("div",ol,[T.value==="upload"?(p(),c("div",al,[...t[34]||(t[34]=[e("svg",{viewBox:"0 0 100 100",class:"w-full h-full"},[e("defs",null,[e("linearGradient",{id:"cloudGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#60a5fa","stop-opacity":"1"}}),e("stop",{offset:"100%",style:{"stop-color":"#3b82f6","stop-opacity":"1"}})])]),e("path",{d:"M 30 50 Q 20 50 20 60 Q 20 70 30 70 L 70 70 Q 80 70 80 60 Q 80 50 70 50",fill:"url(#cloudGradient)",stroke:"#2563eb","stroke-width":"2",class:"animate-pulse"}),e("line",{x1:"50",y1:"40",x2:"50",y2:"25",stroke:"#10b981","stroke-width":"5","stroke-linecap":"round",class:"animate-bounce"}),e("polyline",{points:"45,30 50,25 55,30",fill:"#10b981",stroke:"#10b981","stroke-width":"5","stroke-linecap":"round","stroke-linejoin":"round",class:"animate-bounce"}),e("circle",{cx:"30",cy:"60",r:"2",fill:"#fbbf24",class:"animate-pulse",style:{"animation-delay":"0.2s"}}),e("circle",{cx:"70",cy:"60",r:"2",fill:"#f59e0b",class:"animate-pulse",style:{"animation-delay":"0.4s"}})],-1)])])):T.value==="generate"?(p(),c("div",nl,[...t[35]||(t[35]=[e("svg",{viewBox:"0 0 100 100",class:"w-full h-full"},[e("defs",null,[e("linearGradient",{id:"pdfGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#60a5fa","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"#3b82f6","stop-opacity":"0.3"}})]),e("linearGradient",{id:"textGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#34d399","stop-opacity":"1"}}),e("stop",{offset:"100%",style:{"stop-color":"#10b981","stop-opacity":"1"}})]),e("linearGradient",{id:"imageGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#fbbf24","stop-opacity":"1"}}),e("stop",{offset:"100%",style:{"stop-color":"#f59e0b","stop-opacity":"1"}})])]),e("rect",{x:"25",y:"15",width:"50",height:"70",rx:"2",fill:"url(#pdfGradient)",stroke:"#3b82f6","stroke-width":"3",class:"animate-pulse"}),e("line",{x1:"35",y1:"30",x2:"65",y2:"30",stroke:"#6366f1","stroke-width":"2.5",class:"animate-pulse"}),e("line",{x1:"35",y1:"45",x2:"60",y2:"45",stroke:"#8b5cf6","stroke-width":"2.5",class:"animate-pulse",style:{"animation-delay":"0.2s"}}),e("line",{x1:"35",y1:"60",x2:"55",y2:"60",stroke:"#a855f7","stroke-width":"2.5",class:"animate-pulse",style:{"animation-delay":"0.4s"}}),e("g",{class:"animate-bounce",style:{"animation-duration":"1.5s"}},[e("rect",{x:"8",y:"32",width:"10",height:"10",rx:"1.5",fill:"url(#textGradient)",stroke:"#059669","stroke-width":"1"}),e("line",{x1:"10",y1:"36",x2:"16",y2:"36",stroke:"white","stroke-width":"1.5"}),e("line",{x1:"10",y1:"39",x2:"16",y2:"39",stroke:"white","stroke-width":"1.5"})]),e("g",{class:"animate-bounce",style:{"animation-duration":"1.5s","animation-delay":"0.3s"}},[e("rect",{x:"8",y:"48",width:"10",height:"10",rx:"1.5",fill:"url(#imageGradient)",stroke:"#d97706","stroke-width":"1"}),e("circle",{cx:"13",cy:"53",r:"2.5",fill:"white"}),e("circle",{cx:"11",cy:"51",r:"1",fill:"#fef3c7"})]),e("g",{class:"animate-pulse",style:{"animation-duration":"1.5s"}},[e("line",{x1:"20",y1:"37",x2:"25",y2:"37",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round"}),e("polyline",{points:"23,35 25,37 23,39",fill:"#10b981",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"20",y1:"53",x2:"25",y2:"53",stroke:"#f59e0b","stroke-width":"3","stroke-linecap":"round"}),e("polyline",{points:"23,51 25,53 23,55",fill:"#f59e0b",stroke:"#f59e0b","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"})]),e("g",{class:"animate-bounce",style:{"animation-duration":"1.5s","animation-delay":"0.5s"}},[e("rect",{x:"82",y:"32",width:"10",height:"10",rx:"1.5",fill:"url(#textGradient)",stroke:"#059669","stroke-width":"1"}),e("line",{x1:"84",y1:"36",x2:"90",y2:"36",stroke:"white","stroke-width":"1.5"}),e("line",{x1:"84",y1:"39",x2:"90",y2:"39",stroke:"white","stroke-width":"1.5"})]),e("g",{class:"animate-bounce",style:{"animation-duration":"1.5s","animation-delay":"0.8s"}},[e("rect",{x:"82",y:"48",width:"10",height:"10",rx:"1.5",fill:"url(#imageGradient)",stroke:"#d97706","stroke-width":"1"}),e("circle",{cx:"87",cy:"53",r:"2.5",fill:"white"}),e("circle",{cx:"85",cy:"51",r:"1",fill:"#fef3c7"})]),e("g",{class:"animate-pulse",style:{"animation-duration":"1.5s","animation-delay":"0.5s"}},[e("line",{x1:"75",y1:"37",x2:"70",y2:"37",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round"}),e("polyline",{points:"72,35 70,37 72,39",fill:"#10b981",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"}),e("line",{x1:"75",y1:"53",x2:"70",y2:"53",stroke:"#f59e0b","stroke-width":"3","stroke-linecap":"round"}),e("polyline",{points:"72,51 70,53 72,55",fill:"#f59e0b",stroke:"#f59e0b","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)])])):T.value==="download"?(p(),c("div",sl,[...t[36]||(t[36]=[e("svg",{viewBox:"0 0 100 100",class:"w-full h-full"},[e("defs",null,[e("linearGradient",{id:"downloadGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#10b981","stop-opacity":"1"}}),e("stop",{offset:"100%",style:{"stop-color":"#059669","stop-opacity":"1"}})]),e("linearGradient",{id:"docGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#3b82f6","stop-opacity":"0.4"}}),e("stop",{offset:"100%",style:{"stop-color":"#2563eb","stop-opacity":"0.6"}})])]),e("line",{x1:"50",y1:"25",x2:"50",y2:"60",stroke:"url(#downloadGradient)","stroke-width":"5","stroke-linecap":"round",class:"animate-bounce"}),e("polyline",{points:"45,55 50,60 55,55",fill:"url(#downloadGradient)",stroke:"url(#downloadGradient)","stroke-width":"5","stroke-linecap":"round","stroke-linejoin":"round",class:"animate-bounce"}),e("rect",{x:"35",y:"65",width:"30",height:"20",rx:"2",fill:"url(#docGradient)",stroke:"#3b82f6","stroke-width":"2",class:"animate-pulse"}),e("line",{x1:"40",y1:"72",x2:"60",y2:"72",stroke:"#60a5fa","stroke-width":"1.5",class:"animate-pulse"}),e("line",{x1:"40",y1:"78",x2:"55",y2:"78",stroke:"#60a5fa","stroke-width":"1.5",class:"animate-pulse",style:{"animation-delay":"0.2s"}})],-1)])])):T.value==="pdf-load"?(p(),c("div",il,[...t[37]||(t[37]=[e("svg",{viewBox:"0 0 100 100",class:"w-full h-full"},[e("defs",null,[e("linearGradient",{id:"page1Gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#c084fc","stop-opacity":"0.3"}}),e("stop",{offset:"100%",style:{"stop-color":"#a855f7","stop-opacity":"0.4"}})]),e("linearGradient",{id:"page2Gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#818cf8","stop-opacity":"0.4"}}),e("stop",{offset:"100%",style:{"stop-color":"#6366f1","stop-opacity":"0.5"}})]),e("linearGradient",{id:"page3Gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#60a5fa","stop-opacity":"0.5"}}),e("stop",{offset:"100%",style:{"stop-color":"#3b82f6","stop-opacity":"0.6"}})])]),e("rect",{x:"25",y:"20",width:"50",height:"60",rx:"2",fill:"url(#page1Gradient)",stroke:"#a855f7","stroke-width":"2",class:"animate-pulse",style:{"animation-delay":"0.4s"}}),e("rect",{x:"27",y:"22",width:"50",height:"60",rx:"2",fill:"url(#page2Gradient)",stroke:"#6366f1","stroke-width":"2",class:"animate-pulse",style:{"animation-delay":"0.2s"}}),e("rect",{x:"29",y:"24",width:"50",height:"60",rx:"2",fill:"url(#page3Gradient)",stroke:"#3b82f6","stroke-width":"3",class:"animate-pulse"}),e("line",{x1:"35",y1:"35",x2:"65",y2:"35",stroke:"#60a5fa","stroke-width":"2",class:"animate-pulse"}),e("line",{x1:"35",y1:"45",x2:"60",y2:"45",stroke:"#818cf8","stroke-width":"2",class:"animate-pulse",style:{"animation-delay":"0.2s"}}),e("line",{x1:"35",y1:"55",x2:"55",y2:"55",stroke:"#a855f7","stroke-width":"2",class:"animate-pulse",style:{"animation-delay":"0.4s"}})],-1)])])):(p(),c("div",rl,[...t[38]||(t[38]=[e("svg",{class:"animate-spin w-12 h-12",viewBox:"0 0 24 24"},[e("defs",null,[e("linearGradient",{id:"spinnerGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#3b82f6","stop-opacity":"1"}}),e("stop",{offset:"25%",style:{"stop-color":"#8b5cf6","stop-opacity":"1"}}),e("stop",{offset:"50%",style:{"stop-color":"#ec4899","stop-opacity":"1"}}),e("stop",{offset:"75%",style:{"stop-color":"#f59e0b","stop-opacity":"1"}}),e("stop",{offset:"100%",style:{"stop-color":"#10b981","stop-opacity":"1"}})])]),e("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"url(#spinnerGradient)","stroke-width":"3","stroke-linecap":"round","stroke-dasharray":"60","stroke-dashoffset":"15"})],-1)])])),e("p",ul,q(J.value),1),T.value==="generate"||T.value==="upload"?(p(),c("div",dl,[T.value==="generate"?(p(),c("div",fl,[...t[39]||(t[39]=[e("div",{class:"h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full animate-pulse",style:{width:"100%","background-size":"200% 100%","background-image":"linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%)",animation:"shimmer 2s ease-in-out infinite"}},null,-1)])])):S("",!0),a(o(Q),{onClick:t[0]||(t[0]=n=>T.value==="generate"?Ce():Fe()),variant:"outline",size:"sm",class:"w-full"},{default:i(()=>[v(q(T.value==="generate"?"Cancel Generation":"Cancel Upload"),1)]),_:1})])):S("",!0)])])])],32)):S("",!0)]),_:1}),e("div",{class:ne(["h-[calc(100vh-4rem)] flex flex-col p-4 overflow-hidden",{"pointer-events-none":M.value}]),style:oe(M.value?{"user-select":"none"}:{})},[e("div",pl,[t[41]||(t[41]=e("div",null,[e("h1",{class:"text-2xl font-semibold"},"PDF Template")],-1)),e("div",vl,[e("div",cl,[a(o(h),{class:"text-sm whitespace-nowrap"},{default:i(()=>[...t[40]||(t[40]=[v("Page:",-1)])]),_:1}),e("div",ml,[(p(!0),c(ae,null,ue(k.value.pages,(n,m)=>(p(),me(o(Q),{key:n.id,size:"sm",variant:"outline",class:ne(w.value===m?"bg-blue-500 text-white border-blue-500":""),onClick:A=>Ee(m)},{default:i(()=>[v(q(m+1),1)]),_:2},1032,["class","onClick"]))),128))])]),a(o(Q),{onClick:Me,disabled:!de.value||!fe.value||F.value},{default:i(()=>[v(q(F.value?"Generating":"Generate & Preview"),1)]),_:1},8,["disabled"])])]),e("div",gl,[a(o(pe),{class:"w-80 flex-shrink-0 flex flex-col overflow-hidden"},{default:i(()=>[a(o(ve),{class:"flex-1 overflow-auto min-h-0 space-y-6"},{default:i(()=>[e("div",null,[e("div",yl,[a(o(h),{class:"text-base font-semibold"},{default:i(()=>[...t[42]||(t[42]=[v("Fields",-1)])]),_:1}),a(o(be),{open:W.value,"onUpdate:open":t[14]||(t[14]=n=>W.value=n)},{default:i(()=>[a(o(Oe),{"as-child":""},{default:i(()=>[a(o(Q),{size:"sm"},{default:i(()=>[a(o(qe),{class:"mr-2 h-4 w-4"}),t[43]||(t[43]=v(" Add Field ",-1))]),_:1})]),_:1}),a(o(we),null,{default:i(()=>[a(o(he),null,{default:i(()=>[a(o(ke),null,{default:i(()=>[...t[44]||(t[44]=[v("Add Field",-1)])]),_:1}),a(o(De),null,{default:i(()=>[...t[45]||(t[45]=[v("Add a new field to the template",-1)])]),_:1})]),_:1}),e("div",xl,[e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[46]||(t[46]=[v("Label",-1)])]),_:1}),a(o(X),{modelValue:d.value.label,"onUpdate:modelValue":t[4]||(t[4]=n=>d.value.label=n),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[47]||(t[47]=[v("Column Name",-1)])]),_:1}),a(o(X),{modelValue:d.value.column,"onUpdate:modelValue":t[5]||(t[5]=n=>d.value.column=n),placeholder:"e.g., name"},null,8,["modelValue"])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[48]||(t[48]=[v("Font Size",-1)])]),_:1}),a(o(X),{modelValue:d.value.fontSize,"onUpdate:modelValue":t[6]||(t[6]=n=>d.value.fontSize=n),modelModifiers:{number:!0},type:"number",min:"8",max:"72"},null,8,["modelValue"])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[49]||(t[49]=[v("Text Align",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[7]||(t[7]=n=>d.value.textAlign=n),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...t[50]||(t[50]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],512),[[O,d.value.textAlign]])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[51]||(t[51]=[v("Font Family",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[8]||(t[8]=n=>d.value.fontFamily=n),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...t[52]||(t[52]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[O,d.value.fontFamily]])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[53]||(t[53]=[v("Font Color",-1)])]),_:1}),e("div",bl,[a(o(X),{modelValue:d.value.fontColor,"onUpdate:modelValue":t[9]||(t[9]=n=>d.value.fontColor=n),type:"color",class:"h-9 w-20 cursor-pointer"},null,8,["modelValue"]),a(o(X),{modelValue:d.value.fontColor,"onUpdate:modelValue":t[10]||(t[10]=n=>d.value.fontColor=n),type:"text",placeholder:"#000000",class:"flex-1"},null,8,["modelValue"])])]),e("div",wl,[e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[54]||(t[54]=[v("Font Weight",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[11]||(t[11]=n=>d.value.fontWeight=n),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...t[55]||(t[55]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],512),[[O,d.value.fontWeight]])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[56]||(t[56]=[v("Font Style",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[12]||(t[12]=n=>d.value.fontStyle=n),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...t[57]||(t[57]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],512),[[O,d.value.fontStyle]])])]),e("div",null,[a(o(h),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...t[58]||(t[58]=[v("Text Decoration",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[13]||(t[13]=n=>d.value.textDecoration=n),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...t[59]||(t[59]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],512),[[O,d.value.textDecoration]])])]),a(o(lt),null,{default:i(()=>[a(o(Q),{onClick:l,class:"w-full sm:w-auto",disabled:!u.value},{default:i(()=>[...t[60]||(t[60]=[v(" Add Field ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),e("div",hl,[(p(!0),c(ae,null,ue(_.value.fields,n=>(p(),c("div",{key:n.id,class:ne(["group p-2 border rounded cursor-pointer transition-colors",g.value?.id===n.id?"border-blue-500 bg-blue-100":"border-gray-200 hover:bg-gray-50"]),onClick:m=>x(n)},[e("div",Cl,[e("div",Fl,[e("span",{class:ne(["text-sm font-semibold transition-colors",g.value?.id===n.id?"text-blue-700":"text-gray-900 group-hover:text-blue-600"])},q(n.label||n.column),3),n.label&&n.column?(p(),c("span",{key:0,class:ne(["text-xs mt-0.5 transition-colors",g.value?.id===n.id?"text-gray-600":"text-gray-600 group-hover:text-gray-800"])}," Column: "+q(n.column),3)):S("",!0)]),e("div",Pl,[e("button",{onClick:G(m=>j(n),["stop"]),class:"text-blue-500 hover:text-blue-700 p-1",title:"Edit field"},[a(o(ot),{class:"h-4 w-4"})],8,Ul),e("button",{onClick:G(m=>s(n.id),["stop"]),class:"text-red-500 hover:text-red-700 p-1",title:"Delete field"},[a(o(Xe),{class:"h-4 w-4"})],8,Sl)])])],10,kl))),128)),_.value.fields.length===0?(p(),c("p",Dl,' No fields yet. Click "Add Field" to create one. ')):S("",!0)])]),e("div",$l,[a(o(h),{class:"text-base font-semibold mb-3 block"},{default:i(()=>[...t[61]||(t[61]=[v("Upload PDF Template",-1)])]),_:1}),a(el,{ref_key:"pdfUploaderRef",ref:ce,onUploaded:Pe,"pdf-url":z.value,"no-card":!0,onLoading:t[15]||(t[15]=(n,m)=>{M.value=n,J.value=m||"Processing...",T.value=n?"upload":"default"})},null,8,["pdf-url"])]),e("div",Al,[a(o(h),{class:"text-base font-semibold mb-3 block"},{default:i(()=>[...t[62]||(t[62]=[v("Upload Excel",-1)])]),_:1}),a(Ht,{ref_key:"excelUploaderRef",ref:ie,onUploaded:Ne,"excel-data":b.value,"no-card":!0,onViewFile:t[16]||(t[16]=n=>L.value=!0),onLoading:t[17]||(t[17]=(n,m)=>{M.value=n,J.value=m||"Processing...",T.value=n?"upload":"default"})},null,8,["excel-data"])])]),_:1})]),_:1}),a(o(be),{open:U.value,"onUpdate:open":t[28]||(t[28]=n=>U.value=n)},{default:i(()=>[a(o(we),null,{default:i(()=>[a(o(he),null,{default:i(()=>[a(o(ke),null,{default:i(()=>[...t[63]||(t[63]=[v("Edit Field",-1)])]),_:1}),a(o(De),null,{default:i(()=>[...t[64]||(t[64]=[v("Edit field properties",-1)])]),_:1})]),_:1}),e("div",zl,[e("div",null,[a(o(h),null,{default:i(()=>[...t[65]||(t[65]=[v("Label",-1)])]),_:1}),a(o(X),{modelValue:d.value.label,"onUpdate:modelValue":t[18]||(t[18]=n=>d.value.label=n),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[66]||(t[66]=[v("Column Name",-1)])]),_:1}),a(o(X),{modelValue:d.value.column,"onUpdate:modelValue":t[19]||(t[19]=n=>d.value.column=n),placeholder:"e.g., name"},null,8,["modelValue"])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[67]||(t[67]=[v("Font Size",-1)])]),_:1}),a(o(X),{modelValue:d.value.fontSize,"onUpdate:modelValue":t[20]||(t[20]=n=>d.value.fontSize=n),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[68]||(t[68]=[v("Text Align",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[21]||(t[21]=n=>d.value.textAlign=n),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[69]||(t[69]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],512),[[O,d.value.textAlign]])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[70]||(t[70]=[v("Font Family",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[22]||(t[22]=n=>d.value.fontFamily=n),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[71]||(t[71]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[O,d.value.fontFamily]])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[72]||(t[72]=[v("Font Color",-1)])]),_:1}),a(o(X),{modelValue:d.value.fontColor,"onUpdate:modelValue":t[23]||(t[23]=n=>d.value.fontColor=n),type:"color",class:"h-10"},null,8,["modelValue"])]),e("div",_l,[e("div",null,[a(o(h),null,{default:i(()=>[...t[73]||(t[73]=[v("Font Weight",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[24]||(t[24]=n=>d.value.fontWeight=n),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[74]||(t[74]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],512),[[O,d.value.fontWeight]])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[75]||(t[75]=[v("Font Style",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[25]||(t[25]=n=>d.value.fontStyle=n),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[76]||(t[76]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],512),[[O,d.value.fontStyle]])])]),e("div",null,[a(o(h),null,{default:i(()=>[...t[77]||(t[77]=[v("Text Decoration",-1)])]),_:1}),H(e("select",{"onUpdate:modelValue":t[26]||(t[26]=n=>d.value.textDecoration=n),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[78]||(t[78]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],512),[[O,d.value.textDecoration]])]),e("div",Vl,[a(o(Q),{onClick:V,class:"flex-1",disabled:!d.value.label?.trim()||!d.value.column?.trim()},{default:i(()=>[...t[79]||(t[79]=[v(" Update Field ",-1)])]),_:1},8,["disabled"]),a(o(Q),{variant:"outline",onClick:t[27]||(t[27]=()=>{U.value=!1,$.value=null}),class:"flex-1"},{default:i(()=>[...t[80]||(t[80]=[v(" Cancel ",-1)])]),_:1})])])]),_:1})]),_:1},8,["open"]),e("div",El,[a(Et,{template:{name:k.value.name,width:k.value.width,height:k.value.height,fields:_.value.fields},"show-only-canvas":!0,"selected-field-id":g.value?.id||null,"pdf-background-url":z.value,"current-page-number":w.value+1,onUpdate:t[29]||(t[29]=n=>{_.value.fields=n.fields,Y(k.value)}),onFieldSelected:x,onPdfImageConverted:ye,onPdfPagesDetected:xe,onLoading:t[30]||(t[30]=(n,m)=>{M.value=n,J.value=m||"Processing...",T.value=n?"pdf-load":"default"})},null,8,["template","selected-field-id","pdf-background-url","current-page-number"])])])],6),(p(),me(o(be),{open:E.value,"onUpdate:open":t[32]||(t[32]=n=>E.value=n),key:`preview-modal-${K.value}`},{default:i(()=>[a(o(we),{class:"!w-[80vw] !max-w-[80vw] max-h-[90vh] overflow-hidden flex flex-col mx-auto"},{default:i(()=>[a(o(he),null,{default:i(()=>[a(o(ke),null,{default:i(()=>[...t[81]||(t[81]=[v("PDF Preview",-1)])]),_:1}),a(o(De),null,{default:i(()=>[...t[82]||(t[82]=[v("Preview and download generated PDFs",-1)])]),_:1})]),_:1}),e("div",Nl,[f.value.length===0?(p(),c("div",Ml," No PDFs generated yet. ")):(p(),c("div",Ll,[e("div",jl,[e("div",Tl,[e("div",Gl,[D.value?(p(),c("iframe",{key:0,src:D.value,class:"w-full h-full border-0"},null,8,Rl)):f.value[0]?.base64?(p(),c("iframe",{key:1,src:`data:application/pdf;base64,${f.value[0].base64}`,class:"w-full h-full border-0"},null,8,Wl)):f.value[0]?.base64?(p(),c("object",{key:2,data:`data:application/pdf;base64,${f.value[0].base64}`,type:"application/pdf",class:"w-full h-full border-0"},[e("p",Il,[t[83]||(t[83]=v(" PDF cannot be displayed. ",-1)),e("a",{href:`data:application/pdf;base64,${f.value[0].base64}`,download:"preview.pdf",class:"text-blue-500 underline ml-2"},"Download instead",8,Hl)])],8,Bl)):(p(),c("div",Ol,[...t[84]||(t[84]=[e("p",null,"PDF data is missing",-1)])]))])])])]))]),e("div",ql,[a(o(Q),{variant:"outline",onClick:t[31]||(t[31]=n=>E.value=!1)},{default:i(()=>[...t[85]||(t[85]=[v(" Close ",-1)])]),_:1}),f.value.length>0?(p(),me(o(Q),{key:0,onClick:le},{default:i(()=>[v(" Download All PDFs ("+q(f.value.length)+") ",1)]),_:1})):S("",!0)])]),_:1})]),_:1},8,["open"])),a(o(be),{open:L.value,"onUpdate:open":t[33]||(t[33]=n=>L.value=n)},{default:i(()=>[a(o(we),{class:"!w-[80vw] !max-w-[80vw] max-h-[90vh] overflow-hidden flex flex-col mx-auto"},{default:i(()=>[a(o(he),null,{default:i(()=>[a(o(ke),null,{default:i(()=>[...t[86]||(t[86]=[v("Excel File Data",-1)])]),_:1}),a(o(De),null,{default:i(()=>[...t[87]||(t[87]=[v("View uploaded Excel file data",-1)])]),_:1})]),_:1}),e("div",Xl,[b.value.length===0?(p(),c("div",Yl," No Excel data available. ")):(p(),c("div",Ql,[e("div",Kl,[e("table",Zl,[e("thead",Jl,[e("tr",null,[(p(!0),c(ae,null,ue(P.value,(n,m)=>(p(),c("th",{key:m,class:"px-4 py-3 text-left font-bold border-b border-slate-600 text-white uppercase tracking-wide"},q(n),1))),128))])]),e("tbody",eo,[(p(!0),c(ae,null,ue(b.value,(n,m)=>(p(),c("tr",{key:m,class:"border-b border-gray-200 hover:bg-blue-50 transition-colors"},[(p(!0),c(ae,null,ue(P.value,(A,N)=>(p(),c("td",{key:N,class:"px-4 py-2 text-gray-800 font-medium"},q(n[A]),1))),128))]))),128))])])]),e("div",to," Total rows: "+q(b.value.length),1)]))])]),_:1})]),_:1},8,["open"])]),_:1})],64))}}),oo=(te,k)=>{const b=te.__vccOpts||te;for(const[P,C]of k)b[P]=C;return b},Po=oo(lo,[["__scopeId","data-v-ddc661da"]]);export{Po as default};
