import{d as ve,p as C,c as K,a as P,o as _,b as T,f as n,e as A,h as me,g as ee,k as re,F as te,r as de,t as z,y as be,n as R,D as xe,E as we}from"./app-B_19Bpb-.js";import{S as V}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{T as ke,U as Pe}from"./upload-DpYwhaHo.js";import{I as pe,a as _e,C as Se,X as Ce}from"./x-Obp8ukFl.js";import{c as oe}from"./createLucideIcon-B8wsB4w6.js";import{P as Ee}from"./plus-CcwODJvJ.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=oe("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=oe("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=oe("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=oe("MinusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var ge={exports:{}},ye;function $e(){return ye||(ye=1,(function(ae){(function(w){var v=le(),B=ce(),O=m(),H=ue(),F={imagePlaceholder:void 0,cacheBust:!1},b={toSvg:Y,toPng:ne,toJpeg:Z,toBlob:N,toPixelData:fe,impl:{fontFaces:O,images:H,util:v,inliner:B,options:{}}};ae.exports=b;function Y(i,a){return a=a||{},q(a),Promise.resolve(i).then(function(u){return W(u,a.filter,!0)}).then(Q).then(ie).then(s).then(function(u){return se(u,a.width||v.width(i),a.height||v.height(i))});function s(u){return a.bgcolor&&(u.style.backgroundColor=a.bgcolor),a.width&&(u.style.width=a.width+"px"),a.height&&(u.style.height=a.height+"px"),a.style&&Object.keys(a.style).forEach(function(h){u.style[h]=a.style[h]}),u}}function fe(i,a){return L(i,a||{}).then(function(s){return s.getContext("2d").getImageData(0,0,v.width(i),v.height(i)).data})}function ne(i,a){return L(i,a||{}).then(function(s){return s.toDataURL()})}function Z(i,a){return a=a||{},L(i,a).then(function(s){return s.toDataURL("image/jpeg",a.quality||1)})}function N(i,a){return L(i,a||{}).then(v.canvasToBlob)}function q(i){typeof i.imagePlaceholder>"u"?b.impl.options.imagePlaceholder=F.imagePlaceholder:b.impl.options.imagePlaceholder=i.imagePlaceholder,typeof i.cacheBust>"u"?b.impl.options.cacheBust=F.cacheBust:b.impl.options.cacheBust=i.cacheBust}function L(i,a){return Y(i,a).then(v.makeImage).then(v.delay(100)).then(function(u){var h=s(i);return h.getContext("2d").drawImage(u,0,0),h});function s(u){var h=document.createElement("canvas");if(h.width=a.width||v.width(u),h.height=a.height||v.height(u),a.bgcolor){var g=h.getContext("2d");g.fillStyle=a.bgcolor,g.fillRect(0,0,h.width,h.height)}return h}}function W(i,a,s){if(!s&&a&&!a(i))return Promise.resolve();return Promise.resolve(i).then(u).then(function(c){return h(i,c,a)}).then(function(c){return g(i,c)});function u(c){return c instanceof HTMLCanvasElement?v.makeImage(c.toDataURL()):c.cloneNode(!1)}function h(c,p,E){var $=c.childNodes;if($.length===0)return Promise.resolve(p);return k(p,v.asArray($),E).then(function(){return p});function k(j,I,r){var t=Promise.resolve();return I.forEach(function(e){t=t.then(function(){return W(e,r)}).then(function(d){d&&j.appendChild(d)})}),t}}function g(c,p){if(!(p instanceof Element))return p;return Promise.resolve().then(E).then($).then(k).then(j).then(function(){return p});function E(){I(window.getComputedStyle(c),p.style);function I(r,t){r.cssText?t.cssText=r.cssText:e(r,t);function e(d,x){v.asArray(d).forEach(function(o){x.setProperty(o,d.getPropertyValue(o),d.getPropertyPriority(o))})}}}function $(){[":before",":after"].forEach(function(r){I(r)});function I(r){var t=window.getComputedStyle(c,r),e=t.getPropertyValue("content");if(e===""||e==="none")return;var d=v.uid();p.className=p.className+" "+d;var x=document.createElement("style");x.appendChild(o(d,r,t)),p.appendChild(x);function o(l,f,y){var S="."+l+":"+f,D=y.cssText?X(y):G(y);return document.createTextNode(S+"{"+D+"}");function X(M){var U=M.getPropertyValue("content");return M.cssText+" content: "+U+";"}function G(M){return v.asArray(M).map(U).join("; ")+";";function U(J){return J+": "+M.getPropertyValue(J)+(M.getPropertyPriority(J)?" !important":"")}}}}}function k(){c instanceof HTMLTextAreaElement&&(p.innerHTML=c.value),c instanceof HTMLInputElement&&p.setAttribute("value",c.value)}function j(){p instanceof SVGElement&&(p.setAttribute("xmlns","http://www.w3.org/2000/svg"),p instanceof SVGRectElement&&["width","height"].forEach(function(I){var r=p.getAttribute(I);r&&p.style.setProperty(I,r)}))}}}function Q(i){return O.resolveAll().then(function(a){var s=document.createElement("style");return i.appendChild(s),s.appendChild(document.createTextNode(a)),i})}function ie(i){return H.inlineAll(i).then(function(){return i})}function se(i,a,s){return Promise.resolve(i).then(function(u){return u.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(u)}).then(v.escapeXhtml).then(function(u){return'<foreignObject x="0" y="0" width="100%" height="100%">'+u+"</foreignObject>"}).then(function(u){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+a+'" height="'+s+'">'+u+"</svg>"}).then(function(u){return"data:image/svg+xml;charset=utf-8,"+u})}function le(){return{escape:j,parseExtension:a,mimeType:s,dataAsUrl:k,isDataUrl:u,canvasToBlob:g,resolveUrl:c,getAndEncode:$,uid:p(),delay:I,asArray:r,escapeXhtml:t,makeImage:E,width:e,height:d};function i(){var o="application/font-woff",l="image/jpeg";return{woff:o,woff2:o,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:l,jpeg:l,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function a(o){var l=/\.([^\.\/]*?)$/g.exec(o);return l?l[1]:""}function s(o){var l=a(o).toLowerCase();return i()[l]||""}function u(o){return o.search(/^(data:)/)!==-1}function h(o){return new Promise(function(l){for(var f=window.atob(o.toDataURL().split(",")[1]),y=f.length,S=new Uint8Array(y),D=0;D<y;D++)S[D]=f.charCodeAt(D);l(new Blob([S],{type:"image/png"}))})}function g(o){return o.toBlob?new Promise(function(l){o.toBlob(l)}):h(o)}function c(o,l){var f=document.implementation.createHTMLDocument(),y=f.createElement("base");f.head.appendChild(y);var S=f.createElement("a");return f.body.appendChild(S),y.href=l,S.href=o,S.href}function p(){var o=0;return function(){return"u"+l()+o++;function l(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function E(o){return new Promise(function(l,f){var y=new Image;y.onload=function(){l(y)},y.onerror=f,y.src=o})}function $(o){var l=3e4;return b.impl.options.cacheBust&&(o+=(/\?/.test(o)?"&":"?")+new Date().getTime()),new Promise(function(f){var y=new XMLHttpRequest;y.onreadystatechange=X,y.ontimeout=G,y.responseType="blob",y.timeout=l,y.open("GET",o,!0),y.send();var S;if(b.impl.options.imagePlaceholder){var D=b.impl.options.imagePlaceholder.split(/,/);D&&D[1]&&(S=D[1])}function X(){if(y.readyState===4){if(y.status!==200){S?f(S):M("cannot fetch resource: "+o+", status: "+y.status);return}var U=new FileReader;U.onloadend=function(){var J=U.result.split(/,/)[1];f(J)},U.readAsDataURL(y.response)}}function G(){S?f(S):M("timeout of "+l+"ms occured while fetching resource: "+o)}function M(U){console.error(U),f("")}})}function k(o,l){return"data:"+l+";base64,"+o}function j(o){return o.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function I(o){return function(l){return new Promise(function(f){setTimeout(function(){f(l)},o)})}}function r(o){for(var l=[],f=o.length,y=0;y<f;y++)l.push(o[y]);return l}function t(o){return o.replace(/#/g,"%23").replace(/\n/g,"%0A")}function e(o){var l=x(o,"border-left-width"),f=x(o,"border-right-width");return o.scrollWidth+l+f}function d(o){var l=x(o,"border-top-width"),f=x(o,"border-bottom-width");return o.scrollHeight+l+f}function x(o,l){var f=window.getComputedStyle(o).getPropertyValue(l);return parseFloat(f.replace("px",""))}}function ce(){var i=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:h,shouldProcess:a,impl:{readUrls:s,inline:u}};function a(g){return g.search(i)!==-1}function s(g){for(var c=[],p;(p=i.exec(g))!==null;)c.push(p[1]);return c.filter(function(E){return!v.isDataUrl(E)})}function u(g,c,p,E){return Promise.resolve(c).then(function(k){return p?v.resolveUrl(k,p):k}).then(E||v.getAndEncode).then(function(k){return v.dataAsUrl(k,v.mimeType(c))}).then(function(k){return g.replace($(c),"$1"+k+"$3")});function $(k){return new RegExp(`(url\\(['"]?)(`+v.escape(k)+`)(['"]?\\))`,"g")}}function h(g,c,p){if(E())return Promise.resolve(g);return Promise.resolve(g).then(s).then(function($){var k=Promise.resolve(g);return $.forEach(function(j){k=k.then(function(I){return u(I,j,c,p)})}),k});function E(){return!a(g)}}}function m(){return{resolveAll:i,impl:{readAll:a}};function i(){return a().then(function(s){return Promise.all(s.map(function(u){return u.resolve()}))}).then(function(s){return s.join(`
`)})}function a(){return Promise.resolve(v.asArray(document.styleSheets)).then(u).then(s).then(function(g){return g.map(h)});function s(g){return g.filter(function(c){return c.type===CSSRule.FONT_FACE_RULE}).filter(function(c){return B.shouldProcess(c.style.getPropertyValue("src"))})}function u(g){var c=[];return g.forEach(function(p){try{v.asArray(p.cssRules||[]).forEach(c.push.bind(c))}catch(E){console.log("Error while reading CSS rules from "+p.href,E.toString())}}),c}function h(g){return{resolve:function(){var p=(g.parentStyleSheet||{}).href;return B.inlineAll(g.cssText,p)},src:function(){return g.style.getPropertyValue("src")}}}}}function ue(){return{inlineAll:a,impl:{newImage:i}};function i(s){return{inline:u};function u(h){return v.isDataUrl(s.src)?Promise.resolve():Promise.resolve(s.src).then(h||v.getAndEncode).then(function(g){return v.dataAsUrl(g,v.mimeType(s.src))}).then(function(g){return new Promise(function(c,p){s.onload=c,s.onerror=p,s.src=g})})}}function a(s){if(!(s instanceof Element))return Promise.resolve(s);return u(s).then(function(){return s instanceof HTMLImageElement?i(s).inline():Promise.all(v.asArray(s.childNodes).map(function(h){return a(h)}))});function u(h){var g=h.style.getPropertyValue("background");return g?B.inlineAll(g).then(function(c){h.style.setProperty("background",c,h.style.getPropertyPriority("background"))}).then(function(){return h}):Promise.resolve(h)}}}})()})(ge)),ge.exports}var he=$e();const Me={class:"mx-auto px-4 py-6 sm:px-6 lg:px-8"},De={class:"grid gap-6 lg:grid-cols-4"},Re={class:"lg:col-span-1"},Be={class:"space-y-4 max-h-[calc(100vh-2rem)] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600"},je={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Xe={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Fe={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Le={class:"p-4 space-y-4"},We={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Oe=["onUpdate:modelValue","placeholder"],Ye={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},ze={class:"p-4 border-b border-gray-200 dark:border-gray-700"},He={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Ne={class:"p-4"},Ve={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},qe={class:"space-y-2"},Ge=["id","onChange"],Je={key:0},Ke=["for"],Ze={class:"flex flex-col items-center justify-center py-3"},Qe={key:1,class:"relative group"},er=["src","alt"],rr=["onClick"],tr={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},or={class:"p-4 border-b border-gray-200 dark:border-gray-700"},ar={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},nr={class:"p-4 space-y-4"},ir={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},sr={class:"flex items-center gap-3"},lr=["disabled"],cr={class:"flex-1"},ur=["value"],dr=["disabled"],pr={class:"space-y-2"},gr={class:"flex justify-center"},hr={class:"flex justify-center gap-2"},fr={class:"flex justify-center"},yr={class:"lg:col-span-3"},vr={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},mr={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},br={class:"text-lg font-semibold text-gray-900 dark:text-white"},xr=["disabled"],wr={class:"p-4"},kr={class:"flex justify-center items-start min-h-[400px]"},Pr={class:"relative",style:{margin:"20px 0"}},_r=["onMousedown"],Sr=["onMousedown"],Cr=["src","alt","onClick","onMousedown"],Er={key:1,class:"flex items-center justify-center text-gray-400 bg-gray-50 dark:bg-gray-800/50 w-full h-full"},Dr=ve({__name:"Share",props:{template:{}},setup(ae){const w=ae,v=C(null),B=C(!1);C(!1),C("");const O=C(null);C(10),C(0),C(0),C(1);const H=C(!1),F=C({x:0,y:0,posX:0,posY:0}),b=C(null),Y=C([]);(()=>{let r;if(Array.isArray(w.template.canvas_data))r=w.template.canvas_data;else if(typeof w.template.canvas_data=="string")try{r=JSON.parse(w.template.canvas_data)}catch{r=[]}else r=[];r.filter(e=>e.type==="image").length>0,Y.value=r.map(e=>({...e,properties:{text:e.properties?.text||"",fontSize:e.properties?.fontSize||16,fontFamily:e.properties?.fontFamily||"Arial",fontWeight:e.properties?.fontWeight||"normal",fontStyle:e.properties?.fontStyle||"normal",textDecoration:e.properties?.textDecoration||"none",textAlign:e.properties?.textAlign||"left",lineHeight:e.properties?.lineHeight||1.2,color:e.properties?.color||"#000000",backgroundColor:e.properties?.backgroundColor||(e.type==="text"?"transparent":"#f3f4f6"),hasBorder:e.properties?.hasBorder||!1,borderWidth:e.properties?.borderWidth||1,borderColor:e.properties?.borderColor||"#000000",borderStyle:e.properties?.borderStyle||"solid",borderRadius:e.properties?.borderRadius||0,boxShadow:e.properties?.boxShadow||"none",textShadow:e.properties?.textShadow||"none",imageUrl:e.properties?.imageUrl||"",imageFit:e.properties?.imageFit||"cover",imagePlaceholder:e.properties?.imagePlaceholder||(e.type==="image",""),imageShape:e.properties?.imageShape||"rectangle"}}))})();const ne=K(()=>[...Y.value].sort((r,t)=>r.zIndex-t.zIndex)),Z=K(()=>Y.value.filter(r=>r.type==="text")),N=K(()=>Y.value.filter(r=>r.type==="image")),q=C(!1),L=C({x:0,y:0}),W=C(null),Q=(r,t)=>{v.value=t,t.type!=="image"&&(b.value=null),t.type==="text"&&(r.preventDefault(),q.value=!0,L.value={x:r.clientX-t.x*m.value,y:r.clientY-t.y*m.value},W.value=t)},ie=r=>{q.value&&W.value&&(W.value.x=(r.clientX-L.value.x)/m.value,W.value.y=(r.clientY-L.value.y)/m.value)},se=r=>{q.value=!1,W.value=null},le=r=>{switch(r){case"circle":return"circle(50% at 50% 50%)";case"triangle":return"polygon(50% 0%, 0% 100%, 100% 100%)";case"star":return"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)";case"diamond":return"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)";case"hexagon":return"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)";case"octagon":return"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)";case"rectangle":default:return"none"}},ce=K(()=>{const e=800/w.template.width,d=600/w.template.height,x=Math.min(e,d,1),o=w.template.width*x,l=w.template.height*x;return{width:o+"px",height:l+"px",transform:"none",backgroundImage:w.template.background_image_url?`url(${w.template.background_image_url})`:w.template.background_image?`url(/storage/${w.template.background_image})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",position:"relative"}}),m=K(()=>{const e=800/w.template.width,d=600/w.template.height;return Math.min(e,d,1)}),ue=(r,t)=>{const e=r.target.files?.[0];if(!e)return;if(!e.type.startsWith("image/")){alert("Please select a valid image file.");return}if(e.size>10*1024*1024){alert("File size must be less than 10MB.");return}const d=URL.createObjectURL(e);t.properties.imageUrl=d,t.properties.cropScale||(t.properties.cropScale=10),t.properties.cropPositionX||(t.properties.cropPositionX=0),t.properties.cropPositionY||(t.properties.cropPositionY=0),t.uploadedFile=e},i=r=>{const t=r.properties.cropScale||0,e=Math.min(t+1,200);r.properties.cropScale=e},a=r=>{const t=r.properties.cropScale||0,e=Math.max(t-1,0);r.properties.cropScale=e},s=(r,t)=>{r.properties.cropScale=Math.max(0,Math.min(200,t))},u=(r,t)=>{r.stopPropagation(),b.value=t},h=(r,t)=>{r.stopPropagation(),H.value=!0,O.value=t,b.value=t,F.value={x:r.clientX,y:r.clientY,posX:t.properties.cropPositionX||0,posY:t.properties.cropPositionY||0}},g=r=>{if(!H.value||!O.value)return;const t=r.clientX-F.value.x,e=r.clientY-F.value.y,d=F.value.posX+t/m.value,x=F.value.posY+e/m.value;O.value.properties.cropPositionX=d,O.value.properties.cropPositionY=x},c=()=>{H.value=!1},p=r=>{const t=r.properties.cropPositionY||0;r.properties.cropPositionY=t-10},E=r=>{const t=r.properties.cropPositionY||0;r.properties.cropPositionY=t+10},$=r=>{const t=r.properties.cropPositionX||0;r.properties.cropPositionX=t-10},k=r=>{const t=r.properties.cropPositionX||0;r.properties.cropPositionX=t+10},j=r=>{r.properties.imageUrl&&r.properties.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(r.properties.imageUrl),r.properties.imageUrl="",r.uploadedFile=null},I=async()=>{B.value=!0,V.fire({title:"Generating Image...",text:"Please wait while we create your image.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{V.showLoading()}});try{const r=document.querySelector(".template-preview-container");if(!r)throw new Error("Preview container not found");await(async()=>{const f=r.querySelectorAll("img"),y=Array.from(f).map(async(S,D)=>{if(S.src.startsWith("blob:"))try{const X=await fetch(S.src);if(!X.ok)throw new Error(`HTTP ${X.status}: ${X.statusText}`);const G=await X.blob();return new Promise(M=>{const U=new FileReader;U.onload=()=>{S.src=U.result,M(!0)},U.onerror=()=>{M(!1)},U.readAsDataURL(G)})}catch{return!1}else return!0});await Promise.all(y)})();let e;const d=w.template.width,x=w.template.height;try{e=await he.toJpeg(r,{quality:1,width:d,height:x,style:{transform:`scale(${1/m.value})`,transformOrigin:"top left",width:d*m.value+"px",height:x*m.value+"px",imageRendering:"crisp-edges"},pixelRatio:1,cacheBust:!0,filter:f=>!0,useCORS:!0,allowTaint:!0})}catch{try{e=await he.toJpeg(r,{quality:1,bgcolor:"#ffffff",width:d*2,height:x*2,style:{transform:`scale(${2/m.value})`,transformOrigin:"top left",width:d*m.value+"px",height:x*m.value+"px"},pixelRatio:2,cacheBust:!0,useCORS:!0})}catch{e=await he.toJpeg(r,{quality:1,bgcolor:"#ffffff",width:d,height:x,pixelRatio:1,cacheBust:!0})}}const o=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),l=document.createElement("a");l.href=e,l.download=`${w.template.name}_${o}.jpg`,document.body.appendChild(l),l.click(),document.body.removeChild(l);try{const f=await fetch(`/template/${w.template.share_token}/track-download`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json"},body:JSON.stringify({file_name:`${w.template.name}_${o}.jpg`,file_size:e.length})})}catch{}V.close(),V.fire({icon:"success",title:"Download Complete!",text:"Your image has been downloaded successfully.",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(r){V.close();let t="Unknown error occurred while generating image.";r.message?t=r.message:r.name==="SecurityError"?t="Security error: Cannot access the preview element. Please try refreshing the page.":r.name==="InvalidStateError"?t="Invalid state error: The preview element may not be ready. Please try again.":r.toString().includes("canvas")&&(t="Canvas rendering error: Please check if all images are loaded and try again."),V.fire({icon:"error",title:"Download Failed",text:t,confirmButtonText:"Try Again"})}finally{B.value=!1}};return(r,t)=>(_(),P(te,null,[T(A(me),{title:r.template.name},null,8,["title"]),n("div",{class:"min-h-screen bg-gray-50 dark:bg-gray-900",onMouseup:c,onMousemove:g},[n("div",Me,[n("div",De,[n("div",Re,[n("div",Be,[Z.value.length>0?(_(),P("div",je,[n("div",Xe,[n("h2",Fe,[T(A(ke),{class:"h-5 w-5"}),t[7]||(t[7]=re(" Text Content ",-1))])]),n("div",Le,[(_(!0),P(te,null,de(Z.value,(e,d)=>(_(),P("div",{key:e.id,class:"space-y-2"},[n("label",We," Text "+z(d+1),1),xe(n("textarea",{"onUpdate:modelValue":x=>e.properties.text=x,rows:"2",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm",placeholder:`Enter text ${d+1}`},null,8,Oe),[[we,e.properties.text]])]))),128))])])):ee("",!0),N.value.length>0?(_(),P("div",Ye,[n("div",ze,[n("h2",He,[T(A(pe),{class:"h-5 w-5"}),re(" Image Upload ("+z(N.value.length)+") ",1)])]),n("div",Ne,[n("div",{class:be(["grid gap-3",N.value.length>3?"grid-cols-2":"grid-cols-1"])},[(_(!0),P(te,null,de(N.value,(e,d)=>(_(),P("div",{key:e.id,class:"space-y-2"},[n("label",Ve," Image "+z(d+1),1),n("div",qe,[n("input",{id:`image-${e.id}`,type:"file",accept:"image/*",onChange:x=>ue(x,e),class:"hidden"},null,40,Ge),e.properties.imageUrl?(_(),P("div",Qe,[n("img",{src:e.properties.imageUrl,alt:`Image ${d+1}`,class:"w-full h-20 object-cover rounded-lg border border-gray-300 dark:border-gray-600"},null,8,er),n("button",{type:"button",onClick:x=>j(e),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100"},[T(A(Ce),{class:"w-3 h-3"})],8,rr)])):(_(),P("div",Je,[n("label",{for:`image-${e.id}`,class:"flex flex-col items-center justify-center w-full h-20 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"},[n("div",Ze,[T(A(Pe),{class:"w-5 h-5 mb-1 text-gray-500 dark:text-gray-400"}),t[8]||(t[8]=n("p",{class:"text-xs text-gray-500 dark:text-gray-400"},[n("span",{class:"font-semibold"},"Upload")],-1))])],8,Ke)]))])]))),128))],2)])])):ee("",!0),b.value&&b.value.properties.imageUrl?(_(),P("div",tr,[n("div",or,[n("h2",ar,[T(A(pe),{class:"h-5 w-5"}),t[9]||(t[9]=re(" Image Controls ",-1))])]),n("div",nr,[n("div",null,[n("label",ir," Zoom: "+z(b.value.properties.cropScale||0)+"% ",1),n("div",sr,[n("button",{onClick:t[0]||(t[0]=e=>a(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",disabled:(b.value.properties.cropScale||0)<=0},[T(A(Ae),{class:"w-4 h-4"})],8,lr),n("div",cr,[n("input",{type:"range",value:b.value.properties.cropScale||0,onInput:t[1]||(t[1]=e=>s(b.value,parseFloat(e.target.value))),min:"0",max:"200",step:"1",class:"w-full"},null,40,ur)]),n("button",{onClick:t[2]||(t[2]=e=>i(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",disabled:(b.value.properties.cropScale||0)>=200},[T(A(Ee),{class:"w-4 h-4"})],8,dr)])]),n("div",null,[t[10]||(t[10]=n("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Position ",-1)),n("div",pr,[n("div",gr,[n("button",{onClick:t[3]||(t[3]=e=>p(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Move Up"},[T(A(Ue),{class:"w-4 h-4"})])]),n("div",hr,[n("button",{onClick:t[4]||(t[4]=e=>$(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Move Left"},[T(A(Ie),{class:"w-4 h-4"})]),n("button",{onClick:t[5]||(t[5]=e=>k(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Move Right"},[T(A(_e),{class:"w-4 h-4"})])]),n("div",fr,[n("button",{onClick:t[6]||(t[6]=e=>E(b.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Move Down"},[T(A(Se),{class:"w-4 h-4"})])])])])])])):ee("",!0)])]),n("div",yr,[n("div",vr,[n("div",mr,[n("h2",br,z(r.template.name),1),n("button",{onClick:I,disabled:B.value,class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"},[T(A(Te),{class:"h-4 w-4"}),re(" "+z(B.value?"Generating...":"Download Image"),1)],8,xr)]),n("div",wr,[n("div",kr,[n("div",Pr,[n("div",{class:"template-preview-container relative overflow-hidden bg-gray-50 dark:bg-gray-700 shadow-lg",style:R(ce.value),onMousemove:ie,onMouseup:se},[(_(!0),P(te,null,de(ne.value,e=>(_(),P("div",{key:e.id,class:"absolute",style:R({left:e.x*m.value+"px",top:e.y*m.value+"px",width:e.width*m.value+"px",height:e.height*m.value+"px",zIndex:e.zIndex,transform:`rotate(${e.rotation}deg)`,filter:e.properties.boxShadow!=="none"?`drop-shadow(${e.properties.boxShadow})`:"none"})},[e.type==="text"?(_(),P("div",{key:0,class:"w-full h-full flex items-center justify-center cursor-move select-none",style:R({color:e.properties.color,backgroundColor:e.properties.backgroundColor,fontSize:e.properties.fontSize*m.value+"px",fontFamily:e.properties.fontFamily,fontWeight:e.properties.fontWeight,fontStyle:e.properties.fontStyle,textDecoration:e.properties.textDecoration,textAlign:e.properties.textAlign,lineHeight:e.properties.lineHeight,border:e.properties.hasBorder?`${e.properties.strokeWidth*m.value}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.borderRadius*m.value+"px",padding:8*m.value+"px",boxSizing:"border-box",wordWrap:"break-word",overflow:"hidden"}),onMousedown:d=>Q(d,e)},z(e.properties.text||"Your text here"),45,_r)):e.type==="image"?(_(),P("div",{key:1,class:"w-full h-full flex items-center justify-center overflow-hidden relative group",style:R({backgroundColor:e.properties.backgroundColor||"transparent",border:e.properties.hasBorder?`${e.properties.strokeWidth*m.value}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.imageShape==="rectangle"?(e.properties.borderRadius||0)*m.value+"px":"0px",clipPath:le(e.properties.imageShape||"rectangle")}),onMousedown:d=>Q(d,e)},[e.properties.imageUrl?(_(),P("img",{key:0,src:e.properties.imageUrl,alt:e.properties.imagePlaceholder,class:"absolute cursor-move select-none",style:R({width:"auto",height:"auto",maxWidth:"none",maxHeight:"none",objectFit:"none",transform:`translate(-50%, -50%) scale(${Math.max(e.properties.cropScale||0,1)/100}) translate(${(e.properties.cropPositionX||0)*m.value}px, ${(e.properties.cropPositionY||0)*m.value}px)`,top:"50%",left:"50%",transformOrigin:"center"}),onClick:d=>u(d,e),onMousedown:d=>h(d,e)},null,44,Cr)):(_(),P("div",Er,[T(A(pe),{class:"opacity-60",style:R({width:Math.min(e.width*m.value*.4,32)+"px",height:Math.min(e.height*m.value*.4,32)+"px"})},null,8,["style"])]))],44,Sr)):e.type==="rectangle"?(_(),P("div",{key:2,class:"w-full h-full",style:R({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:(e.properties.borderRadius||0)+"px"})},null,4)):e.type==="circle"?(_(),P("div",{key:3,class:"w-full h-full rounded-full",style:R({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none"})},null,4)):e.type==="triangle"?(_(),P("div",{key:4,class:"w-full h-full",style:R({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 0% 100%, 100% 100%)"})},null,4)):e.type==="star"?(_(),P("div",{key:5,class:"w-full h-full",style:R({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)"})},null,4)):ee("",!0)],4))),128))],36)])])])])])])])],32)],64))}});export{Dr as default};
