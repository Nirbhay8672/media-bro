import{d as ye,p as H,c as Q,a as w,o as k,b as z,f as l,e as N,h as me,g as J,k as Z,F as ee,r as de,t as q,n as F,D as be,E as ve}from"./app-sbgBuXAV.js";import{S as V}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{T as xe,U as ge}from"./upload-CiWq-S-t.js";import{I as we}from"./image-wBm9FnkW.js";import{c as ke}from"./createLucideIcon-CfGVCdjo.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=ke("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var pe={exports:{}},he;function _e(){return he||(he=1,(function(te){(function(v){var g=n(),R=r(),re=e(),Y=m(),j={imagePlaceholder:void 0,cacheBust:!1},U={toSvg:O,toPng:M,toJpeg:oe,toBlob:ae,toPixelData:G,impl:{fontFaces:re,images:Y,util:g,inliner:R,options:{}}};te.exports=U;function O(t,o){return o=o||{},ne(o),Promise.resolve(t).then(function(i){return K(i,o.filter,!0)}).then(ie).then(se).then(s).then(function(i){return le(i,o.width||g.width(t),o.height||g.height(t))});function s(i){return o.bgcolor&&(i.style.backgroundColor=o.bgcolor),o.width&&(i.style.width=o.width+"px"),o.height&&(i.style.height=o.height+"px"),o.style&&Object.keys(o.style).forEach(function(p){i.style[p]=o.style[p]}),i}}function G(t,o){return W(t,o||{}).then(function(s){return s.getContext("2d").getImageData(0,0,g.width(t),g.height(t)).data})}function M(t,o){return W(t,o||{}).then(function(s){return s.toDataURL()})}function oe(t,o){return o=o||{},W(t,o).then(function(s){return s.toDataURL("image/jpeg",o.quality||1)})}function ae(t,o){return W(t,o||{}).then(g.canvasToBlob)}function ne(t){typeof t.imagePlaceholder>"u"?U.impl.options.imagePlaceholder=j.imagePlaceholder:U.impl.options.imagePlaceholder=t.imagePlaceholder,typeof t.cacheBust>"u"?U.impl.options.cacheBust=j.cacheBust:U.impl.options.cacheBust=t.cacheBust}function W(t,o){return O(t,o).then(g.makeImage).then(g.delay(100)).then(function(i){var p=s(t);return p.getContext("2d").drawImage(i,0,0),p});function s(i){var p=document.createElement("canvas");if(p.width=o.width||g.width(i),p.height=o.height||g.height(i),o.bgcolor){var d=p.getContext("2d");d.fillStyle=o.bgcolor,d.fillRect(0,0,p.width,p.height)}return p}}function K(t,o,s){if(!s&&o&&!o(t))return Promise.resolve();return Promise.resolve(t).then(i).then(function(c){return p(t,c,o)}).then(function(c){return d(t,c)});function i(c){return c instanceof HTMLCanvasElement?g.makeImage(c.toDataURL()):c.cloneNode(!1)}function p(c,u,x){var P=c.childNodes;if(P.length===0)return Promise.resolve(u);return b(u,g.asArray(P),x).then(function(){return u});function b(A,_,C){var E=Promise.resolve();return _.forEach(function(L){E=E.then(function(){return K(L,C)}).then(function(T){T&&A.appendChild(T)})}),E}}function d(c,u){if(!(u instanceof Element))return u;return Promise.resolve().then(x).then(P).then(b).then(A).then(function(){return u});function x(){_(window.getComputedStyle(c),u.style);function _(C,E){C.cssText?E.cssText=C.cssText:L(C,E);function L(T,I){g.asArray(T).forEach(function(a){I.setProperty(a,T.getPropertyValue(a),T.getPropertyPriority(a))})}}}function P(){[":before",":after"].forEach(function(C){_(C)});function _(C){var E=window.getComputedStyle(c,C),L=E.getPropertyValue("content");if(L===""||L==="none")return;var T=g.uid();u.className=u.className+" "+T;var I=document.createElement("style");I.appendChild(a(T,C,E)),u.appendChild(I);function a(f,y,h){var S="."+f+":"+y,$=h.cssText?ce(h):ue(h);return document.createTextNode(S+"{"+$+"}");function ce(B){var D=B.getPropertyValue("content");return B.cssText+" content: "+D+";"}function ue(B){return g.asArray(B).map(D).join("; ")+";";function D(X){return X+": "+B.getPropertyValue(X)+(B.getPropertyPriority(X)?" !important":"")}}}}}function b(){c instanceof HTMLTextAreaElement&&(u.innerHTML=c.value),c instanceof HTMLInputElement&&u.setAttribute("value",c.value)}function A(){u instanceof SVGElement&&(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),u instanceof SVGRectElement&&["width","height"].forEach(function(_){var C=u.getAttribute(_);C&&u.style.setProperty(_,C)}))}}}function ie(t){return re.resolveAll().then(function(o){var s=document.createElement("style");return t.appendChild(s),s.appendChild(document.createTextNode(o)),t})}function se(t){return Y.inlineAll(t).then(function(){return t})}function le(t,o,s){return Promise.resolve(t).then(function(i){return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(i)}).then(g.escapeXhtml).then(function(i){return'<foreignObject x="0" y="0" width="100%" height="100%">'+i+"</foreignObject>"}).then(function(i){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+o+'" height="'+s+'">'+i+"</svg>"}).then(function(i){return"data:image/svg+xml;charset=utf-8,"+i})}function n(){return{escape:A,parseExtension:o,mimeType:s,dataAsUrl:b,isDataUrl:i,canvasToBlob:d,resolveUrl:c,getAndEncode:P,uid:u(),delay:_,asArray:C,escapeXhtml:E,makeImage:x,width:L,height:T};function t(){var a="application/font-woff",f="image/jpeg";return{woff:a,woff2:a,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:f,jpeg:f,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function o(a){var f=/\.([^\.\/]*?)$/g.exec(a);return f?f[1]:""}function s(a){var f=o(a).toLowerCase();return t()[f]||""}function i(a){return a.search(/^(data:)/)!==-1}function p(a){return new Promise(function(f){for(var y=window.atob(a.toDataURL().split(",")[1]),h=y.length,S=new Uint8Array(h),$=0;$<h;$++)S[$]=y.charCodeAt($);f(new Blob([S],{type:"image/png"}))})}function d(a){return a.toBlob?new Promise(function(f){a.toBlob(f)}):p(a)}function c(a,f){var y=document.implementation.createHTMLDocument(),h=y.createElement("base");y.head.appendChild(h);var S=y.createElement("a");return y.body.appendChild(S),h.href=f,S.href=a,S.href}function u(){var a=0;return function(){return"u"+f()+a++;function f(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function x(a){return new Promise(function(f,y){var h=new Image;h.onload=function(){f(h)},h.onerror=y,h.src=a})}function P(a){var f=3e4;return U.impl.options.cacheBust&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime()),new Promise(function(y){var h=new XMLHttpRequest;h.onreadystatechange=ce,h.ontimeout=ue,h.responseType="blob",h.timeout=f,h.open("GET",a,!0),h.send();var S;if(U.impl.options.imagePlaceholder){var $=U.impl.options.imagePlaceholder.split(/,/);$&&$[1]&&(S=$[1])}function ce(){if(h.readyState===4){if(h.status!==200){S?y(S):B("cannot fetch resource: "+a+", status: "+h.status);return}var D=new FileReader;D.onloadend=function(){var X=D.result.split(/,/)[1];y(X)},D.readAsDataURL(h.response)}}function ue(){S?y(S):B("timeout of "+f+"ms occured while fetching resource: "+a)}function B(D){console.error(D),y("")}})}function b(a,f){return"data:"+f+";base64,"+a}function A(a){return a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function _(a){return function(f){return new Promise(function(y){setTimeout(function(){y(f)},a)})}}function C(a){for(var f=[],y=a.length,h=0;h<y;h++)f.push(a[h]);return f}function E(a){return a.replace(/#/g,"%23").replace(/\n/g,"%0A")}function L(a){var f=I(a,"border-left-width"),y=I(a,"border-right-width");return a.scrollWidth+f+y}function T(a){var f=I(a,"border-top-width"),y=I(a,"border-bottom-width");return a.scrollHeight+f+y}function I(a,f){var y=window.getComputedStyle(a).getPropertyValue(f);return parseFloat(y.replace("px",""))}}function r(){var t=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:p,shouldProcess:o,impl:{readUrls:s,inline:i}};function o(d){return d.search(t)!==-1}function s(d){for(var c=[],u;(u=t.exec(d))!==null;)c.push(u[1]);return c.filter(function(x){return!g.isDataUrl(x)})}function i(d,c,u,x){return Promise.resolve(c).then(function(b){return u?g.resolveUrl(b,u):b}).then(x||g.getAndEncode).then(function(b){return g.dataAsUrl(b,g.mimeType(c))}).then(function(b){return d.replace(P(c),"$1"+b+"$3")});function P(b){return new RegExp(`(url\\(['"]?)(`+g.escape(b)+`)(['"]?\\))`,"g")}}function p(d,c,u){if(x())return Promise.resolve(d);return Promise.resolve(d).then(s).then(function(P){var b=Promise.resolve(d);return P.forEach(function(A){b=b.then(function(_){return i(_,A,c,u)})}),b});function x(){return!o(d)}}}function e(){return{resolveAll:t,impl:{readAll:o}};function t(){return o().then(function(s){return Promise.all(s.map(function(i){return i.resolve()}))}).then(function(s){return s.join(`
`)})}function o(){return Promise.resolve(g.asArray(document.styleSheets)).then(i).then(s).then(function(d){return d.map(p)});function s(d){return d.filter(function(c){return c.type===CSSRule.FONT_FACE_RULE}).filter(function(c){return R.shouldProcess(c.style.getPropertyValue("src"))})}function i(d){var c=[];return d.forEach(function(u){try{g.asArray(u.cssRules||[]).forEach(c.push.bind(c))}catch(x){console.log("Error while reading CSS rules from "+u.href,x.toString())}}),c}function p(d){return{resolve:function(){var u=(d.parentStyleSheet||{}).href;return R.inlineAll(d.cssText,u)},src:function(){return d.style.getPropertyValue("src")}}}}}function m(){return{inlineAll:o,impl:{newImage:t}};function t(s){return{inline:i};function i(p){return g.isDataUrl(s.src)?Promise.resolve():Promise.resolve(s.src).then(p||g.getAndEncode).then(function(d){return g.dataAsUrl(d,g.mimeType(s.src))}).then(function(d){return new Promise(function(c,u){s.onload=c,s.onerror=u,s.src=d})})}}function o(s){if(!(s instanceof Element))return Promise.resolve(s);return i(s).then(function(){return s instanceof HTMLImageElement?t(s).inline():Promise.all(g.asArray(s.childNodes).map(function(p){return o(p)}))});function i(p){var d=p.style.getPropertyValue("background");return d?R.inlineAll(d).then(function(c){p.style.setProperty("background",c,p.style.getPropertyPriority("background"))}).then(function(){return p}):Promise.resolve(p)}}}})()})(pe)),pe.exports}var fe=_e();const Ce={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},Se={class:"mx-auto px-4 py-6 sm:px-6 lg:px-8"},Ue={class:"grid gap-6 lg:grid-cols-4"},Ee={class:"lg:col-span-1"},Te={class:"space-y-4"},Ae={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},$e={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Re={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Ie={class:"p-4 space-y-4"},Be={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},De=["onUpdate:modelValue","placeholder"],Fe={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Le={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Me={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},je={class:"p-4 space-y-4"},Oe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},We={class:"space-y-2"},He=["id","onChange"],ze=["for"],Ne={class:"flex flex-col items-center justify-center pt-5 pb-6"},qe={key:0,class:"mt-2"},Ve=["src","alt"],Ge=["onClick"],Xe={key:2,class:"bg-yellow-50 dark:bg-yellow-900/20 rounded-xl border border-yellow-200 dark:border-yellow-800"},Je={class:"lg:col-span-3"},Ye={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Ke={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},Qe={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ze=["disabled"],et={class:"p-4"},tt={class:"flex justify-center items-start min-h-[400px]"},rt={class:"relative",style:{margin:"20px 0"}},ot=["onMousedown"],at=["src","alt"],nt={key:1,class:"flex flex-col items-center justify-center text-gray-500 text-sm text-center p-2"},dt=ye({__name:"Share",props:{template:{}},setup(te){const v=te;H(null);const g=H(!1),R=H([]);(()=>{let n;if(Array.isArray(v.template.canvas_data))n=v.template.canvas_data;else if(typeof v.template.canvas_data=="string")try{n=JSON.parse(v.template.canvas_data)}catch{n=[]}else n=[];R.value=n.map(r=>({...r,properties:{text:r.properties?.text||"",fontSize:r.properties?.fontSize||16,fontFamily:r.properties?.fontFamily||"Arial",fontWeight:r.properties?.fontWeight||"normal",fontStyle:r.properties?.fontStyle||"normal",textDecoration:r.properties?.textDecoration||"none",textAlign:r.properties?.textAlign||"left",lineHeight:r.properties?.lineHeight||1.2,color:r.properties?.color||"#000000",backgroundColor:r.properties?.backgroundColor||(r.type==="text"?"transparent":"#f3f4f6"),hasBorder:r.properties?.hasBorder||!1,borderWidth:r.properties?.borderWidth||1,borderColor:r.properties?.borderColor||"#000000",borderStyle:r.properties?.borderStyle||"solid",borderRadius:r.properties?.borderRadius||0,boxShadow:r.properties?.boxShadow||"none",textShadow:r.properties?.textShadow||"none",imageUrl:r.properties?.imageUrl||"",imageFit:r.properties?.imageFit||"cover",imagePlaceholder:r.properties?.imagePlaceholder||(r.type==="image"?"Click to upload image":"")}}))})();const Y=Q(()=>[...R.value].sort((n,r)=>n.zIndex-r.zIndex)),j=Q(()=>R.value.filter(n=>n.type==="text")),U=Q(()=>R.value.filter(n=>n.type==="image")),O=H(!1),G=H({x:0,y:0}),M=H(null),oe=(n,r)=>{r.type==="text"&&(n.preventDefault(),O.value=!0,G.value={x:n.clientX-r.x,y:n.clientY-r.y},M.value=r)},ae=n=>{O.value&&M.value&&(M.value.x=n.clientX-G.value.x,M.value.y=n.clientY-G.value.y)},ne=n=>{O.value=!1,M.value=null},W=n=>{switch(n){case"circle":return"circle(50% at 50% 50%)";case"triangle":return"polygon(50% 0%, 0% 100%, 100% 100%)";case"star":return"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)";case"diamond":return"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)";case"hexagon":return"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)";case"octagon":return"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)";case"rectangle":default:return"none"}},K=Q(()=>{const e=800/v.template.width,m=600/v.template.height,t=Math.min(e,m,1);return{width:v.template.width+"px",height:v.template.height+"px",transform:`scale(${t})`,transformOrigin:"top center",backgroundImage:v.template.background_image_url?`url(${v.template.background_image_url})`:v.template.background_image?`url(/storage/${v.template.background_image})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),ie=(n,r)=>{const e=n.target.files?.[0];if(!e)return;if(!e.type.startsWith("image/")){alert("Please select a valid image file.");return}if(e.size>10*1024*1024){alert("File size must be less than 10MB.");return}const m=URL.createObjectURL(e);r.properties.imageUrl=m,r.uploadedFile=e},se=n=>{n.properties.imageUrl&&n.properties.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(n.properties.imageUrl),n.properties.imageUrl="",n.uploadedFile=null},le=async()=>{g.value=!0,V.fire({title:"Generating Image...",text:"Please wait while we create your image.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{V.showLoading()}});try{const n=document.querySelector(".template-preview-container");if(!n)throw new Error("Preview container not found");console.log("Preview element found:",n),console.log("Element dimensions:",{width:n.offsetWidth,height:n.offsetHeight}),await(async()=>{const i=n.querySelectorAll("img");console.log(`Found ${i.length} images to process`);const p=Array.from(i).map(async(u,x)=>{if(u.src.startsWith("blob:")){console.log(`Converting blob URL ${x+1}:`,u.src);try{const P=await fetch(u.src);if(!P.ok)throw new Error(`HTTP ${P.status}: ${P.statusText}`);const b=await P.blob();return new Promise(A=>{const _=new FileReader;_.onload=()=>{u.src=_.result,console.log(`Successfully converted blob URL ${x+1} to data URL`),A(!0)},_.onerror=C=>{console.error(`Failed to read blob ${x+1}:`,C),A(!1)},_.readAsDataURL(b)})}catch(P){return console.warn(`Failed to convert blob URL ${x+1}:`,P),!1}}else return console.log(`Image ${x+1} is not a blob URL:`,u.src),!0}),c=(await Promise.all(p)).filter(u=>u).length;console.log(`Successfully converted ${c}/${i.length} images`)})();let e;const m=v.template.width,t=v.template.height;try{const p=m*4,d=t*4;e=await fe.toPng(n,{quality:1,bgcolor:"#ffffff",width:p,height:d,style:{transform:"scale(4)",transformOrigin:"top left",width:m+"px",height:t+"px",imageRendering:"high-quality",imageRendering:"-webkit-optimize-contrast",imageRendering:"crisp-edges"},pixelRatio:4,cacheBust:!0,filter:c=>!0,useCORS:!0,allowTaint:!0}),console.log("Ultra high quality image generated:",{originalSize:`${m}x${t}`,renderedSize:`${p}x${d}`,scaleFactor:4,dataUrlLength:e.length})}catch(i){console.warn("Ultra quality method failed, trying high quality fallback:",i);try{e=await fe.toPng(n,{quality:1,bgcolor:"#ffffff",width:m*2,height:t*2,style:{transform:"scale(2)",transformOrigin:"top left",width:m+"px",height:t+"px"},pixelRatio:3,cacheBust:!0,useCORS:!0})}catch(p){console.warn("High quality method failed, trying standard quality:",p),e=await fe.toPng(n,{quality:1,bgcolor:"#ffffff",width:m,height:t,pixelRatio:2,cacheBust:!0})}}console.log("Image generated successfully, data URL length:",e.length);const o=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),s=document.createElement("a");s.href=e,s.download=`${v.template.name}_${o}.png`,document.body.appendChild(s),s.click(),document.body.removeChild(s);try{console.log("Tracking download for template:",v.template.share_token);const i=await fetch(`/template/${v.template.share_token}/track-download`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json"},body:JSON.stringify({file_name:`${v.template.name}_${o}.png`,file_size:e.length})});i.ok?console.log("Download tracked successfully"):console.error("Failed to track download:",i.status,i.statusText)}catch(i){console.error("Failed to track download:",i)}V.close(),V.fire({icon:"success",title:"Download Complete!",text:"Your image has been downloaded successfully.",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(n){console.error("Error generating image:",n),V.close();let r="Unknown error occurred while generating image.";n.message?r=n.message:n.name==="SecurityError"?r="Security error: Cannot access the preview element. Please try refreshing the page.":n.name==="InvalidStateError"?r="Invalid state error: The preview element may not be ready. Please try again.":n.toString().includes("canvas")&&(r="Canvas rendering error: Please check if all images are loaded and try again."),V.fire({icon:"error",title:"Download Failed",text:r,confirmButtonText:"Try Again"})}finally{g.value=!1}};return(n,r)=>(k(),w(ee,null,[z(N(me),{title:n.template.name},null,8,["title"]),l("div",Ce,[l("div",Se,[l("div",Ue,[l("div",Ee,[l("div",Te,[j.value.length>0?(k(),w("div",Ae,[l("div",$e,[l("h2",Re,[z(N(xe),{class:"h-5 w-5"}),r[0]||(r[0]=Z(" Text Content ",-1))])]),l("div",Ie,[(k(!0),w(ee,null,de(j.value,(e,m)=>(k(),w("div",{key:e.id,class:"space-y-2"},[l("label",Be," Text "+q(m+1),1),be(l("textarea",{"onUpdate:modelValue":t=>e.properties.text=t,rows:"2",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm",placeholder:`Enter text ${m+1}`},null,8,De),[[ve,e.properties.text]])]))),128))])])):J("",!0),U.value.length>0?(k(),w("div",Fe,[l("div",Le,[l("h2",Me,[z(N(we),{class:"h-5 w-5"}),r[1]||(r[1]=Z(" Image Upload ",-1))])]),l("div",je,[(k(!0),w(ee,null,de(U.value,(e,m)=>(k(),w("div",{key:e.id,class:"space-y-2"},[l("label",Oe," Image "+q(m+1),1),l("div",We,[l("input",{id:`image-${e.id}`,type:"file",accept:"image/*",onChange:t=>ie(t,e),class:"hidden"},null,40,He),l("label",{for:`image-${e.id}`,class:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"},[l("div",Ne,[z(N(ge),{class:"w-8 h-8 mb-4 text-gray-500 dark:text-gray-400"}),r[2]||(r[2]=l("p",{class:"mb-2 text-sm text-gray-500 dark:text-gray-400"},[l("span",{class:"font-semibold"},"Click to upload"),Z(" or drag and drop ")],-1)),r[3]||(r[3]=l("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"PNG, JPG, GIF up to 10MB",-1))])],8,ze),e.properties.imageUrl?(k(),w("div",qe,[l("img",{src:e.properties.imageUrl,alt:`Image ${m+1}`,class:"w-full h-24 object-cover rounded-lg border border-gray-300 dark:border-gray-600"},null,8,Ve),l("button",{type:"button",onClick:t=>se(e),class:"mt-1 text-xs text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300"}," Remove image ",8,Ge)])):J("",!0)])]))),128))])])):J("",!0),j.value.length===0&&U.value.length===0?(k(),w("div",Xe,[...r[4]||(r[4]=[l("div",{class:"p-4"},[l("h3",{class:"text-sm font-medium text-yellow-900 dark:text-yellow-100 mb-2"}," No content fields found "),l("p",{class:"text-xs text-yellow-800 dark:text-yellow-200"}," This template doesn't have any text or image placeholders yet. The template creator needs to add content fields first. ")],-1)])])):J("",!0),r[5]||(r[5]=l("div",{class:"bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800"},[l("div",{class:"p-4"},[l("h3",{class:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2"}," How to use this template: "),l("ul",{class:"text-xs text-blue-800 dark:text-blue-200 space-y-1"},[l("li",null,"• Fill in the text fields with your content"),l("li",null,"• Upload images by clicking the upload areas"),l("li",null,'• Click "Download Image" to generate your final image'),l("li",null,"• All positioning and styling is already set by the template creator")])])],-1))])]),l("div",Je,[l("div",Ye,[l("div",Ke,[l("h2",Qe,q(n.template.name),1),l("button",{onClick:le,disabled:g.value,class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"},[z(N(Pe),{class:"h-4 w-4"}),Z(" "+q(g.value?"Generating...":"Download Image"),1)],8,Ze)]),l("div",et,[l("div",tt,[l("div",rt,[l("div",{class:"template-preview-container relative overflow-hidden bg-gray-50 dark:bg-gray-700 shadow-lg",style:F(K.value),onMousemove:ae,onMouseup:ne},[(k(!0),w(ee,null,de(Y.value,e=>(k(),w("div",{key:e.id,class:"absolute",style:F({left:e.x+"px",top:e.y+"px",width:e.width+"px",height:e.height+"px",zIndex:e.zIndex,transform:`rotate(${e.rotation}deg)`,filter:e.properties.boxShadow!=="none"?`drop-shadow(${e.properties.boxShadow})`:"none"})},[e.type==="text"?(k(),w("div",{key:0,class:"w-full h-full flex items-center justify-center cursor-move select-none",style:F({color:e.properties.color,backgroundColor:e.properties.backgroundColor,fontSize:e.properties.fontSize+"px",fontFamily:e.properties.fontFamily,fontWeight:e.properties.fontWeight,fontStyle:e.properties.fontStyle,textDecoration:e.properties.textDecoration,textAlign:e.properties.textAlign,lineHeight:e.properties.lineHeight,border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.borderRadius+"px"}),onMousedown:m=>oe(m,e)},q(e.properties.text||"Your text here"),45,ot)):e.type==="image"?(k(),w("div",{key:1,class:"w-full h-full flex items-center justify-center",style:F({backgroundColor:e.properties.backgroundColor||"transparent",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.borderRadius+"px",clipPath:W(e.properties.imageShape||"rectangle")})},[e.properties.imageUrl?(k(),w("img",{key:0,src:e.properties.imageUrl,alt:e.properties.imagePlaceholder,class:"max-w-full max-h-full",style:F({objectFit:e.properties.imageFit||"contain"})},null,12,at)):(k(),w("div",nt,[z(N(ge),{class:"h-8 w-8 mb-2"}),l("span",null,q(e.properties.imagePlaceholder),1)]))],4)):e.type==="rectangle"?(k(),w("div",{key:2,class:"w-full h-full",style:F({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:(e.properties.borderRadius||0)+"px"})},null,4)):e.type==="circle"?(k(),w("div",{key:3,class:"w-full h-full rounded-full",style:F({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none"})},null,4)):e.type==="triangle"?(k(),w("div",{key:4,class:"w-full h-full",style:F({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 0% 100%, 100% 100%)"})},null,4)):e.type==="star"?(k(),w("div",{key:5,class:"w-full h-full",style:F({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)"})},null,4)):J("",!0)],4))),128))],36)])])])])])])])])],64))}});export{dt as default};
