import{d as Pe,j as b,k as ne,c as Q,m as Je,a as v,o as p,f as t,b as a,i as ce,g as k,e as n,w as i,p as d,q as N,v as E,F as q,r as K,n as J,t as L,s as ae,x as M,y as _e,h as Ke}from"./app-CFHJRbLM.js";import{_ as et}from"./AppLayout.vue_vue_type_script_setup_true_lang-56VDDQhJ.js";import{_ as B}from"./index-Bsd-BqPx.js";import{_ as T}from"./Input.vue_vue_type_script_setup_true_lang-Cw9B8FAg.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-B93GaFwX.js";import{_ as se,a as Fe,b as Se,c as ie,d as je}from"./CardTitle.vue_vue_type_script_setup_true_lang-CAcdwJiC.js";import{_ as pe,a as me,b as ve,c as ge,d as ke}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B54kIAgW.js";import{_ as Le,a as tt}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-Cg3ZeTOv.js";import{P as Re}from"./plus-sqOCSKH7.js";import{X as Be}from"./x-Bqk-q2tI.js";import{U as $e}from"./upload-DlKOoNyo.js";import{c as Ie}from"./createLucideIcon-Dqrq2HQP.js";import{E as Me}from"./eye-BURTWVvY.js";import{F as Ne}from"./file-text-DTXmrH5c.js";import"./useAssets-YTVCLfd8.js";import"./useForwardExpose-DBAvX4a8.js";import"./VisuallyHidden-BE8GYt0C.js";import"./RovingFocusGroup-BWXddyA2.js";import"./index-DK8P9mNh.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./loader-circle-N4C-HSxH.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=Ie("FileSpreadsheetIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=Ie("PencilIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ot={key:0,class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},nt={class:"lg:col-span-1 space-y-4"},at={class:"flex items-center justify-between"},st={class:"space-y-4 py-4"},it={class:"grid grid-cols-2 gap-2"},ut={key:0,class:"text-xs text-muted-foreground text-center"},rt={class:"space-y-2"},dt=["onClick"],ft={class:"flex items-center justify-between"},pt={class:"text-sm font-medium"},mt=["onClick"],vt={key:0,class:"text-sm text-muted-foreground text-center py-4"},gt=["value"],ct=["value"],xt={class:"grid grid-cols-2 gap-2"},bt=["value"],yt=["value"],wt=["value"],ht={class:"lg:col-span-3 flex flex-col min-h-0"},kt={class:"flex justify-center items-center h-full overflow-auto p-4 rounded-lg"},Ct={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{"z-index":"1"}},Ft={key:2,class:"absolute inset-0 flex items-center justify-center bg-red-50",style:{"z-index":"1"}},St={class:"text-sm text-red-500"},$t=["onMousedown","onClick"],Pt={key:1,class:"h-full"},Ut={class:"flex justify-center items-center h-full overflow-auto p-4 rounded-lg"},Dt={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{"z-index":"1"}},zt={key:2,class:"absolute inset-0 flex items-center justify-center bg-red-50",style:{"z-index":"1"}},At={class:"text-sm text-red-500"},Vt=["onMousedown","onClick"],Ce=3.779527559,_t=Pe({__name:"PdfTemplateBuilder",props:{template:{},showOnlyCanvas:{type:Boolean},selectedFieldId:{},pdfBackgroundUrl:{},currentPageNumber:{}},emits:["update","fieldSelected","pdfImageConverted","pdfPagesDetected"],setup(ue,{emit:w}){const c=ue,z=w,S=b(null),f=b(null),P=b(null),V=b(!1),A=b(null),U=b(null),m=b(null);b(new Map),b(new Map),ne(()=>c.selectedFieldId,r=>{if(r){const o=R.value.find(l=>l.id===r);o&&(f.value=o)}else f.value=null},{immediate:!0});const F=b(!1),h=b({x:0,y:0}),D=b(!1),_=b(null),I=b(!1),u=b({label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"});ne(I,r=>{r&&(u.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})});const $=Q(()=>{if(!S.value)return 1;const r=S.value.parentElement;if(!r)return 1;const o=r.clientWidth-32,l=r.clientHeight-32,e=c.template.width*Ce,s=c.template.height*Ce,g=l/s,C=o/e;return Math.min(g,C)*.98}),H=Q(()=>c.template.width*Ce*$.value),ee=Q(()=>c.template.height*Ce*$.value),R=Q(()=>c.template.fields),te=()=>{z("update",{...c.template,fields:[...R.value]})},X=Q(()=>u.value.label?.trim()&&u.value.column?.trim()),Ue=()=>{if(!X.value)return;const r={id:Date.now().toString(),x:10,y:10,width:100,height:30,column:u.value.column?.trim()||"",label:u.value.label?.trim()||"",fontSize:u.value.fontSize||16,textAlign:u.value.textAlign||"left",fontFamily:u.value.fontFamily||"Arial",fontColor:u.value.fontColor||"#000000",fontWeight:u.value.fontWeight||"normal",fontStyle:u.value.fontStyle||"normal",textDecoration:u.value.textDecoration||"none"};R.value.push(r),te(),I.value=!1,u.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},f.value=r},De=r=>{const o=R.value.findIndex(l=>l.id===r);o>-1&&(R.value.splice(o,1),te(),f.value?.id===r&&(f.value=null,z("fieldSelected",null)))},re=r=>{f.value=r,z("fieldSelected",r)},xe=r=>{const o=3.779527559,l=r.x*o*$.value,e=r.y*o*$.value,s=r.width*o*$.value,g=r.height&&r.height>0?`${r.height*o*$.value}px`:"auto";return{left:`${l}px`,top:`${e}px`,width:`${s}px`,height:g,fontFamily:r.fontFamily||"Arial",color:r.fontColor||"#000000",fontWeight:r.fontWeight||"normal",fontStyle:r.fontStyle||"normal",textDecoration:r.textDecoration||"none",fontSize:`${(r.fontSize||16)*$.value}px`,textAlign:r.textAlign||"left"}},be=(r,o)=>{if(r.target.classList.contains("resize-handle")||r.target.tagName==="BUTTON"||(r.preventDefault(),r.stopPropagation(),F.value=!0,f.value=o,!S.value))return;const l=S.value.getBoundingClientRect(),e=r.clientX-l.left,s=r.clientY-l.top,g=3.779527559,C=e/$.value/g,y=s/$.value/g;h.value={x:C-o.x,y:y-o.y}},ze=r=>{if(!S.value)return;const o=S.value.getBoundingClientRect(),l=r.clientX-o.left,e=r.clientY-o.top,s=3.779527559,g=l/$.value/s,C=e/$.value/s;if(F.value&&f.value){const y=f.value,W=g-h.value.x,j=C-h.value.y,Ae=y.height>0?y.height:20;y.x=Math.max(0,Math.min(W,c.template.width-y.width)),y.y=Math.max(0,Math.min(j,c.template.height-Ae)),te()}else if(D.value&&f.value&&_.value){const y=f.value,W=_.value;if(W.includes("e")&&(y.width=Math.max(20,Math.min(g-y.x,c.template.width-y.x))),W.includes("s")&&(y.height=Math.max(20,Math.min(C-y.y,c.template.height-y.y))),W.includes("w")){const j=y.width+(y.x-g);j>=20&&g>=0&&(y.width=j,y.x=g)}if(W.includes("n")){const j=y.height+(y.y-C);j>=20&&C>=0&&(y.height=j,y.y=C)}te()}},G=(r,o)=>{if(r.stopPropagation(),D.value=!0,_.value=o,f.value){const l=f.value;h.value={x:l.x*$.value,y:l.y*$.value}}},le=async()=>{if(c.pdfBackgroundUrl&&P.value){V.value=!0,A.value=null;try{window.pdfjsLib||await new Promise((r,o)=>{const l=document.createElement("script");l.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",l.onload=()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js",r(!0)},l.onerror=()=>{o(new Error("Failed to load PDF.js"))},document.head.appendChild(l)}),await ye()}catch(r){A.value="Failed to load PDF: "+(r.message||"Unknown error"),V.value=!1}}},ye=async()=>{if(!(!c.pdfBackgroundUrl||!P.value||!window.pdfjsLib))try{let r=U.value;if(!r||!m.value){const oe=window.pdfjsLib.getDocument({url:c.pdfBackgroundUrl,withCredentials:!1});m.value=oe,r=await oe.promise,U.value=r,z("pdfPagesDetected",r.numPages)}if(!r)throw new Error("PDF document is not loaded");if(!r.numPages||r.numPages===0)throw new Error("PDF document is not fully loaded");const o=c.currentPageNumber||1,l=Math.min(Math.max(1,o),r.numPages);let e;try{e=await r.getPage(l)}catch{U.value=null,m.value=null;const de=window.pdfjsLib.getDocument({url:c.pdfBackgroundUrl,withCredentials:!1});m.value=de,r=await de.promise,U.value=r,e=await r.getPage(l)}const s=e.getViewport({scale:1}),g=P.value,C=g.getContext("2d");if(!C)throw new Error("Could not get canvas context");const y=3.779527559,W=c.template.width*y*$.value,j=c.template.height*y*$.value,Ae=W/s.width,He=j/s.height,Ge=Math.min(Ae,He),Ve=e.getViewport({scale:Ge});g.width=Ve.width,g.height=Ve.height;const Oe={canvasContext:C,viewport:Ve};await e.render(Oe).promise;const Xe=2.5,he=[];for(let oe=1;oe<=r.numPages;oe++){const de=await r.getPage(oe),fe=de.getViewport({scale:Xe}),Z=document.createElement("canvas");Z.width=fe.width,Z.height=fe.height;const Y=Z.getContext("2d",{alpha:!1,desynchronized:!1,willReadFrequently:!1});if(!Y)throw new Error("Could not get export canvas context");Y.fillStyle="#FFFFFF",Y.fillRect(0,0,Z.width,Z.height);const Ye=(Z.width-fe.width)/2,qe=(Z.height-fe.height)/2;Y.save(),Y.translate(Ye,qe),Y.imageSmoothingEnabled=!0,Y.imageSmoothingQuality="high";const Qe={canvasContext:Y,viewport:fe};await de.render(Qe).promise,Y.restore();const Ze=Z.toDataURL("image/jpeg",.85);he.push(Ze)}he.length===1?z("pdfImageConverted",he[0]):z("pdfImageConverted",he),V.value=!1}catch(r){A.value="Failed to render PDF: "+(r.message||"Unknown error"),V.value=!1}};ne(()=>c.currentPageNumber,async()=>{P.value&&c.pdfBackgroundUrl&&(U.value?await ye():await le())}),ne(()=>c.pdfBackgroundUrl,r=>{U.value=null,m.value=null,r&&setTimeout(()=>{P.value&&le()},200)},{immediate:!0}),ne($,()=>{c.pdfBackgroundUrl&&P.value&&le()}),Je(()=>{document.addEventListener("mousemove",ze),document.addEventListener("mouseup",we),document.addEventListener("mouseleave",we),setTimeout(()=>{c.pdfBackgroundUrl&&P.value&&le()},300)});const we=()=>{(F.value||D.value)&&(F.value=!1,D.value=!1,_.value=null)},O=(r,o,l)=>{r[o]=l,te()};return(r,o)=>r.showOnlyCanvas?(p(),v("div",Pt,[a(n(se),{class:"h-full flex flex-col"},{default:i(()=>[a(n(ie),{class:"flex-1 overflow-auto p-0"},{default:i(()=>[t("div",Ut,[t("div",{class:"relative border-2 border-dashed border-gray-400 shadow-lg",ref_key:"canvasRef",ref:S,style:J({width:H.value+"px",height:ee.value+"px",minWidth:H.value+"px",minHeight:ee.value+"px",aspectRatio:(c.template.width/c.template.height).toString(),backgroundColor:"#d4d4d4"})},[c.pdfBackgroundUrl?(p(),v("canvas",{key:0,ref_key:"pdfCanvasRef",ref:P,class:"absolute inset-0 w-full h-full pointer-events-none",style:{"z-index":"1","object-fit":"contain"}},null,512)):k("",!0),V.value?(p(),v("div",Dt,[...o[57]||(o[57]=[t("span",{class:"text-sm text-gray-500"},"Loading PDF...",-1)])])):k("",!0),A.value?(p(),v("div",zt,[t("span",At,L(A.value),1)])):k("",!0),(p(!0),v(q,null,K(R.value,l=>(p(),v("div",{key:l.id,class:ae(["absolute border-2 cursor-move select-none",f.value?.id===l.id?"border-blue-600 shadow-lg bg-transparent":"border-blue-400 bg-transparent"]),style:J({...xe(l),zIndex:f.value?.id===l.id?30:20}),onMousedown:M(e=>be(e,l),["prevent"]),onClick:M(e=>re(l),["stop"])},[t("div",{class:"pointer-events-none w-full flex",style:J({textAlign:l.textAlign||"left",justifyContent:l.textAlign==="center"?"center":l.textAlign==="right"?"flex-end":"flex-start",padding:"3px",margin:0})},[t("span",{style:J({fontFamily:l.fontFamily||"Arial",color:l.fontColor||"#000000",fontWeight:l.fontWeight||"normal",fontStyle:l.fontStyle||"normal",textDecoration:l.textDecoration||"none",fontSize:`${(l.fontSize||16)*$.value}px`,display:"inline-block",width:"100%",lineHeight:1,padding:0,margin:0})},L(l.label||l.column),5)],4),f.value?.id===l.id?(p(),v("div",{key:0,class:"resize-handle absolute bottom-0 right-0 h-2 w-2 cursor-se-resize bg-blue-500",onMousedown:o[21]||(o[21]=M(e=>G(e,"se"),["stop"]))},null,32)):k("",!0),f.value?.id===l.id?(p(),v("div",{key:1,class:"resize-handle absolute top-0 right-0 h-2 w-2 cursor-ne-resize bg-blue-500",onMousedown:o[22]||(o[22]=M(e=>G(e,"ne"),["stop"]))},null,32)):k("",!0),f.value?.id===l.id?(p(),v("div",{key:2,class:"resize-handle absolute bottom-0 left-0 h-2 w-2 cursor-sw-resize bg-blue-500",onMousedown:o[23]||(o[23]=M(e=>G(e,"sw"),["stop"]))},null,32)):k("",!0),f.value?.id===l.id?(p(),v("div",{key:3,class:"resize-handle absolute top-0 left-0 h-2 w-2 cursor-nw-resize bg-blue-500",onMousedown:o[24]||(o[24]=M(e=>G(e,"nw"),["stop"]))},null,32)):k("",!0)],46,Vt))),128))],4)])]),_:1})]),_:1})])):(p(),v("div",ot,[t("div",nt,[a(n(se),null,{default:i(()=>[a(n(Fe),null,{default:i(()=>[t("div",at,[a(n(Se),null,{default:i(()=>[...o[25]||(o[25]=[d("Fields",-1)])]),_:1}),a(n(pe),{open:I.value,"onUpdate:open":o[9]||(o[9]=l=>I.value=l)},{default:i(()=>[a(n(Le),{"as-child":""},{default:i(()=>[a(n(B),{size:"sm"},{default:i(()=>[a(n(Re),{class:"mr-2 h-4 w-4"}),o[26]||(o[26]=d(" Add Field ",-1))]),_:1})]),_:1}),a(n(me),null,{default:i(()=>[a(n(ve),null,{default:i(()=>[a(n(ge),null,{default:i(()=>[...o[27]||(o[27]=[d("Add Field",-1)])]),_:1})]),_:1}),t("div",st,[t("div",null,[a(n(x),null,{default:i(()=>[...o[28]||(o[28]=[d("Label",-1)])]),_:1}),a(n(T),{modelValue:u.value.label,"onUpdate:modelValue":o[0]||(o[0]=l=>u.value.label=l),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[29]||(o[29]=[d("Column Name",-1)])]),_:1}),a(n(T),{modelValue:u.value.column,"onUpdate:modelValue":o[1]||(o[1]=l=>u.value.column=l),placeholder:"e.g., name"},null,8,["modelValue"])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[30]||(o[30]=[d("Font Size",-1)])]),_:1}),a(n(T),{modelValue:u.value.fontSize,"onUpdate:modelValue":o[2]||(o[2]=l=>u.value.fontSize=l),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[31]||(o[31]=[d("Text Align",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":o[3]||(o[3]=l=>u.value.textAlign=l),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[32]||(o[32]=[t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)])],512),[[E,u.value.textAlign]])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[33]||(o[33]=[d("Font Family",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":o[4]||(o[4]=l=>u.value.fontFamily=l),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[34]||(o[34]=[t("option",{value:"Arial"},"Arial",-1),t("option",{value:"Times New Roman"},"Times New Roman",-1),t("option",{value:"Courier New"},"Courier New",-1),t("option",{value:"Helvetica"},"Helvetica",-1),t("option",{value:"Georgia"},"Georgia",-1),t("option",{value:"Verdana"},"Verdana",-1),t("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[E,u.value.fontFamily]])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[35]||(o[35]=[d("Font Color",-1)])]),_:1}),a(n(T),{modelValue:u.value.fontColor,"onUpdate:modelValue":o[5]||(o[5]=l=>u.value.fontColor=l),type:"color",class:"h-10"},null,8,["modelValue"])]),t("div",it,[t("div",null,[a(n(x),null,{default:i(()=>[...o[36]||(o[36]=[d("Font Weight",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":o[6]||(o[6]=l=>u.value.fontWeight=l),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[37]||(o[37]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"bold"},"Bold",-1)])],512),[[E,u.value.fontWeight]])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[38]||(o[38]=[d("Font Style",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":o[7]||(o[7]=l=>u.value.fontStyle=l),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[39]||(o[39]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"italic"},"Italic",-1)])],512),[[E,u.value.fontStyle]])])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[40]||(o[40]=[d("Text Decoration",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":o[8]||(o[8]=l=>u.value.textDecoration=l),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[41]||(o[41]=[t("option",{value:"none"},"None",-1),t("option",{value:"underline"},"Underline",-1)])],512),[[E,u.value.textDecoration]])]),a(n(B),{onClick:Ue,class:"w-full",disabled:!X.value},{default:i(()=>[...o[42]||(o[42]=[d(" Add Field ",-1)])]),_:1},8,["disabled"]),X.value?k("",!0):(p(),v("p",ut," Please fill in Label and Column Name to add field "))])]),_:1})]),_:1},8,["open"])])]),_:1}),a(n(ie),null,{default:i(()=>[t("div",rt,[(p(!0),v(q,null,K(R.value,l=>(p(),v("div",{key:l.id,class:ae(["p-2 border rounded cursor-pointer",f.value?.id===l.id?"border-blue-500 bg-blue-50":"border-gray-200"]),onClick:e=>re(l)},[t("div",ft,[t("span",pt,L(l.label||l.column),1),t("button",{onClick:M(e=>De(l.id),["stop"]),class:"text-red-500 hover:text-red-700"},[a(n(Be),{class:"h-4 w-4"})],8,mt)])],10,dt))),128)),R.value.length===0?(p(),v("p",vt,' No fields yet. Click "Add Field" to create one. ')):k("",!0)])]),_:1})]),_:1}),f.value?(p(),ce(n(se),{key:0},{default:i(()=>[a(n(Fe),null,{default:i(()=>[a(n(Se),null,{default:i(()=>[...o[43]||(o[43]=[d("Field Properties",-1)])]),_:1})]),_:1}),a(n(ie),{class:"space-y-4"},{default:i(()=>[t("div",null,[a(n(x),null,{default:i(()=>[...o[44]||(o[44]=[d("Font Size",-1)])]),_:1}),a(n(T),{value:f.value.fontSize,type:"number",onInput:o[10]||(o[10]=l=>O(f.value,"fontSize",parseFloat(l.target.value)))},null,8,["value"])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[45]||(o[45]=[d("Text Align",-1)])]),_:1}),t("select",{value:f.value.textAlign,onChange:o[11]||(o[11]=l=>O(f.value,"textAlign",l.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[46]||(o[46]=[t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)])],40,gt)]),t("div",null,[a(n(x),null,{default:i(()=>[...o[47]||(o[47]=[d("Font Family",-1)])]),_:1}),t("select",{value:f.value.fontFamily||"Arial",onChange:o[12]||(o[12]=l=>O(f.value,"fontFamily",l.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[48]||(o[48]=[t("option",{value:"Arial"},"Arial",-1),t("option",{value:"Times New Roman"},"Times New Roman",-1),t("option",{value:"Courier New"},"Courier New",-1),t("option",{value:"Helvetica"},"Helvetica",-1),t("option",{value:"Georgia"},"Georgia",-1),t("option",{value:"Verdana"},"Verdana",-1),t("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],40,ct)]),t("div",null,[a(n(x),null,{default:i(()=>[...o[49]||(o[49]=[d("Font Color",-1)])]),_:1}),a(n(T),{value:f.value.fontColor||"#000000",type:"color",class:"h-10",onInput:o[13]||(o[13]=l=>O(f.value,"fontColor",l.target.value))},null,8,["value"])]),t("div",xt,[t("div",null,[a(n(x),null,{default:i(()=>[...o[50]||(o[50]=[d("Font Weight",-1)])]),_:1}),t("select",{value:f.value.fontWeight||"normal",onChange:o[14]||(o[14]=l=>O(f.value,"fontWeight",l.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[51]||(o[51]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"bold"},"Bold",-1)])],40,bt)]),t("div",null,[a(n(x),null,{default:i(()=>[...o[52]||(o[52]=[d("Font Style",-1)])]),_:1}),t("select",{value:f.value.fontStyle||"normal",onChange:o[15]||(o[15]=l=>O(f.value,"fontStyle",l.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[53]||(o[53]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"italic"},"Italic",-1)])],40,yt)])]),t("div",null,[a(n(x),null,{default:i(()=>[...o[54]||(o[54]=[d("Text Decoration",-1)])]),_:1}),t("select",{value:f.value.textDecoration||"none",onChange:o[16]||(o[16]=l=>O(f.value,"textDecoration",l.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...o[55]||(o[55]=[t("option",{value:"none"},"None",-1),t("option",{value:"underline"},"Underline",-1)])],40,wt)])]),_:1})]),_:1})):k("",!0)]),t("div",ht,[a(n(se),{class:"flex-1 flex flex-col min-h-0"},{default:i(()=>[a(n(ie),{class:"p-0 flex-1 overflow-hidden min-h-0"},{default:i(()=>[t("div",kt,[t("div",{class:"relative border-2 border-dashed border-gray-400 shadow-lg",ref_key:"canvasRef",ref:S,style:J({width:H.value+"px",height:ee.value+"px",minWidth:H.value+"px",minHeight:ee.value+"px",aspectRatio:(c.template.width/c.template.height).toString(),backgroundColor:"#d4d4d4"})},[c.pdfBackgroundUrl?(p(),v("canvas",{key:0,ref_key:"pdfCanvasRef",ref:P,class:"absolute inset-0 w-full h-full pointer-events-none",style:{"z-index":"1","object-fit":"contain","background-color":"#d4d4d4"}},null,512)):k("",!0),V.value?(p(),v("div",Ct,[...o[56]||(o[56]=[t("span",{class:"text-sm text-gray-500"},"Loading PDF...",-1)])])):k("",!0),A.value?(p(),v("div",Ft,[t("span",St,L(A.value),1)])):k("",!0),(p(!0),v(q,null,K(R.value,l=>(p(),v("div",{key:l.id,class:ae(["absolute border-2 cursor-move select-none",f.value?.id===l.id?"border-blue-600 shadow-lg bg-transparent":"border-blue-400 bg-transparent"]),style:J({...xe(l),zIndex:f.value?.id===l.id?30:20}),onMousedown:M(e=>be(e,l),["prevent"]),onClick:M(e=>re(l),["stop"])},[t("div",{class:"pointer-events-none w-full flex",style:J({textAlign:l.textAlign||"left",justifyContent:l.textAlign==="center"?"center":l.textAlign==="right"?"flex-end":"flex-start",padding:"3px",margin:0})},[t("span",{style:J({fontFamily:l.fontFamily||"Arial",color:l.fontColor||"#000000",fontWeight:l.fontWeight||"normal",fontStyle:l.fontStyle||"normal",textDecoration:l.textDecoration||"none",fontSize:`${(l.fontSize||16)*$.value}px`,display:"inline-block",width:"100%",lineHeight:1,padding:0,margin:0})},L(l.label||l.column),5)],4),f.value?.id===l.id?(p(),v("div",{key:0,class:"resize-handle absolute bottom-0 right-0 h-2 w-2 cursor-se-resize bg-blue-500",onMousedown:o[17]||(o[17]=M(e=>G(e,"se"),["stop"]))},null,32)):k("",!0),f.value?.id===l.id?(p(),v("div",{key:1,class:"resize-handle absolute top-0 right-0 h-2 w-2 cursor-ne-resize bg-blue-500",onMousedown:o[18]||(o[18]=M(e=>G(e,"ne"),["stop"]))},null,32)):k("",!0),f.value?.id===l.id?(p(),v("div",{key:2,class:"resize-handle absolute bottom-0 left-0 h-2 w-2 cursor-sw-resize bg-blue-500",onMousedown:o[19]||(o[19]=M(e=>G(e,"sw"),["stop"]))},null,32)):k("",!0),f.value?.id===l.id?(p(),v("div",{key:3,class:"resize-handle absolute top-0 left-0 h-2 w-2 cursor-nw-resize bg-blue-500",onMousedown:o[20]||(o[20]=M(e=>G(e,"nw"),["stop"]))},null,32)):k("",!0)],46,$t))),128))],4)])]),_:1})]),_:1})])]))}}),Mt={class:"space-y-4"},Nt={key:0,class:"text-center py-4"},Et={key:1,class:"mt-4"},Tt={class:"flex items-center justify-between"},Wt={class:"flex items-center gap-2"},jt={key:1,class:"space-y-4"},Lt={key:0,class:"text-center py-4"},Rt={key:1,class:"mt-4"},Bt={class:"flex items-center justify-between"},It={class:"flex items-center gap-2"},Ht=Pe({__name:"ExcelUploader",props:{excelData:{},noCard:{type:Boolean}},emits:["uploaded","viewFile"],setup(ue,{emit:w}){const c=ue,z=w,S=b(!1),f=b(null),P=b(c.excelData||[]),V=async U=>{const F=U.target.files?.[0];if(F){if(!F.name.match(/\.(xlsx|xls|csv)$/i)){alert("Please upload a valid Excel file (.xlsx, .xls, or .csv)");return}S.value=!0;try{const h=new FormData;h.append("excel_file",F);const D=await _e.post("/pdf-templates/upload-excel",h,{headers:{"Content-Type":"multipart/form-data"}});P.value=D.data.data||[],z("uploaded",{data:D.data.data||[],columns:D.data.columns||[]})}catch(h){alert("Error uploading file: "+(h.response?.data?.message||h.message))}finally{S.value=!1,f.value&&(f.value.value="")}}},A=()=>{f.value?.click()};return(U,m)=>U.noCard?(p(),v("div",jt,[t("input",{ref_key:"fileInput",ref:f,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:V},null,544),t("button",{type:"button",onClick:A,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(n($e),{class:"h-4 w-4"}),m[8]||(m[8]=t("span",null,"Upload Excel File",-1))]),S.value?(p(),v("div",Lt,[...m[9]||(m[9]=[t("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):k("",!0),P.value.length>0?(p(),v("div",Rt,[t("div",Bt,[t("div",It,[a(n(Ee),{class:"h-5 w-5 text-green-500"}),m[10]||(m[10]=t("span",{class:"text-sm font-semibold text-gray-700"}," File uploaded ",-1))]),a(n(B),{size:"sm",variant:"outline",onClick:m[1]||(m[1]=F=>z("viewFile")),class:"flex items-center gap-2"},{default:i(()=>[a(n(Me),{class:"h-4 w-4"}),m[11]||(m[11]=d(" View File ",-1))]),_:1})])])):k("",!0)])):(p(),ce(n(se),{key:0},{default:i(()=>[a(n(Fe),null,{default:i(()=>[a(n(Se),null,{default:i(()=>[...m[2]||(m[2]=[d("Upload Excel File",-1)])]),_:1}),a(n(je),null,{default:i(()=>[...m[3]||(m[3]=[d(" Upload an Excel file (.xlsx, .xls, or .csv) containing your data ",-1)])]),_:1})]),_:1}),a(n(ie),null,{default:i(()=>[t("div",Mt,[t("input",{ref_key:"fileInput",ref:f,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:V},null,544),t("button",{type:"button",onClick:A,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(n($e),{class:"h-4 w-4"}),m[4]||(m[4]=t("span",null,"Upload Excel File",-1))]),S.value?(p(),v("div",Nt,[...m[5]||(m[5]=[t("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):k("",!0),P.value.length>0?(p(),v("div",Et,[t("div",Tt,[t("div",Wt,[a(n(Ee),{class:"h-5 w-5 text-green-500"}),m[6]||(m[6]=t("span",{class:"text-sm font-semibold text-gray-700"}," File uploaded ",-1))]),a(n(B),{size:"sm",variant:"outline",onClick:m[0]||(m[0]=F=>z("viewFile")),class:"flex items-center gap-2"},{default:i(()=>[a(n(Me),{class:"h-4 w-4"}),m[7]||(m[7]=d(" View File ",-1))]),_:1})])])):k("",!0)])]),_:1})]),_:1}))}}),Gt={class:"space-y-4"},Ot={key:0,class:"text-center py-4"},Xt={key:1,class:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md"},Yt={class:"flex items-center gap-2 text-sm text-green-700"},qt={key:1,class:"space-y-4"},Qt={key:0,class:"text-center py-2"},Zt={key:1,class:"p-2 bg-green-50 border border-green-200 rounded-md"},Jt={class:"flex items-center gap-2 text-xs text-green-700"},Kt=Pe({__name:"PdfUploader",props:{pdfUrl:{},noCard:{type:Boolean}},emits:["uploaded"],setup(ue,{emit:w}){const c=ue,z=w,S=b(!1),f=b(null),P=b(c.pdfUrl||""),V=async U=>{const F=U.target.files?.[0];if(F){if(!F.name.match(/\.(pdf)$/i)){alert("Please upload a valid PDF file (.pdf)");return}S.value=!0;try{if(F.size>52428800){alert(`File size (${(F.size/1024/1024).toFixed(2)}MB) exceeds the maximum allowed size of 50MB.`),S.value=!1;return}const D=new FormData;D.append("pdf_file",F);const _=await _e.post("/pdf-templates/upload-pdf",D,{headers:{"Content-Type":"multipart/form-data"},timeout:12e4,onUploadProgress:I=>{if(I.total){const u=Math.round(I.loaded*100/I.total);console.log(`Upload progress: ${u}%`)}}});P.value=_.data.file_url||"",z("uploaded",{file_path:_.data.file_path,file_url:_.data.file_url,dimensions:_.data.dimensions})}catch(h){console.error("PDF Upload Error:",h);let D="Error uploading file. ";if(h.response){const _=h.response.data?.errors;_&&_.pdf_file?D+=_.pdf_file[0]||h.response.data?.message||"Unknown error":D+=h.response.data?.message||`Server error (${h.response.status})`}else h.request?D+="No response from server. Please check your connection.":D+=h.message||"Unknown error occurred";alert(D)}finally{S.value=!1,f.value&&(f.value.value="")}}},A=()=>{f.value?.click()};return(U,m)=>U.noCard?(p(),v("div",qt,[t("input",{ref_key:"fileInput",ref:f,type:"file",accept:".pdf",class:"hidden",onChange:V},null,544),t("button",{type:"button",onClick:A,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(n($e),{class:"h-4 w-4"}),m[5]||(m[5]=t("span",null,"Upload PDF Template",-1))]),S.value?(p(),v("div",Qt,[...m[6]||(m[6]=[t("p",{class:"text-sm text-gray-600"},"Uploading...",-1)])])):k("",!0),P.value?(p(),v("div",Zt,[t("div",Jt,[a(n(Ne),{class:"h-3 w-3"}),m[7]||(m[7]=t("span",null,"PDF uploaded",-1))])])):k("",!0)])):(p(),ce(n(se),{key:0},{default:i(()=>[a(n(Fe),null,{default:i(()=>[a(n(Se),null,{default:i(()=>[...m[0]||(m[0]=[d("Upload PDF Template",-1)])]),_:1}),a(n(je),null,{default:i(()=>[...m[1]||(m[1]=[d(" Upload a PDF file (.pdf) to use as template background ",-1)])]),_:1})]),_:1}),a(n(ie),null,{default:i(()=>[t("div",Gt,[t("input",{ref_key:"fileInput",ref:f,type:"file",accept:".pdf",class:"hidden",onChange:V},null,544),t("button",{type:"button",onClick:A,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[a(n($e),{class:"h-4 w-4"}),m[2]||(m[2]=t("span",null,"Upload PDF File",-1))]),S.value?(p(),v("div",Ot,[...m[3]||(m[3]=[t("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):k("",!0),P.value?(p(),v("div",Xt,[t("div",Yt,[a(n(Ne),{class:"h-4 w-4"}),m[4]||(m[4]=t("span",null,"PDF uploaded successfully",-1))])])):k("",!0)])]),_:1})]),_:1}))}}),el={class:"h-[calc(100vh-4rem)] flex flex-col p-4 overflow-hidden"},tl={class:"flex items-center justify-between mb-4 flex-shrink-0"},ll={class:"flex items-center gap-4"},ol={class:"flex items-center gap-2"},nl={class:"flex items-center gap-1"},al={class:"flex-1 flex gap-4 overflow-hidden min-h-0"},sl={class:"flex items-center justify-between mb-3"},il={class:"space-y-4 py-4"},ul={class:"flex items-center gap-2"},rl={class:"grid grid-cols-2 gap-4"},dl={class:"space-y-2"},fl=["onClick"],pl={class:"flex items-center justify-between"},ml={class:"flex flex-col"},vl={class:"flex items-center gap-1 ml-2"},gl=["onClick"],cl=["onClick"],xl={key:0,class:"text-sm text-muted-foreground text-center py-4"},bl={class:"border-t pt-4"},yl={class:"border-t pt-4"},wl={class:"space-y-4 py-4"},hl={class:"grid grid-cols-2 gap-2"},kl={class:"flex gap-2"},Cl={class:"flex-1 min-w-0 overflow-hidden"},Fl={class:"flex-1 overflow-auto"},Sl={key:0,class:"text-center py-8 text-gray-500"},$l={key:1,class:"space-y-4"},Pl={class:"border rounded-lg overflow-hidden"},Ul={class:"bg-white"},Dl={class:"aspect-[1/1.414] w-full",style:{"min-height":"600px"}},zl=["src"],Al={class:"flex justify-end gap-2 pt-4 border-t"},Vl={class:"flex-1 overflow-auto"},_l={key:0,class:"text-center py-8 text-gray-500"},Ml={key:1,class:"border rounded-lg overflow-hidden"},Nl={class:"overflow-x-auto"},El={class:"w-full text-sm"},Tl={class:"bg-slate-700 sticky top-0 z-10 shadow-md"},Wl={class:"bg-white"},jl={class:"p-3 bg-gray-50 border-t text-sm text-gray-600 text-center"},Te=210,We=297,io=Pe({__name:"Index",setup(ue){const w=b({name:"",width:Te,height:We,pages:[{id:"1",fields:[{id:"default-1",x:10,y:10,width:100,height:30,label:"Name",column:"name",fontSize:20,textAlign:"center",fontFamily:"Helvetica",fontColor:"#ffffff",fontWeight:"bold",fontStyle:"normal",textDecoration:"none"}]}]}),c=b([]),z=b([]),S=b({}),f=b([]),P=b(!1),V=b(!1),A=b(!1),U=b(!1),m=b(!1),F=b(null),h=b(null),D=b(""),_=b(""),I=b([]),u=b({label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"}),$=b(0),H=Q(()=>w.value.pages[$.value]||w.value.pages[0]),ee=Q(()=>w.value.pages.some(l=>l.fields.length>0)),R=Q(()=>c.value.length>0),te=l=>{$.value=l,F.value=null},X=l=>{w.value={...l}},Ue=l=>{D.value=l.file_url||"",_.value=l.file_path||"",l.dimensions&&(w.value.width=l.dimensions.width||Te,w.value.height=l.dimensions.height||We)},De=l=>{I.value=l},re=l=>{if(l>w.value.pages.length){const e=w.value.pages.length;for(let s=e;s<l;s++){const g=(s+1).toString();w.value.pages.push({id:g,fields:[]})}}else l<w.value.pages.length&&l>0&&(w.value.pages=w.value.pages.slice(0,l),$.value>=w.value.pages.length&&($.value=w.value.pages.length-1));X(w.value)},xe=l=>{c.value=l.data||[],z.value=l.columns||[];const e={};w.value.pages.forEach(s=>{s.fields.forEach(g=>{if(g.column){let C=z.value.find(y=>y.toLowerCase()===g.column.toLowerCase());C||(C=z.value.find(y=>y.toLowerCase()===g.label?.toLowerCase())),C||(C=z.value.find(y=>y.toLowerCase().includes(g.column.toLowerCase())||g.column.toLowerCase().includes(y.toLowerCase()))),C&&(e[g.column]=C)}})}),S.value=e},be=async()=>{if(!ee.value){alert("Please create a template first");return}if(!R.value){alert("Please upload an Excel file first");return}const l=[];if(w.value.pages.forEach(e=>{e.fields.forEach(s=>{if(s.column&&!S.value[s.column]){const g=z.value.find(C=>C.toLowerCase()===s.column.toLowerCase()||C.toLowerCase()===s.label.toLowerCase());g?S.value[s.column]=g:l.push(s.label||s.column)}})}),l.length>0){alert(`Please map the following fields to Excel columns:
${l.join(", ")}

You can map them by matching field column names with Excel column names.`);return}if(Object.keys(S.value).length===0){alert("No column mappings found. Please ensure your field column names match Excel column names.");return}P.value=!0;try{const e=await _e.post("/pdf-templates/generate",{template:w.value,excel_data:c.value,column_mapping:S.value,pdf_file_path:_.value||null,pdf_page_image:I.value||null});f.value=e.data.pdfs||[],f.value.length>0&&(V.value=!0)}catch(e){alert("Error generating PDFs: "+(e.response?.data?.message||e.message))}finally{P.value=!1}},ze=l=>{try{const e=atob(l.base64),s=new Array(e.length);for(let j=0;j<e.length;j++)s[j]=e.charCodeAt(j);const g=new Uint8Array(s),C=new Blob([g],{type:"application/pdf"}),y=URL.createObjectURL(C),W=document.createElement("a");W.href=y,W.download=l.filename,document.body.appendChild(W),W.click(),document.body.removeChild(W),setTimeout(()=>URL.revokeObjectURL(y),100)}catch{const s=document.createElement("a");s.href=`data:application/pdf;base64,${l.base64}`,s.download=l.filename,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},G=()=>{f.value.forEach((l,e)=>{setTimeout(()=>{ze(l)},e*50)})},le=Q(()=>u.value.label?.trim()&&u.value.column?.trim()),ye=()=>{if(!le.value)return;const l={id:Date.now().toString(),x:10,y:10,width:100,height:0,column:u.value.column.trim(),label:u.value.label.trim(),fontSize:u.value.fontSize||16,textAlign:u.value.textAlign||"left",fontFamily:u.value.fontFamily||"Arial",fontColor:u.value.fontColor||"#000000",fontWeight:u.value.fontWeight||"normal",fontStyle:u.value.fontStyle||"normal",textDecoration:u.value.textDecoration||"none"};H.value.fields.push(l),X(w.value),A.value=!1,u.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},F.value=l},we=l=>{const e=w.value.pages.find(s=>s.fields.some(g=>g.id===l));if(e){const s=e.fields.findIndex(g=>g.id===l);s>-1&&(e.fields.splice(s,1),X(w.value),F.value?.id===l&&(F.value=null))}},O=l=>{F.value=l},r=l=>{h.value=l,u.value={label:l.label,column:l.column,fontSize:l.fontSize,textAlign:l.textAlign,fontFamily:l.fontFamily||"Arial",fontColor:l.fontColor||"#000000",fontWeight:l.fontWeight||"normal",fontStyle:l.fontStyle||"normal",textDecoration:l.textDecoration||"none"},U.value=!0},o=()=>{if(!h.value)return;const l=w.value.pages.find(e=>e.fields.some(s=>s.id===h.value.id));if(l){const e=l.fields.find(s=>s.id===h.value.id);e&&(e.label=u.value.label.trim(),e.column=u.value.column.trim(),e.fontSize=u.value.fontSize||16,e.textAlign=u.value.textAlign||"left",e.fontFamily=u.value.fontFamily||"Arial",e.fontColor=u.value.fontColor||"#000000",e.fontWeight=u.value.fontWeight||"normal",e.fontStyle=u.value.fontStyle||"normal",e.textDecoration=u.value.textDecoration||"none",X(w.value),U.value=!1,h.value=null)}};return ne(A,l=>{l&&(u.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})}),ne(U,l=>{!l&&h.value===null&&(u.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})}),(l,e)=>(p(),v(q,null,[a(n(Ke),{title:"PDF Template"}),a(et,null,{default:i(()=>[t("div",el,[t("div",tl,[e[28]||(e[28]=t("div",null,[t("h1",{class:"text-2xl font-semibold"},"PDF Template")],-1)),t("div",ll,[t("div",ol,[a(n(x),{class:"text-sm whitespace-nowrap"},{default:i(()=>[...e[27]||(e[27]=[d("Page:",-1)])]),_:1}),t("div",nl,[(p(!0),v(q,null,K(w.value.pages,(s,g)=>(p(),ce(n(B),{key:s.id,size:"sm",variant:"outline",class:ae($.value===g?"bg-blue-500 text-white border-blue-500":""),onClick:C=>te(g)},{default:i(()=>[d(L(g+1),1)]),_:2},1032,["class","onClick"]))),128))])]),a(n(B),{onClick:be,disabled:!ee.value||!R.value||P.value},{default:i(()=>[d(L(P.value?"Generatingâ€¦":"Generate & Preview"),1)]),_:1},8,["disabled"])])]),t("div",al,[a(n(se),{class:"w-80 flex-shrink-0 flex flex-col overflow-hidden"},{default:i(()=>[a(n(ie),{class:"flex-1 overflow-auto min-h-0 space-y-6"},{default:i(()=>[t("div",null,[t("div",sl,[a(n(x),{class:"text-base font-semibold"},{default:i(()=>[...e[29]||(e[29]=[d("Fields",-1)])]),_:1}),a(n(pe),{open:A.value,"onUpdate:open":e[10]||(e[10]=s=>A.value=s)},{default:i(()=>[a(n(Le),{"as-child":""},{default:i(()=>[a(n(B),{size:"sm"},{default:i(()=>[a(n(Re),{class:"mr-2 h-4 w-4"}),e[30]||(e[30]=d(" Add Field ",-1))]),_:1})]),_:1}),a(n(me),null,{default:i(()=>[a(n(ve),null,{default:i(()=>[a(n(ge),null,{default:i(()=>[...e[31]||(e[31]=[d("Add Field",-1)])]),_:1}),a(n(ke),null,{default:i(()=>[...e[32]||(e[32]=[d("Add a new field to the template",-1)])]),_:1})]),_:1}),t("div",il,[t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[33]||(e[33]=[d("Label",-1)])]),_:1}),a(n(T),{modelValue:u.value.label,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value.label=s),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[34]||(e[34]=[d("Column Name",-1)])]),_:1}),a(n(T),{modelValue:u.value.column,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value.column=s),placeholder:"e.g., name"},null,8,["modelValue"])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[35]||(e[35]=[d("Font Size",-1)])]),_:1}),a(n(T),{modelValue:u.value.fontSize,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value.fontSize=s),modelModifiers:{number:!0},type:"number",min:"8",max:"72"},null,8,["modelValue"])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[36]||(e[36]=[d("Text Align",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>u.value.textAlign=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...e[37]||(e[37]=[t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)])],512),[[E,u.value.textAlign]])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[38]||(e[38]=[d("Font Family",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>u.value.fontFamily=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...e[39]||(e[39]=[t("option",{value:"Arial"},"Arial",-1),t("option",{value:"Times New Roman"},"Times New Roman",-1),t("option",{value:"Courier New"},"Courier New",-1),t("option",{value:"Helvetica"},"Helvetica",-1),t("option",{value:"Georgia"},"Georgia",-1),t("option",{value:"Verdana"},"Verdana",-1),t("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[E,u.value.fontFamily]])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[40]||(e[40]=[d("Font Color",-1)])]),_:1}),t("div",ul,[a(n(T),{modelValue:u.value.fontColor,"onUpdate:modelValue":e[5]||(e[5]=s=>u.value.fontColor=s),type:"color",class:"h-9 w-20 cursor-pointer"},null,8,["modelValue"]),a(n(T),{modelValue:u.value.fontColor,"onUpdate:modelValue":e[6]||(e[6]=s=>u.value.fontColor=s),type:"text",placeholder:"#000000",class:"flex-1"},null,8,["modelValue"])])]),t("div",rl,[t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[41]||(e[41]=[d("Font Weight",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>u.value.fontWeight=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...e[42]||(e[42]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"bold"},"Bold",-1)])],512),[[E,u.value.fontWeight]])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[43]||(e[43]=[d("Font Style",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>u.value.fontStyle=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...e[44]||(e[44]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"italic"},"Italic",-1)])],512),[[E,u.value.fontStyle]])])]),t("div",null,[a(n(x),{class:"mb-2 block text-sm font-medium"},{default:i(()=>[...e[45]||(e[45]=[d("Text Decoration",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>u.value.textDecoration=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50"},[...e[46]||(e[46]=[t("option",{value:"none"},"None",-1),t("option",{value:"underline"},"Underline",-1)])],512),[[E,u.value.textDecoration]])])]),a(n(tt),null,{default:i(()=>[a(n(B),{onClick:ye,class:"w-full sm:w-auto",disabled:!le.value},{default:i(()=>[...e[47]||(e[47]=[d(" Add Field ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),t("div",dl,[(p(!0),v(q,null,K(H.value.fields,s=>(p(),v("div",{key:s.id,class:ae(["group p-2 border rounded cursor-pointer transition-colors",F.value?.id===s.id?"border-blue-500 bg-blue-100":"border-gray-200 hover:bg-gray-50"]),onClick:g=>O(s)},[t("div",pl,[t("div",ml,[t("span",{class:ae(["text-sm font-semibold transition-colors",F.value?.id===s.id?"text-blue-700":"text-gray-900 group-hover:text-blue-600"])},L(s.label||s.column),3),s.label&&s.column?(p(),v("span",{key:0,class:ae(["text-xs mt-0.5 transition-colors",F.value?.id===s.id?"text-gray-600":"text-gray-600 group-hover:text-gray-800"])}," Column: "+L(s.column),3)):k("",!0)]),t("div",vl,[t("button",{onClick:M(g=>r(s),["stop"]),class:"text-blue-500 hover:text-blue-700 p-1",title:"Edit field"},[a(n(lt),{class:"h-4 w-4"})],8,gl),t("button",{onClick:M(g=>we(s.id),["stop"]),class:"text-red-500 hover:text-red-700 p-1",title:"Delete field"},[a(n(Be),{class:"h-4 w-4"})],8,cl)])])],10,fl))),128)),H.value.fields.length===0?(p(),v("p",xl,' No fields yet. Click "Add Field" to create one. ')):k("",!0)])]),t("div",bl,[a(n(x),{class:"text-base font-semibold mb-3 block"},{default:i(()=>[...e[48]||(e[48]=[d("Upload PDF Template",-1)])]),_:1}),a(Kt,{onUploaded:Ue,"pdf-url":D.value,"no-card":!0},null,8,["pdf-url"])]),t("div",yl,[a(n(x),{class:"text-base font-semibold mb-3 block"},{default:i(()=>[...e[49]||(e[49]=[d("Upload Excel",-1)])]),_:1}),a(Ht,{onUploaded:xe,"excel-data":c.value,"no-card":!0,onViewFile:e[11]||(e[11]=s=>m.value=!0)},null,8,["excel-data"])])]),_:1})]),_:1}),a(n(pe),{open:U.value,"onUpdate:open":e[22]||(e[22]=s=>U.value=s)},{default:i(()=>[a(n(me),null,{default:i(()=>[a(n(ve),null,{default:i(()=>[a(n(ge),null,{default:i(()=>[...e[50]||(e[50]=[d("Edit Field",-1)])]),_:1}),a(n(ke),null,{default:i(()=>[...e[51]||(e[51]=[d("Edit field properties",-1)])]),_:1})]),_:1}),t("div",wl,[t("div",null,[a(n(x),null,{default:i(()=>[...e[52]||(e[52]=[d("Label",-1)])]),_:1}),a(n(T),{modelValue:u.value.label,"onUpdate:modelValue":e[12]||(e[12]=s=>u.value.label=s),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[53]||(e[53]=[d("Column Name",-1)])]),_:1}),a(n(T),{modelValue:u.value.column,"onUpdate:modelValue":e[13]||(e[13]=s=>u.value.column=s),placeholder:"e.g., name"},null,8,["modelValue"])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[54]||(e[54]=[d("Font Size",-1)])]),_:1}),a(n(T),{modelValue:u.value.fontSize,"onUpdate:modelValue":e[14]||(e[14]=s=>u.value.fontSize=s),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[55]||(e[55]=[d("Text Align",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>u.value.textAlign=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...e[56]||(e[56]=[t("option",{value:"left"},"Left",-1),t("option",{value:"center"},"Center",-1),t("option",{value:"right"},"Right",-1)])],512),[[E,u.value.textAlign]])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[57]||(e[57]=[d("Font Family",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[16]||(e[16]=s=>u.value.fontFamily=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...e[58]||(e[58]=[t("option",{value:"Arial"},"Arial",-1),t("option",{value:"Times New Roman"},"Times New Roman",-1),t("option",{value:"Courier New"},"Courier New",-1),t("option",{value:"Helvetica"},"Helvetica",-1),t("option",{value:"Georgia"},"Georgia",-1),t("option",{value:"Verdana"},"Verdana",-1),t("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[E,u.value.fontFamily]])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[59]||(e[59]=[d("Font Color",-1)])]),_:1}),a(n(T),{modelValue:u.value.fontColor,"onUpdate:modelValue":e[17]||(e[17]=s=>u.value.fontColor=s),type:"color",class:"h-10"},null,8,["modelValue"])]),t("div",hl,[t("div",null,[a(n(x),null,{default:i(()=>[...e[60]||(e[60]=[d("Font Weight",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[18]||(e[18]=s=>u.value.fontWeight=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...e[61]||(e[61]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"bold"},"Bold",-1)])],512),[[E,u.value.fontWeight]])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[62]||(e[62]=[d("Font Style",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[19]||(e[19]=s=>u.value.fontStyle=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...e[63]||(e[63]=[t("option",{value:"normal"},"Normal",-1),t("option",{value:"italic"},"Italic",-1)])],512),[[E,u.value.fontStyle]])])]),t("div",null,[a(n(x),null,{default:i(()=>[...e[64]||(e[64]=[d("Text Decoration",-1)])]),_:1}),N(t("select",{"onUpdate:modelValue":e[20]||(e[20]=s=>u.value.textDecoration=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...e[65]||(e[65]=[t("option",{value:"none"},"None",-1),t("option",{value:"underline"},"Underline",-1)])],512),[[E,u.value.textDecoration]])]),t("div",kl,[a(n(B),{onClick:o,class:"flex-1",disabled:!u.value.label?.trim()||!u.value.column?.trim()},{default:i(()=>[...e[66]||(e[66]=[d(" Update Field ",-1)])]),_:1},8,["disabled"]),a(n(B),{variant:"outline",onClick:e[21]||(e[21]=()=>{U.value=!1,h.value=null}),class:"flex-1"},{default:i(()=>[...e[67]||(e[67]=[d(" Cancel ",-1)])]),_:1})])])]),_:1})]),_:1},8,["open"]),t("div",Cl,[a(_t,{template:{name:w.value.name,width:w.value.width,height:w.value.height,fields:H.value.fields},"show-only-canvas":!0,"selected-field-id":F.value?.id||null,"pdf-background-url":D.value,"current-page-number":$.value+1,onUpdate:e[23]||(e[23]=s=>{H.value.fields=s.fields,X(w.value)}),onFieldSelected:O,onPdfImageConverted:De,onPdfPagesDetected:re},null,8,["template","selected-field-id","pdf-background-url","current-page-number"])])])]),a(n(pe),{open:V.value,"onUpdate:open":e[25]||(e[25]=s=>V.value=s)},{default:i(()=>[a(n(me),{class:"!w-[80vw] !max-w-[80vw] max-h-[90vh] overflow-hidden flex flex-col mx-auto"},{default:i(()=>[a(n(ve),null,{default:i(()=>[a(n(ge),null,{default:i(()=>[...e[68]||(e[68]=[d("PDF Preview",-1)])]),_:1}),a(n(ke),null,{default:i(()=>[...e[69]||(e[69]=[d("Preview and download generated PDFs",-1)])]),_:1})]),_:1}),t("div",Fl,[f.value.length===0?(p(),v("div",Sl," No PDFs generated yet. ")):(p(),v("div",$l,[t("div",Pl,[t("div",Ul,[t("div",Dl,[t("iframe",{src:`data:application/pdf;base64,${f.value[0].base64}`,class:"w-full h-full border-0"},null,8,zl)])])])]))]),t("div",Al,[a(n(B),{variant:"outline",onClick:e[24]||(e[24]=s=>V.value=!1)},{default:i(()=>[...e[70]||(e[70]=[d(" Close ",-1)])]),_:1}),f.value.length>0?(p(),ce(n(B),{key:0,onClick:G},{default:i(()=>[d(" Download All PDFs ("+L(f.value.length)+") ",1)]),_:1})):k("",!0)])]),_:1})]),_:1},8,["open"]),a(n(pe),{open:m.value,"onUpdate:open":e[26]||(e[26]=s=>m.value=s)},{default:i(()=>[a(n(me),{class:"!w-[80vw] !max-w-[80vw] max-h-[90vh] overflow-hidden flex flex-col mx-auto"},{default:i(()=>[a(n(ve),null,{default:i(()=>[a(n(ge),null,{default:i(()=>[...e[71]||(e[71]=[d("Excel File Data",-1)])]),_:1}),a(n(ke),null,{default:i(()=>[...e[72]||(e[72]=[d("View uploaded Excel file data",-1)])]),_:1})]),_:1}),t("div",Vl,[c.value.length===0?(p(),v("div",_l," No Excel data available. ")):(p(),v("div",Ml,[t("div",Nl,[t("table",El,[t("thead",Tl,[t("tr",null,[(p(!0),v(q,null,K(z.value,(s,g)=>(p(),v("th",{key:g,class:"px-4 py-3 text-left font-bold border-b border-slate-600 text-white uppercase tracking-wide"},L(s),1))),128))])]),t("tbody",Wl,[(p(!0),v(q,null,K(c.value,(s,g)=>(p(),v("tr",{key:g,class:"border-b border-gray-200 hover:bg-blue-50 transition-colors"},[(p(!0),v(q,null,K(z.value,(C,y)=>(p(),v("td",{key:y,class:"px-4 py-2 text-gray-800 font-medium"},L(s[C]),1))),128))]))),128))])])]),t("div",jl," Total rows: "+L(c.value.length),1)]))])]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{io as default};
