import{d as ee,a as m,o as c,f as e,g as S,b as M,k as _,t as D,F,e as W,r as Q,i as xe,p as E,q as we,s as Te,v as he,c as J,x as Ie,n as P,y as U,z as Ce,A as $e,u as Fe,h as Me,w as De,B as ye,m as ke}from"./app-BQiOSmYb.js";import{C as Be,t as ze,_ as Pe}from"./AppLayout.vue_vue_type_script_setup_true_lang-CnGFcUDb.js";import{d as Oe}from"./index-DK8P9mNh.js";import{L as We}from"./loader-circle-CvGR_sEM.js";import{U as fe,T as Re}from"./upload-CZGfYEkh.js";import{c as K}from"./createLucideIcon--ecsWlj0.js";import{C as Ee}from"./copy-C5ifyc_f.js";import{T as Se}from"./trash-2-LgNOmgvh.js";import{I as Qe}from"./x-C4kSYos3.js";import{S as A}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import"./useAssets-DaOOF8AD.js";import"./useForwardExpose-Ble9iTax.js";import"./VisuallyHidden-CQTGHgra.js";import"./RovingFocusGroup-CXykmerF.js";import"./useArrowNavigation-C6Y-ieo6.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=K("CircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=K("LayersIcon",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=K("MoveIcon",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=K("SquareIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=K("StarIcon",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=K("TriangleIcon",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]),je={class:"w-full"},He={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Le={class:"p-4"},Ne={class:"flex flex-wrap items-end gap-4"},qe={class:"flex-1 min-w-[150px]"},Ve=["value"],Ke={class:"flex-1 min-w-[200px]"},Ge={class:"relative quick-template-dropdown"},Ze={class:"flex items-center"},Je={key:0,class:"text-xs text-gray-500 dark:text-gray-400 ml-2"},et={key:0,class:"absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg"},tt=["onClick"],ot={class:"font-medium"},rt={class:"text-xs text-gray-500 dark:text-gray-400"},at={class:"flex gap-2"},lt=["value"],st=["value"],nt={key:0},it=["disabled"],dt=ee({__name:"TemplateSettings",props:{form:{},backgroundImagePreview:{},selectedQuickTemplate:{},isQuickTemplateDropdownOpen:{type:Boolean},originalImageDimensions:{},isEditMode:{type:Boolean},isSubmitting:{type:Boolean}},emits:["update:form","update:backgroundImagePreview","update:selectedQuickTemplate","update:isQuickTemplateDropdownOpen","backgroundImageChange","applyQuickTemplate"],setup(j,{emit:$}){const d=j,y=$,g=[{name:"Original Size",width:0,height:0},{name:"Instagram Post",width:1080,height:1080},{name:"Instagram Story",width:1080,height:1920},{name:"Facebook Post",width:1200,height:630},{name:"Custom Size",width:800,height:600}],I=(p,s)=>{if(p==="width"||p==="height"){const v=parseInt(s)||100,B=Math.max(100,Math.min(4e3,v));y("update:form",{...d.form,[p]:B})}else y("update:form",{...d.form,[p]:s})},h=p=>{p.name==="Original Size"&&d.originalImageDimensions.width>0?y("applyQuickTemplate",{name:"Original Size",width:d.originalImageDimensions.width,height:d.originalImageDimensions.height}):y("applyQuickTemplate",p)},w=()=>{d.originalImageDimensions.width>0&&y("applyQuickTemplate",{name:"Original Size",width:d.originalImageDimensions.width,height:d.originalImageDimensions.height})},f=()=>{y("update:isQuickTemplateDropdownOpen",!d.isQuickTemplateDropdownOpen)};return(p,s)=>(c(),m("div",je,[e("div",He,[s[8]||(s[8]=e("div",{class:"p-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Template Settings")],-1)),e("div",Le,[e("div",Ne,[e("div",qe,[s[3]||(s[3]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Template Name * ",-1)),e("input",{value:p.form.name,onInput:s[0]||(s[0]=v=>I("name",v.target.value)),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm",placeholder:"Enter template name"},null,40,Ve)]),e("div",Ke,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Quick Templates ",-1)),e("div",Ge,[e("button",{type:"button",onClick:f,class:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e("span",Ze,[_(D(p.selectedQuickTemplate?p.selectedQuickTemplate.name:"Select a template...")+" ",1),p.selectedQuickTemplate?(c(),m("span",Je,[p.selectedQuickTemplate.name==="Original Size"&&p.originalImageDimensions.width>0?(c(),m(F,{key:0},[_(" ("+D(p.originalImageDimensions.width)+" × "+D(p.originalImageDimensions.height)+"px) ",1)],64)):(c(),m(F,{key:1},[_(" ("+D(p.selectedQuickTemplate.width)+" × "+D(p.selectedQuickTemplate.height)+"px) ",1)],64))])):S("",!0)]),M(W(Be),{class:"h-4 w-4 text-gray-400"})]),p.isQuickTemplateDropdownOpen?(c(),m("div",et,[(c(),m(F,null,Q(g,v=>e("button",{key:v.name,type:"button",onClick:B=>h(v),class:"w-full px-3 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-600 text-sm first:rounded-t-lg last:rounded-b-lg"},[e("div",ot,D(v.name),1),e("div",rt,[v.name==="Original Size"&&p.originalImageDimensions.width>0?(c(),m(F,{key:0},[_(D(p.originalImageDimensions.width)+" × "+D(p.originalImageDimensions.height)+"px ",1)],64)):v.name==="Original Size"?(c(),m(F,{key:1},[_(" No background image ")],64)):(c(),m(F,{key:2},[_(D(v.width)+" × "+D(v.height)+"px ",1)],64))])],8,tt)),64))])):S("",!0)])]),e("div",at,[e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Width ",-1)),e("input",{value:p.form.width,onInput:s[1]||(s[1]=v=>I("width",v.target.value)),type:"number",min:"100",max:"4000",step:"1",class:"w-20 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm"},null,40,lt)]),e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Height ",-1)),e("input",{value:p.form.height,onInput:s[2]||(s[2]=v=>I("height",v.target.value)),type:"number",min:"100",max:"4000",step:"1",class:"w-20 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm"},null,40,st)]),p.originalImageDimensions.width>0?(c(),m("div",nt,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"   ",-1)),e("button",{type:"button",onClick:w,class:"px-3 py-2 text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",title:"Revert to original background size"}," Original ")])):S("",!0)]),e("div",null,[e("button",{type:"submit",disabled:!p.form.name||p.isSubmitting,class:"bg-blue-600 text-white py-2 px-6 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"},[p.isSubmitting?(c(),xe(W(We),{key:0,class:"h-4 w-4 animate-spin"})):S("",!0),e("span",null,D(p.isSubmitting?p.isEditMode?"Updating...":"Creating...":p.isEditMode?"Update Template":"Create Template"),1)],8,it)])])])])]))}}),ut={class:"flex-1 min-w-0 relative"},gt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col relative"},ct={class:"px-4 py-2 border-b border-gray-200 dark:border-gray-700"},mt={class:"flex items-center justify-between"},pt={class:"flex items-center gap-3"},bt={for:"background-upload",class:"cursor-pointer inline-flex items-center gap-2 px-3 py-1.5 text-xs font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},ht={key:0,class:"flex items-center gap-2"},vt=["src"],yt={class:"flex items-center gap-1"},kt=["disabled"],ft=["disabled"],xt=["disabled"],wt=["disabled"],Ct={class:"p-2 sm:p-4 flex justify-center items-start min-h-[300px] sm:min-h-[400px]"},Et={class:"relative w-full max-w-full overflow-hidden flex justify-center",style:{margin:"10px 0"}},St={key:1,class:"flex h-full w-full items-center justify-center"},Tt={class:"text-center"},It={class:"mx-auto h-16 w-16 bg-gray-100 dark:bg-gray-600 rounded-full flex items-center justify-center mb-4"},$t=["onMousedown","onClick"],Ft=["src","alt"],Mt=["onClick"],Dt=["onMousedown"],Bt=ee({__name:"CanvasEditor",props:{form:{},backgroundImagePreview:{},canvasElements:{},selectedElement:{},selectedTool:{}},emits:["canvasClick","elementMouseDown","mouseMove","mouseUp","selectElement","bringToFront","sendToBack","duplicateElement","deleteElement","resizeElement","backgroundImageChange"],setup(j,{emit:$}){const d=j,y=$,g=o=>{const a=o.target.files?.[0];a&&y("backgroundImageChange",a)},I=E(typeof window<"u"?window.innerWidth:1024),h=E({x:0,y:0,scale:1}),w=E(!1),f=E(!1),p=E({x:0,y:0}),s=E(0),v=()=>{I.value=window.innerWidth};we(()=>{window.addEventListener("resize",v)}),Te(()=>{window.removeEventListener("resize",v)}),he(()=>[d.form.width,d.form.height],()=>{R()},{deep:!0});const B=J(()=>{const o=I.value<1024?400:600,u=I.value<1024?300:450,a=o/d.form.width,T=u/d.form.height,O=Math.min(a,T,1);return{width:d.form.width*O,height:d.form.height*O,scale:O}}),i=J(()=>B.value.scale),t=J(()=>[...d.canvasElements].sort((o,u)=>o.zIndex-u.zIndex)),l=o=>{y("canvasClick",o)},L=(o,u)=>{y("elementMouseDown",o,u)},le=o=>{H.value?ge(o):y("mouseMove",o)},se=o=>{H.value?re():y("mouseUp",o)},V=o=>{y("selectElement",o)},ne=o=>{V(o)},ie=o=>{y("bringToFront",o)},de=o=>{y("sendToBack",o)},te=o=>{y("duplicateElement",o)},oe=o=>{y("deleteElement",o)},H=E(!1),z=E({x:0,y:0,width:0,height:0,elementX:0,elementY:0,originalFontSize:0}),ue=(o,u)=>{o.preventDefault(),o.stopPropagation(),H.value=!0,z.value={x:o.clientX,y:o.clientY,width:u.width,height:u.height,elementX:u.x,elementY:u.y,originalFontSize:u.properties.fontSize||16},d.selectedElement?.id!==u.id&&V(u)},ge=o=>{if(!H.value||!d.selectedElement)return;const u=o.clientX-z.value.x,a=o.clientY-z.value.y,T=B.value.scale,O=u/T,Y=a/T;let X=Math.max(20,z.value.width+O),N=Math.max(20,z.value.height+Y);if(o.shiftKey){z.value.width/z.value.height;const q=Math.max(O,Y);X=Math.max(20,z.value.width+q),N=Math.max(20,z.value.height+q)}let Z=z.value.originalFontSize;if(d.selectedElement.type==="text"){const q=N/z.value.height;Z=Math.max(8,Math.round(z.value.originalFontSize*q))}y("resizeElement",d.selectedElement.id,X,N,d.selectedElement.x,d.selectedElement.y,Z)},re=()=>{H.value=!1},ce=o=>{d.backgroundImagePreview&&!d.selectedElement&&(o.preventDefault(),w.value=!0,p.value={x:o.clientX-h.value.x,y:o.clientY-h.value.y})},me=o=>{w.value&&d.backgroundImagePreview&&!d.selectedElement&&(h.value.x=o.clientX-p.value.x,h.value.y=o.clientY-p.value.y)},pe=()=>{w.value=!1},r=o=>{if(d.backgroundImagePreview&&!d.selectedElement){o.preventDefault();const u=o.deltaY>0?.9:1.1,a=Math.max(.1,Math.min(5,h.value.scale*u)),T=o.target.getBoundingClientRect(),O=o.clientX-T.left,Y=o.clientY-T.top,X=a/h.value.scale;h.value.x=O-(O-h.value.x)*X,h.value.y=Y-(Y-h.value.y)*X,h.value.scale=a}},n=o=>{if(d.backgroundImagePreview&&!d.selectedElement){if(o.preventDefault(),o.touches.length===1)w.value=!0,p.value={x:o.touches[0].clientX-h.value.x,y:o.touches[0].clientY-h.value.y};else if(o.touches.length===2){f.value=!0;const u=o.touches[0],a=o.touches[1];s.value=Math.sqrt(Math.pow(a.clientX-u.clientX,2)+Math.pow(a.clientY-u.clientY,2))}}},b=o=>{if(d.backgroundImagePreview&&!d.selectedElement){if(o.preventDefault(),w.value&&o.touches.length===1)h.value.x=o.touches[0].clientX-p.value.x,h.value.y=o.touches[0].clientY-p.value.y;else if(f.value&&o.touches.length===2){const u=o.touches[0],a=o.touches[1],T=Math.sqrt(Math.pow(a.clientX-u.clientX,2)+Math.pow(a.clientY-u.clientY,2));if(s.value>0){const O=T/s.value,Y=Math.max(.1,Math.min(5,h.value.scale*O)),X=(u.clientX+a.clientX)/2,N=(u.clientY+a.clientY)/2,be=o.target.getBoundingClientRect(),Z=X-be.left,q=N-be.top,ve=Y/h.value.scale;h.value.x=Z-(Z-h.value.x)*ve,h.value.y=q-(q-h.value.y)*ve,h.value.scale=Y}s.value=T}}},k=()=>{w.value=!1,f.value=!1,s.value=0},C=()=>{h.value={x:0,y:0,scale:1}},R=()=>{d.backgroundImagePreview&&(h.value={x:0,y:0,scale:1})},x=()=>{if(d.backgroundImagePreview){const o=new Image;o.onload=()=>{const u=d.form.width/d.form.height,a=o.naturalWidth/o.naturalHeight;let T=1;a>u?T=d.form.width/o.naturalWidth:T=d.form.height/o.naturalHeight;const O=o.naturalWidth*T,Y=o.naturalHeight*T,X=(d.form.width-O)/2,N=(d.form.height-Y)/2;h.value={x:X,y:N,scale:T}},o.src=d.backgroundImagePreview}},G=o=>{switch(o){case"circle":return"circle(50% at 50% 50%)";case"triangle":return"polygon(50% 0%, 0% 100%, 100% 100%)";case"star":return"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)";case"diamond":return"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)";case"hexagon":return"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)";case"octagon":return"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)";case"rectangle":default:return"none"}};return(o,u)=>(c(),m("div",ut,[e("div",gt,[u[11]||(u[11]=e("div",{class:"pt-5 px-4 pb-2 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Template Editor")],-1)),e("div",ct,[e("div",mt,[e("div",pt,[e("input",{type:"file",accept:"image/*",onChange:g,class:"hidden",id:"background-upload"},null,32),e("label",bt,[M(W(fe),{class:"h-3 w-3"}),u[4]||(u[4]=_(" Background ",-1))]),o.backgroundImagePreview?(c(),m("div",ht,[e("img",{src:o.backgroundImagePreview,alt:"Background preview",class:"h-6 w-6 object-cover rounded"},null,8,vt),u[5]||(u[5]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Background set - Drag to move, scroll to zoom, use buttons to fit/reset",-1))])):S("",!0)]),e("div",yt,[o.backgroundImagePreview?(c(),m("button",{key:0,type:"button",onClick:x,title:"Fit Background to Canvas (Show Full Image)",class:"p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},[...u[6]||(u[6]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])):S("",!0),o.backgroundImagePreview?(c(),m("button",{key:1,type:"button",onClick:C,title:"Reset Background Position & Zoom",class:"p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},[...u[7]||(u[7]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])):S("",!0),e("button",{type:"button",onClick:u[0]||(u[0]=a=>o.selectedElement&&ie(o.selectedElement.id)),disabled:!o.selectedElement,title:"Bring to Front",class:"p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[M(W(ae),{class:"h-4 w-4"})],8,kt),e("button",{type:"button",onClick:u[1]||(u[1]=a=>o.selectedElement&&de(o.selectedElement.id)),disabled:!o.selectedElement,title:"Send to Back",class:"p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[M(W(ae),{class:"h-4 w-4 rotate-180"})],8,ft),e("button",{type:"button",onClick:u[2]||(u[2]=a=>o.selectedElement&&te(o.selectedElement.id)),disabled:!o.selectedElement,title:"Duplicate",class:"p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[M(W(Ee),{class:"h-4 w-4"})],8,xt),e("button",{type:"button",onClick:u[3]||(u[3]=a=>o.selectedElement&&oe(o.selectedElement.id)),disabled:!o.selectedElement,title:"Delete",class:"p-2 text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[M(W(Se),{class:"h-4 w-4"})],8,wt)])])]),e("div",Ct,[e("div",Et,[e("div",{class:"canvas-container",style:P({width:B.value.width+"px",height:B.value.height+"px",transform:`scale(${i.value})`,transformOrigin:"top center",margin:"0 auto"})},[e("div",{class:"relative overflow-hidden bg-gray-50 dark:bg-gray-700 shadow-lg cursor-crosshair border-2 border-black",style:P({width:d.form.width+"px",height:d.form.height+"px"}),onClick:l,onMousemove:le,onMouseup:se},[o.backgroundImagePreview?(c(),m("div",{key:0,class:U(["absolute inset-0 bg-contain bg-center bg-no-repeat z-0",o.selectedElement?"cursor-default":"cursor-move"]),style:P({backgroundImage:`url(${o.backgroundImagePreview})`,width:"100%",height:"100%",transform:`translate(${h.value.x}px, ${h.value.y}px) scale(${h.value.scale})`,transformOrigin:"0 0"}),onMousedown:ce,onMousemove:me,onMouseup:pe,onWheel:r,onTouchstart:n,onTouchmove:b,onTouchend:k},null,38)):S("",!0),!o.backgroundImagePreview&&o.canvasElements.length===0?(c(),m("div",St,[e("div",Tt,[e("div",It,[M(W(fe),{class:"h-8 w-8 text-gray-400"})]),u[8]||(u[8]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Start Creating",-1)),u[9]||(u[9]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," Select a tool and click on the canvas to add elements ",-1))])])):S("",!0),(c(!0),m(F,null,Q(t.value,a=>(c(),m("div",{key:a.id,class:U(["absolute cursor-move select-none",o.selectedElement?.id===a.id?"border-2 border-blue-500":""]),style:P({left:(o.selectedElement?.id===a.id?a.x-2:a.x)+"px",top:(o.selectedElement?.id===a.id?a.y-2:a.y)+"px",width:(o.selectedElement?.id===a.id?a.width+4:a.width)+"px",height:(o.selectedElement?.id===a.id?a.height+4:a.height)+"px",transform:`rotate(${a.rotation}deg)`,zIndex:a.zIndex,filter:a.properties.boxShadow!=="none"?a.properties.boxShadow:"none",textShadow:a.properties.textShadow}),onMousedown:T=>L(T,a),onClick:Ce(T=>V(a),["stop"])},[a.type==="text"?(c(),m("div",{key:0,class:"w-full h-full flex items-center justify-center text-center",style:P({fontSize:(a.properties.fontSize||16)+"px",fontFamily:a.properties.fontFamily||"Arial",fontWeight:a.properties.fontWeight||"normal",fontStyle:a.properties.fontStyle||"normal",textDecoration:a.properties.textDecoration||"none",textAlign:a.properties.textAlign||"left",lineHeight:String(a.properties.lineHeight||1.2),color:a.properties.color||"#000000"})},D(a.properties.text||"Text"),5)):a.type==="image"?(c(),m("div",{key:1,class:"w-full h-full flex items-center justify-center text-center",style:P({backgroundColor:a.properties.backgroundColor||"transparent",border:`${a.properties.borderWidth||0}px ${a.properties.borderStyle||"solid"} ${a.properties.borderColor||"#000000"}`,borderRadius:(a.properties.borderRadius||0)+"px",clipPath:G(a.properties.imageShape||"rectangle")})},[a.properties.imageUrl?(c(),m("img",{key:0,src:a.properties.imageUrl,alt:a.properties.text||"Image",class:"max-w-full max-h-full",style:P({objectFit:a.properties.imageFit||"cover"})},null,12,Ft)):(c(),m("div",{key:1,class:"w-full h-full flex items-center justify-center text-blue-500 bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/20 border-2 border-dashed border-blue-300 dark:border-blue-600 rounded-lg cursor-pointer hover:from-blue-100 hover:to-indigo-200 dark:hover:from-blue-800/30 dark:hover:to-indigo-800/30 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-200",onClick:T=>ne(a)},[...u[10]||(u[10]=[e("div",{class:"relative"},[e("svg",{class:"w-12 h-12 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})]),e("div",{class:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-pulse"})],-1)])],8,Mt))],4)):a.type==="rectangle"?(c(),m("div",{key:2,class:"w-full h-full",style:P({backgroundColor:a.properties.fillColor,border:a.properties.hasBorder?`${a.properties.strokeWidth}px ${a.properties.borderStyle} ${a.properties.strokeColor}`:"none",borderRadius:(a.properties.borderRadius||0)+"px"})},null,4)):a.type==="circle"?(c(),m("div",{key:3,class:"w-full h-full rounded-full",style:P({backgroundColor:a.properties.fillColor,border:a.properties.hasBorder?`${a.properties.strokeWidth}px ${a.properties.borderStyle} ${a.properties.strokeColor}`:"none"})},null,4)):a.type==="triangle"?(c(),m("div",{key:4,class:"w-full h-full",style:P({backgroundColor:a.properties.fillColor,border:a.properties.hasBorder?`${a.properties.strokeWidth}px ${a.properties.borderStyle} ${a.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 0% 100%, 100% 100%)"})},null,4)):a.type==="star"?(c(),m("div",{key:5,class:"w-full h-full",style:P({backgroundColor:a.properties.fillColor,border:a.properties.hasBorder?`${a.properties.strokeWidth}px ${a.properties.borderStyle} ${a.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)"})},null,4)):S("",!0),o.selectedElement?.id===a.id?(c(),m("div",{key:6,class:"absolute -bottom-1 -right-1 w-4 h-4 bg-blue-500 border-2 border-white rounded-full pointer-events-auto cursor-se-resize hover:bg-blue-600 transition-colors shadow-lg",onMousedown:T=>ue(T,a),title:"Resize (Shift+drag for proportional)"},null,40,Dt)):S("",!0)],46,$t))),128))],36)],4)])])]),Ie(o.$slots,"default")]))}}),zt={class:"bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm rounded-lg shadow-lg border border-gray-200/60 dark:border-gray-700/60"},Pt={class:"p-2"},Ot={class:"grid grid-cols-4 gap-1"},Wt=["onClick","title"],Rt=ee({__name:"ToolsPanel",props:{selectedTool:{}},emits:["update:selectedTool"],setup(j,{emit:$}){const d=$,y=[{id:"select",name:"Select",icon:Ae},{id:"text",name:"Text",icon:Re},{id:"image",name:"Image",icon:Qe},{id:"rectangle",name:"Rectangle",icon:Xe},{id:"circle",name:"Circle",icon:Ye},{id:"triangle",name:"Triangle",icon:Ue},{id:"star",name:"Star",icon:_e}],g=I=>{d("update:selectedTool",I)};return(I,h)=>(c(),m("div",zt,[h[0]||(h[0]=e("div",{class:"p-2 border-b border-gray-200/60 dark:border-gray-700/60"},[e("h2",{class:"text-xs font-semibold text-gray-900 dark:text-white"},"Tools")],-1)),e("div",Pt,[e("div",Ot,[(c(),m(F,null,Q(y,w=>e("button",{key:w.id,type:"button",onClick:f=>g(w.id),class:U(["flex items-center justify-center w-7 h-7 rounded-md transition-colors",I.selectedTool===w.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),title:w.name},[(c(),xe($e(w.icon),{class:"h-3.5 w-3.5"}))],10,Wt)),64))])])]))}}),Qt={key:0,class:"bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm rounded-lg shadow-lg border border-gray-200/60 dark:border-gray-700/60"},Yt={class:"p-3"},At={class:"mb-3"},Xt={class:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-md p-1"},_t={class:"space-y-3"},Ut={key:0,class:"space-y-2"},jt={key:0},Ht=["value"],Lt={key:1},Nt={key:1,class:"space-y-2"},qt={key:0,class:"space-y-2"},Vt=["value"],Kt=["value"],Gt=["value"],Zt={class:"flex gap-1"},Jt={class:"flex items-center gap-2"},eo=["value"],to={class:"flex flex-wrap gap-1"},oo=["onClick"],ro={key:1,class:"space-y-2"},ao=["value"],lo=["value"],so={class:"space-y-2"},no={class:"flex gap-2"},io={class:"flex items-center"},uo=["checked"],go={class:"flex items-center"},co=["checked"],mo={key:0,class:"flex items-center gap-2"},po=["value"],bo={class:"flex flex-wrap gap-1"},ho=["onClick"],vo={key:2},yo={class:"flex items-center gap-2"},ko=["value"],fo={class:"flex flex-wrap gap-1"},xo=["onClick"],wo={class:"flex items-center gap-2"},Co=["value"],Eo={class:"flex flex-wrap gap-1"},So=["onClick"],To={key:3},Io={class:"flex items-center gap-2 mb-2"},$o=["checked"],Fo={key:0,class:"space-y-2"},Mo={class:"grid grid-cols-2 gap-2"},Do=["value"],Bo=["value"],zo=["value"],Po=["value"],Oo=["value"],Wo=["value"],Ro={key:2,class:"space-y-2"},Qo={class:"grid grid-cols-2 gap-2"},Yo=["value"],Ao=["value"],Xo={class:"grid grid-cols-2 gap-2"},_o=["value"],Uo=["value"],jo={class:"space-y-2"},Ho={class:"grid grid-cols-2 gap-1"},Lo={class:"space-y-2"},No=ee({__name:"PropertiesPanel",props:{selectedElement:{}},emits:["updateElement","bringToFront","sendToBack","duplicateElement","deleteElement"],setup(j,{emit:$}){const d=j,y=$,g=E("content"),I=["Arial","Helvetica","Times New Roman","Georgia","Verdana","Courier New","Impact","Comic Sans MS","Trebuchet MS","Arial Black","Palatino","Garamond","Bookman","Avant Garde","Helvetica Neue","Roboto","Open Sans","Lato","Montserrat","Poppins","Source Sans Pro"],h=[{name:"None",value:"none"},{name:"Small",value:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))"},{name:"Medium",value:"drop-shadow(0 4px 8px rgba(0,0,0,0.15))"},{name:"Large",value:"drop-shadow(0 8px 16px rgba(0,0,0,0.2))"},{name:"X-Large",value:"drop-shadow(0 12px 24px rgba(0,0,0,0.25))"},{name:"Glow",value:"drop-shadow(0 0 20px rgba(0,0,0,0.3))"}],w=[{name:"Solid",value:"solid"},{name:"Dashed",value:"dashed"},{name:"Dotted",value:"dotted"},{name:"Double",value:"double"},{name:"Groove",value:"groove"},{name:"Ridge",value:"ridge"},{name:"Inset",value:"inset"},{name:"Outset",value:"outset"}],f=[{name:"Rectangle",value:"rectangle"},{name:"Circle",value:"circle"},{name:"Triangle",value:"triangle"},{name:"Star",value:"star"},{name:"Diamond",value:"diamond"},{name:"Hexagon",value:"hexagon"},{name:"Octagon",value:"octagon"}],p=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#C0C0C0","#FFD700","#008000","#000080","#800000"],s=(i,t)=>{d.selectedElement&&y("updateElement",d.selectedElement.id,i,t)},v=i=>i.target?.value||"",B=i=>i.target?.checked||!1;return(i,t)=>i.selectedElement?(c(),m("div",Qt,[e("div",Yt,[t[53]||(t[53]=e("h2",{class:"text-sm font-semibold text-gray-900 dark:text-white mb-3"},"Properties",-1)),e("div",At,[e("div",Xt,[e("button",{type:"button",onClick:t[0]||(t[0]=l=>g.value="content"),class:U(["flex-1 px-2 py-1.5 text-xs font-medium rounded transition-colors",g.value==="content"?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])}," Content ",2),e("button",{type:"button",onClick:t[1]||(t[1]=l=>g.value="style"),class:U(["flex-1 px-2 py-1.5 text-xs font-medium rounded transition-colors",g.value==="style"?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])}," Style ",2),e("button",{type:"button",onClick:t[2]||(t[2]=l=>g.value="position"),class:U(["flex-1 px-2 py-1.5 text-xs font-medium rounded transition-colors",g.value==="position"?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])}," Position ",2)])]),e("div",_t,[g.value==="content"?(c(),m("div",Ut,[i.selectedElement.type==="text"?(c(),m("div",jt,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Text Content ",-1)),e("textarea",{value:i.selectedElement.properties.text||"",onInput:t[3]||(t[3]=l=>s("text",v(l))),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm",placeholder:"Enter text content"},null,40,Ht)])):S("",!0),i.selectedElement.type==="image"&&i.selectedElement.properties.imageUrl?(c(),m("div",Lt,[e("button",{onClick:t[4]||(t[4]=l=>s("imageUrl","")),type:"button",class:"w-full px-3 py-2 text-sm font-medium text-red-600 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-900/30 transition-colors"}," Remove Image ")])):S("",!0)])):S("",!0),g.value==="style"?(c(),m("div",Nt,[i.selectedElement.type==="text"?(c(),m("div",qt,[e("div",null,[t[31]||(t[31]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Font Size ",-1)),e("input",{value:i.selectedElement.properties.fontSize||16,onInput:t[5]||(t[5]=l=>s("fontSize",parseInt(v(l))||16)),type:"number",min:"8",max:"200",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,Vt)]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Font Family ",-1)),e("select",{value:i.selectedElement.properties.fontFamily||"Arial",onChange:t[6]||(t[6]=l=>s("fontFamily",v(l))),class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[(c(),m(F,null,Q(I,l=>e("option",{key:l,value:l},D(l),9,Gt)),64))],40,Kt)]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Font Style ",-1)),e("div",Zt,[e("button",{type:"button",onClick:t[7]||(t[7]=l=>s("fontWeight",i.selectedElement.properties.fontWeight==="bold"?"normal":"bold")),class:U(["px-2 py-1 text-xs rounded",i.selectedElement.properties.fontWeight==="bold"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"])}," Bold ",2),e("button",{type:"button",onClick:t[8]||(t[8]=l=>s("fontStyle",i.selectedElement.properties.fontStyle==="italic"?"normal":"italic")),class:U(["px-2 py-1 text-xs rounded",i.selectedElement.properties.fontStyle==="italic"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"])}," Italic ",2),e("button",{type:"button",onClick:t[9]||(t[9]=l=>s("textDecoration",i.selectedElement.properties.textDecoration==="underline"?"none":"underline")),class:U(["px-2 py-1 text-xs rounded",i.selectedElement.properties.textDecoration==="underline"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"])}," Underline ",2)])]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Text Color ",-1)),e("div",Jt,[e("input",{value:i.selectedElement.properties.color||"#000000",onInput:t[10]||(t[10]=l=>s("color",v(l))),type:"color",class:"w-8 h-8 border border-gray-300 dark:border-gray-600 rounded cursor-pointer"},null,40,eo),e("div",to,[(c(),m(F,null,Q(p,l=>e("button",{key:l,type:"button",onClick:L=>s("color",l),style:P({backgroundColor:l}),class:"w-6 h-6 rounded border border-gray-300 dark:border-gray-600 hover:scale-110 transition-transform"},null,12,oo)),64))])])])])):S("",!0),i.selectedElement.type==="image"?(c(),m("div",ro,[e("div",null,[t[35]||(t[35]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Image Shape ",-1)),e("select",{value:i.selectedElement.properties.imageShape||"rectangle",onChange:t[11]||(t[11]=l=>s("imageShape",v(l))),class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[(c(),m(F,null,Q(f,l=>e("option",{key:l.value,value:l.value},D(l.name),9,lo)),64))],40,ao)]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Background ",-1)),e("div",so,[e("div",no,[e("label",io,[e("input",{type:"radio",checked:!i.selectedElement.properties.backgroundColor||i.selectedElement.properties.backgroundColor==="transparent",onChange:t[12]||(t[12]=l=>s("backgroundColor","transparent")),class:"mr-1"},null,40,uo),t[36]||(t[36]=e("span",{class:"text-xs"},"Transparent",-1))]),e("label",go,[e("input",{type:"radio",checked:i.selectedElement.properties.backgroundColor&&i.selectedElement.properties.backgroundColor!=="transparent",onChange:t[13]||(t[13]=l=>s("backgroundColor","#ffffff")),class:"mr-1"},null,40,co),t[37]||(t[37]=e("span",{class:"text-xs"},"Background Color",-1))])]),i.selectedElement.properties.backgroundColor&&i.selectedElement.properties.backgroundColor!=="transparent"?(c(),m("div",mo,[e("input",{value:i.selectedElement.properties.backgroundColor,onInput:t[14]||(t[14]=l=>s("backgroundColor",v(l))),type:"color",class:"w-8 h-8 border border-gray-300 dark:border-gray-600 rounded cursor-pointer"},null,40,po),e("div",bo,[(c(),m(F,null,Q(p,l=>e("button",{key:l,type:"button",onClick:L=>s("backgroundColor",l),style:P({backgroundColor:l}),class:"w-6 h-6 rounded border border-gray-300 dark:border-gray-600 hover:scale-110 transition-transform"},null,12,ho)),64))])])):S("",!0)])])])):S("",!0),["rectangle","circle","triangle","star"].includes(i.selectedElement.type)?(c(),m("div",vo,[t[39]||(t[39]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Fill Color ",-1)),e("div",yo,[e("input",{value:i.selectedElement.properties.fillColor||"#000000",onInput:t[15]||(t[15]=l=>s("fillColor",v(l))),type:"color",class:"w-8 h-8 border border-gray-300 dark:border-gray-600 rounded cursor-pointer"},null,40,ko),e("div",fo,[(c(),m(F,null,Q(p,l=>e("button",{key:l,type:"button",onClick:L=>s("fillColor",l),style:P({backgroundColor:l}),class:"w-6 h-6 rounded border border-gray-300 dark:border-gray-600 hover:scale-110 transition-transform"},null,12,xo)),64))])])])):S("",!0),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Stroke Color ",-1)),e("div",wo,[e("input",{value:i.selectedElement.properties.strokeColor||"#000000",onInput:t[16]||(t[16]=l=>s("strokeColor",v(l))),type:"color",class:"w-8 h-8 border border-gray-300 dark:border-gray-600 rounded cursor-pointer"},null,40,Co),e("div",Eo,[(c(),m(F,null,Q(p,l=>e("button",{key:l,type:"button",onClick:L=>s("strokeColor",l),style:P({backgroundColor:l}),class:"w-6 h-6 rounded border border-gray-300 dark:border-gray-600 hover:scale-110 transition-transform"},null,12,So)),64))])])]),i.selectedElement.type!=="text"?(c(),m("div",To,[e("div",Io,[e("input",{checked:i.selectedElement.properties.hasBorder||!1,onChange:t[17]||(t[17]=l=>s("hasBorder",B(l))),type:"checkbox",class:"rounded"},null,40,$o),t[41]||(t[41]=e("label",{class:"text-xs font-medium text-gray-500 dark:text-gray-400"}," Enable Border ",-1))]),i.selectedElement.properties.hasBorder?(c(),m("div",Fo,[e("div",Mo,[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Width ",-1)),e("input",{value:i.selectedElement.properties.borderWidth||1,onInput:t[18]||(t[18]=l=>s("borderWidth",parseInt(v(l))||1)),type:"number",min:"1",max:"20",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,Do)]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Style ",-1)),e("select",{value:i.selectedElement.properties.borderStyle||"solid",onChange:t[19]||(t[19]=l=>s("borderStyle",v(l))),class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[(c(),m(F,null,Q(w,l=>e("option",{key:l.value,value:l.value},D(l.name),9,zo)),64))],40,Bo)])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Border Radius ",-1)),e("input",{value:i.selectedElement.properties.borderRadius||0,onInput:t[20]||(t[20]=l=>s("borderRadius",parseInt(v(l))||0)),type:"number",min:"0",max:"50",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,Po)])])):S("",!0)])):S("",!0),e("div",null,[t[45]||(t[45]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Shadow ",-1)),e("select",{value:i.selectedElement.properties.boxShadow||"none",onChange:t[21]||(t[21]=l=>s("boxShadow",v(l))),class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[(c(),m(F,null,Q(h,l=>e("option",{key:l.value,value:l.value},D(l.name),9,Wo)),64))],40,Oo)])])):S("",!0),g.value==="position"?(c(),m("div",Ro,[e("div",Qo,[e("div",null,[t[46]||(t[46]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," X Position ",-1)),e("input",{value:i.selectedElement.x,onInput:t[22]||(t[22]=l=>s("x",parseInt(v(l))||0)),type:"number",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,Yo)]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Y Position ",-1)),e("input",{value:i.selectedElement.y,onInput:t[23]||(t[23]=l=>s("y",parseInt(v(l))||0)),type:"number",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,Ao)])]),e("div",Xo,[e("div",null,[t[48]||(t[48]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Width ",-1)),e("input",{value:i.selectedElement.width,onInput:t[24]||(t[24]=l=>s("width",parseFloat(v(l))||10)),type:"number",step:"0.5",min:"10",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,_o)]),e("div",null,[t[49]||(t[49]=e("label",{class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1"}," Height ",-1)),e("input",{value:i.selectedElement.height,onInput:t[25]||(t[25]=l=>s("height",parseFloat(v(l))||10)),type:"number",step:"0.5",min:"10",class:"w-full px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,40,Uo)])]),e("div",jo,[t[50]||(t[50]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Layer",-1)),e("div",Ho,[e("button",{type:"button",onClick:t[26]||(t[26]=l=>y("bringToFront",i.selectedElement.id)),class:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[M(W(ae),{class:"h-3 w-3 mx-auto"})]),e("button",{type:"button",onClick:t[27]||(t[27]=l=>y("sendToBack",i.selectedElement.id)),class:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[M(W(ae),{class:"h-3 w-3 mx-auto rotate-180"})])])]),e("div",Lo,[e("button",{type:"button",onClick:t[28]||(t[28]=l=>y("duplicateElement",i.selectedElement.id)),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},[M(W(Ee),{class:"h-4 w-4"}),t[51]||(t[51]=_(" Duplicate ",-1))]),e("button",{type:"button",onClick:t[29]||(t[29]=l=>y("deleteElement",i.selectedElement.id)),class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm"},[M(W(Se),{class:"h-4 w-4"}),t[52]||(t[52]=_(" Delete Element ",-1))])])])):S("",!0)])])])):S("",!0)}}),qo={class:"w-full px-2 sm:px-4 py-4"},Vo={class:"w-full"},Ko={class:"flex flex-col xl:flex-row gap-4"},Go={class:"flex-1 min-w-0"},Zo={class:"w-full xl:w-80 flex-shrink-0 space-y-4"},pr=ee({__name:"Create",props:{template:{}},setup(j){const $=j;Fe();const d=J(()=>!!$.template),y=J(()=>[{title:"Dashboard",href:Oe().url},{title:"Templates",href:ze.index().url},{title:d.value?"Edit Template":"Create Template",href:"#"}]),g=E({name:"",width:800,height:600,background_image:null,canvas_data:[]}),I=E(null),h=E({width:0,height:0});we(()=>{if(i.value={name:"Original Size",width:0,height:0},d.value&&$.template){g.value.name=$.template.name,g.value.width=$.template.width,g.value.height=$.template.height;let r=$.template.canvas_data;if(typeof r=="string")try{r=JSON.parse(r)}catch{r=[]}t.value=Array.isArray(r)?r:[],$.template.background_image&&(I.value=`/storage/${$.template.background_image}`)}});const w=E("select"),f=E(null),p=E(!1),s=E({x:0,y:0}),v=E(!1);E(!1),E(""),E({x:0,y:0,width:0,height:0,fontSize:0});const B=E(!1),i=E(null),t=E([]);he(f,()=>{},{deep:!0}),he(w,r=>{if(r!=="select"){const n=g.value.width/2,b=g.value.height/2;l(r,n,b)}});const l=(r,n,b)=>{const k=t.value.length>0?Math.max(...t.value.map(R=>R.zIndex)):0,C={id:Date.now().toString(),type:r,x:n,y:b,width:r==="text"?200:100,height:r==="text"?50:100,rotation:0,zIndex:k+1,properties:{text:r==="text"?"Sample Text":"",fontSize:r==="text"?16:void 0,fontFamily:r==="text"?"Arial":void 0,fontWeight:r==="text"?"normal":void 0,fontStyle:r==="text"?"normal":void 0,textDecoration:r==="text"?"none":void 0,textAlign:r==="text"?"left":void 0,lineHeight:r==="text"?1.2:void 0,color:r==="text"?"#000000":void 0,fillColor:r==="text"?"transparent":"#000000",strokeColor:"#000000",strokeWidth:1,hasBorder:!1,borderWidth:1,borderStyle:"solid",borderColor:"#000000",borderRadius:0,boxShadow:"none",textShadow:"none",imageUrl:r==="image"?"":void 0,imageFit:r==="image"?"cover":void 0,backgroundColor:r==="text"||r==="image"?"transparent":"#000000",imageShape:r==="image"?"rectangle":void 0}};t.value.push(C),f.value=C,w.value="select"},L=r=>{f.value=r,w.value="select"},le=(r,n,b)=>{const k=t.value.findIndex(C=>C.id===r);if(k!==-1){const C=t.value[k];C.properties={...C.properties,[n]:b},t.value[k]={...C},f.value?.id===r&&(f.value={...C})}},se=r=>{w.value==="select"&&(f.value=null)},V=()=>{const r=document.querySelector(".template-preview-container");if(r){const n=r.getBoundingClientRect(),b=window.innerWidth<1024?400:600,k=window.innerWidth<1024?300:450,C=b/g.value.width,R=k/g.value.height,x=Math.min(C,R,1),G=g.value.width*x,o=g.value.height*x,u=n.width/G,a=n.height/o;return Math.min(u,a,1)*x}return 1},ne=(r,n)=>{if(w.value==="select"){r.preventDefault(),p.value=!0;const b=V();s.value={x:r.clientX-n.x*b,y:r.clientY-n.y*b},f.value=n}},ie=r=>{if(p.value&&f.value){const n=V();f.value.x=(r.clientX-s.value.x)/n,f.value.y=(r.clientY-s.value.y)/n}},de=r=>{p.value=!1},te=r=>{const n=t.value.find(b=>b.id===r);if(n){const b=Math.max(...t.value.map(k=>k.zIndex));n.zIndex=b+1}},oe=r=>{const n=t.value.find(b=>b.id===r);if(n){const b=Math.min(...t.value.map(k=>k.zIndex));n.zIndex=b-1}},H=r=>{const n=t.value.find(b=>b.id===r);if(n){const b=Math.max(...t.value.map(C=>C.zIndex)),k={...n,id:Date.now().toString(),x:n.x+20,y:n.y+20,zIndex:b+1};t.value.push(k),f.value=k}},z=r=>{const n=t.value.findIndex(b=>b.id===r);n!==-1&&(t.value.splice(n,1),f.value?.id===r&&(f.value=null))},ue=(r,n,b,k,C,R)=>{const x=t.value.find(G=>G.id===r);x&&(x.width=n,x.height=b,x.x=k,x.y=C,x.type==="text"&&R!==void 0&&(x.properties.fontSize=R),f.value?.id===r&&(f.value={...x}))},ge=r=>{i.value=r,r.name!=="Custom"&&r.name!=="Original Size"?(g.value.width=r.width,g.value.height=r.height):r.name==="Original Size"&&(h.value.width>0?(g.value.width=h.value.width,g.value.height=h.value.height):(g.value.width=r.width,g.value.height=r.height)),B.value=!1},re=r=>{if(console.log("Background image file selected:",r),console.log("File type:",r.type),console.log("File size:",r.size),console.log("File name:",r.name),!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(r.type)){console.error("Invalid file type:",r.type),A.fire({title:"Invalid File Type",text:`Please select a valid image file. Detected type: ${r.type}. Supported types: JPEG, PNG, GIF, WebP`,icon:"error",confirmButtonText:"OK"});return}const b=10*1024*1024;if(r.size>b){A.fire({title:"File Too Large",text:"Please select an image smaller than 10MB",icon:"error",confirmButtonText:"OK"});return}g.value.background_image=r;const k=new FileReader;k.onload=C=>{const R=C.target?.result;console.log("Background image preview created:",R?"Yes":"No"),I.value=R;const x=new Image;x.onload=()=>{console.log("Image loaded, dimensions:",x.naturalWidth,"x",x.naturalHeight),h.value={width:x.naturalWidth,height:x.naturalHeight},g.value.width=x.naturalWidth,g.value.height=x.naturalHeight,i.value={name:"Original Size",width:x.naturalWidth,height:x.naturalHeight}},x.onerror=()=>{console.error("Failed to load image"),A.fire({title:"Invalid Image",text:"The selected file is not a valid image",icon:"error",confirmButtonText:"OK"})},x.src=R},k.onerror=()=>{console.error("Failed to read file"),A.fire({title:"File Read Error",text:"Failed to read the selected file",icon:"error",confirmButtonText:"OK"})},k.readAsDataURL(r)},ce=async()=>{if(g.value.width<100||g.value.height<100){A.fire({title:"Invalid Dimensions",text:"Canvas dimensions must be at least 100x100 pixels",icon:"warning",confirmButtonText:"OK"});return}if(!g.value.name.trim()){A.fire({title:"Missing Template Name",text:"Please enter a template name",icon:"warning",confirmButtonText:"OK"});return}v.value=!0;try{const r=new FormData;if(r.append("name",g.value.name),r.append("width",g.value.width.toString()),r.append("height",g.value.height.toString()),r.append("canvas_data",JSON.stringify(t.value)),g.value.background_image)if(console.log("Adding background image to FormData:",{file:g.value.background_image,type:g.value.background_image.type,size:g.value.background_image.size,name:g.value.background_image.name}),g.value.background_image instanceof File&&g.value.background_image.size>0)r.append("background_image",g.value.background_image,g.value.background_image.name),console.log("File added to FormData successfully");else{console.error("File is invalid or corrupted:",g.value.background_image),A.fire({title:"File Error",text:"The selected file appears to be corrupted. Please try selecting the file again.",icon:"error",confirmButtonText:"OK"});return}console.log("FormData contents:");for(let[n,b]of r.entries())console.log(n,b);if(d.value){const n=await ye.post(`/templates/${$.template?.id}`,r,{headers:{"Content-Type":"multipart/form-data"}});A.fire({title:"Success!",text:"Template updated successfully.",icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,toast:!0}).then(()=>{ke.visit("/templates")})}else{const n=await ye.post("/templates",r,{headers:{"Content-Type":"multipart/form-data"}});A.fire({title:"Success!",text:"Template created successfully.",icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,toast:!0}).then(()=>{ke.visit("/templates")})}}catch(r){console.error("Error submitting form:",r);let n="An unexpected error occurred. Please try again.",b="Error!";if(r.response&&r.response.data){if(r.response.data.message&&(n=r.response.data.message),r.response.data.errors){const k=r.response.data.errors;if(console.log("Validation errors:",k),k.background_image)b="Background Image Error",n=k.background_image[0];else{const C=Object.values(k)[0];Array.isArray(C)&&C.length>0&&(n=C[0])}}}else r.message&&(n=r.message);A.fire({title:b,text:n,icon:"error",confirmButtonText:"OK"})}finally{v.value=!1}},me=r=>{r.target.closest(".quick-template-dropdown")||(B.value=!1)},pe=r=>{r.key==="Escape"&&(B.value=!1)};return(r,n)=>(c(),m(F,null,[M(W(Me),{title:d.value?"Edit Template":"Create Template"},null,8,["title"]),M(Pe,{breadcrumbs:y.value},{default:De(()=>[e("div",{class:"min-h-screen bg-gray-50 dark:bg-gray-900",onClick:me,onKeydown:pe},[e("div",qo,[e("form",{onSubmit:Ce(ce,["prevent"]),class:"space-y-6"},[e("div",Vo,[M(dt,{form:g.value,"onUpdate:form":n[0]||(n[0]=b=>g.value=b),backgroundImagePreview:I.value,"onUpdate:backgroundImagePreview":n[1]||(n[1]=b=>I.value=b),selectedQuickTemplate:i.value,"onUpdate:selectedQuickTemplate":n[2]||(n[2]=b=>i.value=b),isQuickTemplateDropdownOpen:B.value,"onUpdate:isQuickTemplateDropdownOpen":n[3]||(n[3]=b=>B.value=b),originalImageDimensions:h.value,"is-edit-mode":d.value,"is-submitting":v.value,onBackgroundImageChange:re,onApplyQuickTemplate:ge},null,8,["form","backgroundImagePreview","selectedQuickTemplate","isQuickTemplateDropdownOpen","originalImageDimensions","is-edit-mode","is-submitting"])]),e("div",Ko,[e("div",Go,[M(Bt,{form:g.value,backgroundImagePreview:I.value,canvasElements:t.value,selectedElement:f.value,selectedTool:w.value,onCanvasClick:se,onElementMouseDown:ne,onMouseMove:ie,onMouseUp:de,onSelectElement:L,onBringToFront:te,onSendToBack:oe,onDuplicateElement:H,onDeleteElement:z,onResizeElement:ue,onBackgroundImageChange:re},null,8,["form","backgroundImagePreview","canvasElements","selectedElement","selectedTool"])]),e("div",Zo,[M(Rt,{selectedTool:w.value,"onUpdate:selectedTool":n[4]||(n[4]=b=>w.value=b)},null,8,["selectedTool"]),M(No,{selectedElement:f.value,onUpdateElement:le,onBringToFront:te,onSendToBack:oe,onDuplicateElement:H,onDeleteElement:z},null,8,["selectedElement"])])])],32)])],32)]),_:1},8,["breadcrumbs"])],64))}});export{pr as default};
