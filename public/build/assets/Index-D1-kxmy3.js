import{d as ce,j as k,k as re,c as G,m as Se,a as g,o as p,f as e,b as n,i as K,g as S,e as o,w as u,p as r,q as U,v as M,F as B,r as q,n as O,s as Z,t as L,x as D,y as Ce,h as Ae}from"./app-fqnjF0PA.js";import{_ as $e}from"./AppLayout.vue_vue_type_script_setup_true_lang-BxlKFDdo.js";import{_ as P}from"./index-Cu1aQQ5f.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang-MM56WhYu.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-BEzfSHan.js";import{_ as Q,a as pe,b as ge,c as ee,d as ze}from"./CardTitle.vue_vue_type_script_setup_true_lang-i_EIIuub.js";import{_ as te,a as oe,b as ne,c as ae}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CLiaWJSp.js";import{_ as ke}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-Lhi_vClW.js";import{P as xe}from"./plus-B0QLOJ9t.js";import{X as be}from"./x-DvKoq_j2.js";import{U as ye}from"./upload-_ouhy-O_.js";import{c as Fe}from"./createLucideIcon-C8Z1QASB.js";import{E as we}from"./eye-BYempotu.js";import"./useAssets-CaeVs28n.js";import"./useForwardExpose-CNvgZUMu.js";import"./VisuallyHidden-C3fKVd4-.js";import"./RovingFocusGroup-DHuPoEBD.js";import"./index-DK8P9mNh.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./loader-circle-sJOeHZCO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=Fe("FileSpreadsheetIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=Fe("PencilIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),De={key:0,class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},Ue={class:"lg:col-span-1 space-y-4"},Me={class:"flex items-center justify-between"},Pe={class:"space-y-4 py-4"},Ne={class:"grid grid-cols-2 gap-2"},We={key:0,class:"text-xs text-muted-foreground text-center"},Ee={class:"space-y-2"},Te=["onClick"],_e={class:"flex items-center justify-between"},Le={class:"text-sm font-medium"},Re=["onClick"],He={key:0,class:"text-sm text-muted-foreground text-center py-4"},Ie=["value"],je=["value"],Be={class:"grid grid-cols-2 gap-2"},Ge=["value"],Xe=["value"],Ye=["value"],Oe={class:"lg:col-span-3 flex flex-col min-h-0"},qe={class:"flex justify-center items-center h-full overflow-auto p-4 bg-gray-50 rounded-lg"},Ze=["onMousedown","onClick"],Je={key:1,class:"h-full"},Ke={class:"flex justify-center items-center h-full overflow-auto p-4 bg-gray-50 rounded-lg"},Qe=["onMousedown","onClick"],de=3.779527559,el=ce({__name:"PdfTemplateBuilder",props:{template:{},showOnlyCanvas:{type:Boolean},selectedFieldId:{}},emits:["update","fieldSelected"],setup(se,{emit:c}){const C=se,$=c,A=k(null),v=k(null);re(()=>C.selectedFieldId,f=>{if(f){const t=V.value.find(s=>s.id===f);t&&(v.value=t)}else v.value=null},{immediate:!0});const W=k(!1),E=k({x:0,y:0}),T=k(!1),z=k(null),b=k(!1),m=k({label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"});re(b,f=>{f&&(m.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})});const h=G(()=>{if(!A.value)return 1;const f=A.value.parentElement;if(!f)return 1;const t=f.clientWidth-32,s=f.clientHeight-32,y=C.template.width*de,I=C.template.height*de,d=s/I,l=t/y;return Math.min(d,l)*.98}),i=G(()=>C.template.width*de*h.value),_=G(()=>C.template.height*de*h.value),V=G(()=>C.template.fields),X=()=>{$("update",{...C.template,fields:[...V.value]})},J=G(()=>m.value.label?.trim()&&m.value.column?.trim()),ve=()=>{if(!J.value)return;const f={id:Date.now().toString(),x:10,y:10,width:100,height:30,column:m.value.column?.trim()||"",label:m.value.label?.trim()||"",fontSize:m.value.fontSize||16,textAlign:m.value.textAlign||"left",fontFamily:m.value.fontFamily||"Arial",fontColor:m.value.fontColor||"#000000",fontWeight:m.value.fontWeight||"normal",fontStyle:m.value.fontStyle||"normal",textDecoration:m.value.textDecoration||"none"};V.value.push(f),X(),b.value=!1,m.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},v.value=f},me=f=>{const t=V.value.findIndex(s=>s.id===f);t>-1&&(V.value.splice(t,1),X(),v.value?.id===f&&(v.value=null,$("fieldSelected",null)))},le=f=>{v.value=f,$("fieldSelected",f)},j=f=>{const t=3.779527559,s=f.x*t*h.value,y=f.y*t*h.value,I=f.width*t*h.value,d=f.height*t*h.value;return{left:`${s}px`,top:`${y}px`,width:`${I}px`,height:`${d}px`,fontFamily:f.fontFamily||"Arial",color:f.fontColor||"#000000",fontWeight:f.fontWeight||"normal",fontStyle:f.fontStyle||"normal",textDecoration:f.textDecoration||"none",fontSize:`${(f.fontSize||16)*h.value}px`,textAlign:f.textAlign||"left"}},ue=(f,t)=>{if(f.target.classList.contains("resize-handle")||f.target.tagName==="BUTTON"||(f.preventDefault(),f.stopPropagation(),W.value=!0,v.value=t,!A.value))return;const s=A.value.getBoundingClientRect(),y=f.clientX-s.left,I=f.clientY-s.top,d=3.779527559,l=y/h.value/d,a=I/h.value/d;E.value={x:l-t.x,y:a-t.y}},fe=f=>{if(!A.value)return;const t=A.value.getBoundingClientRect(),s=f.clientX-t.left,y=f.clientY-t.top,I=3.779527559,d=s/h.value/I,l=y/h.value/I;if(W.value&&v.value){const a=v.value,w=d-E.value.x,F=l-E.value.y;a.x=Math.max(0,Math.min(w,C.template.width-a.width)),a.y=Math.max(0,Math.min(F,C.template.height-a.height)),X()}else if(T.value&&v.value&&z.value){const a=v.value,w=z.value;if(w.includes("e")&&(a.width=Math.max(20,Math.min(d-a.x,C.template.width-a.x))),w.includes("s")&&(a.height=Math.max(20,Math.min(l-a.y,C.template.height-a.y))),w.includes("w")){const F=a.width+(a.x-d);F>=20&&d>=0&&(a.width=F,a.x=d)}if(w.includes("n")){const F=a.height+(a.y-l);F>=20&&l>=0&&(a.height=F,a.y=l)}X()}},R=(f,t)=>{if(f.stopPropagation(),T.value=!0,z.value=t,v.value){const s=v.value;E.value={x:s.x*h.value,y:s.y*h.value}}};Se(()=>{document.addEventListener("mousemove",fe),document.addEventListener("mouseup",ie),document.addEventListener("mouseleave",ie)});const ie=()=>{(W.value||T.value)&&(W.value=!1,T.value=!1,z.value=null)},H=(f,t,s)=>{f[t]=s,X()};return(f,t)=>f.showOnlyCanvas?(p(),g("div",Je,[n(o(Q),{class:"h-full flex flex-col"},{default:u(()=>[n(o(ee),{class:"flex-1 overflow-auto p-0"},{default:u(()=>[e("div",Ke,[e("div",{class:"relative border-2 border-dashed border-gray-400 bg-white shadow-lg",ref_key:"canvasRef",ref:A,style:O({width:i.value+"px",height:_.value+"px",minWidth:i.value+"px",minHeight:_.value+"px",aspectRatio:(C.template.width/C.template.height).toString()})},[(p(!0),g(B,null,q(V.value,s=>(p(),g("div",{key:s.id,class:Z(["absolute border-2 cursor-move select-none",v.value?.id===s.id?"border-blue-600 bg-blue-200 shadow-lg z-20":"border-blue-400 bg-blue-100 z-10"]),style:O(j(s)),onMousedown:D(y=>ue(y,s),["prevent"]),onClick:D(y=>le(s),["stop"])},[e("div",{class:"h-full p-2 pointer-events-none w-full flex items-center",style:O({textAlign:s.textAlign||"left",justifyContent:s.textAlign==="center"?"center":s.textAlign==="right"?"flex-end":"flex-start"})},[e("span",{style:O({fontFamily:s.fontFamily||"Arial",color:s.fontColor||"#000000",fontWeight:s.fontWeight||"normal",fontStyle:s.fontStyle||"normal",textDecoration:s.textDecoration||"none",fontSize:`${(s.fontSize||16)*h.value}px`,display:"inline-block",width:"100%"})},L(s.label||s.column),5)],4),v.value?.id===s.id?(p(),g("div",{key:0,class:"resize-handle absolute bottom-0 right-0 h-2 w-2 cursor-se-resize bg-blue-500",onMousedown:t[21]||(t[21]=D(y=>R(y,"se"),["stop"]))},null,32)):S("",!0),v.value?.id===s.id?(p(),g("div",{key:1,class:"resize-handle absolute top-0 right-0 h-2 w-2 cursor-ne-resize bg-blue-500",onMousedown:t[22]||(t[22]=D(y=>R(y,"ne"),["stop"]))},null,32)):S("",!0),v.value?.id===s.id?(p(),g("div",{key:2,class:"resize-handle absolute bottom-0 left-0 h-2 w-2 cursor-sw-resize bg-blue-500",onMousedown:t[23]||(t[23]=D(y=>R(y,"sw"),["stop"]))},null,32)):S("",!0),v.value?.id===s.id?(p(),g("div",{key:3,class:"resize-handle absolute top-0 left-0 h-2 w-2 cursor-nw-resize bg-blue-500",onMousedown:t[24]||(t[24]=D(y=>R(y,"nw"),["stop"]))},null,32)):S("",!0)],46,Qe))),128))],4)])]),_:1})]),_:1})])):(p(),g("div",De,[e("div",Ue,[n(o(Q),null,{default:u(()=>[n(o(pe),null,{default:u(()=>[e("div",Me,[n(o(ge),null,{default:u(()=>[...t[25]||(t[25]=[r("Fields",-1)])]),_:1}),n(o(te),{open:b.value,"onUpdate:open":t[9]||(t[9]=s=>b.value=s)},{default:u(()=>[n(o(ke),{"as-child":""},{default:u(()=>[n(o(P),{size:"sm"},{default:u(()=>[n(o(xe),{class:"mr-2 h-4 w-4"}),t[26]||(t[26]=r(" Add Field ",-1))]),_:1})]),_:1}),n(o(oe),null,{default:u(()=>[n(o(ne),null,{default:u(()=>[n(o(ae),null,{default:u(()=>[...t[27]||(t[27]=[r("Add Field",-1)])]),_:1})]),_:1}),e("div",Pe,[e("div",null,[n(o(x),null,{default:u(()=>[...t[28]||(t[28]=[r("Label",-1)])]),_:1}),n(o(N),{modelValue:m.value.label,"onUpdate:modelValue":t[0]||(t[0]=s=>m.value.label=s),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[29]||(t[29]=[r("Column Name",-1)])]),_:1}),n(o(N),{modelValue:m.value.column,"onUpdate:modelValue":t[1]||(t[1]=s=>m.value.column=s),placeholder:"e.g., name"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[30]||(t[30]=[r("Font Size",-1)])]),_:1}),n(o(N),{modelValue:m.value.fontSize,"onUpdate:modelValue":t[2]||(t[2]=s=>m.value.fontSize=s),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[31]||(t[31]=[r("Text Align",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>m.value.textAlign=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[32]||(t[32]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],512),[[M,m.value.textAlign]])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[33]||(t[33]=[r("Font Family",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>m.value.fontFamily=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[34]||(t[34]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[M,m.value.fontFamily]])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[35]||(t[35]=[r("Font Color",-1)])]),_:1}),n(o(N),{modelValue:m.value.fontColor,"onUpdate:modelValue":t[5]||(t[5]=s=>m.value.fontColor=s),type:"color",class:"h-10"},null,8,["modelValue"])]),e("div",Ne,[e("div",null,[n(o(x),null,{default:u(()=>[...t[36]||(t[36]=[r("Font Weight",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>m.value.fontWeight=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[37]||(t[37]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],512),[[M,m.value.fontWeight]])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[38]||(t[38]=[r("Font Style",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>m.value.fontStyle=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[39]||(t[39]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],512),[[M,m.value.fontStyle]])])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[40]||(t[40]=[r("Text Decoration",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>m.value.textDecoration=s),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[41]||(t[41]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],512),[[M,m.value.textDecoration]])]),n(o(P),{onClick:ve,class:"w-full",disabled:!J.value},{default:u(()=>[...t[42]||(t[42]=[r(" Add Field ",-1)])]),_:1},8,["disabled"]),J.value?S("",!0):(p(),g("p",We," Please fill in Label and Column Name to add field "))])]),_:1})]),_:1},8,["open"])])]),_:1}),n(o(ee),null,{default:u(()=>[e("div",Ee,[(p(!0),g(B,null,q(V.value,s=>(p(),g("div",{key:s.id,class:Z(["p-2 border rounded cursor-pointer",v.value?.id===s.id?"border-blue-500 bg-blue-50":"border-gray-200"]),onClick:y=>le(s)},[e("div",_e,[e("span",Le,L(s.label||s.column),1),e("button",{onClick:D(y=>me(s.id),["stop"]),class:"text-red-500 hover:text-red-700"},[n(o(be),{class:"h-4 w-4"})],8,Re)])],10,Te))),128)),V.value.length===0?(p(),g("p",He,' No fields yet. Click "Add Field" to create one. ')):S("",!0)])]),_:1})]),_:1}),v.value?(p(),K(o(Q),{key:0},{default:u(()=>[n(o(pe),null,{default:u(()=>[n(o(ge),null,{default:u(()=>[...t[43]||(t[43]=[r("Field Properties",-1)])]),_:1})]),_:1}),n(o(ee),{class:"space-y-4"},{default:u(()=>[e("div",null,[n(o(x),null,{default:u(()=>[...t[44]||(t[44]=[r("Font Size",-1)])]),_:1}),n(o(N),{value:v.value.fontSize,type:"number",onInput:t[10]||(t[10]=s=>H(v.value,"fontSize",parseFloat(s.target.value)))},null,8,["value"])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[45]||(t[45]=[r("Text Align",-1)])]),_:1}),e("select",{value:v.value.textAlign,onChange:t[11]||(t[11]=s=>H(v.value,"textAlign",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[46]||(t[46]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],40,Ie)]),e("div",null,[n(o(x),null,{default:u(()=>[...t[47]||(t[47]=[r("Font Family",-1)])]),_:1}),e("select",{value:v.value.fontFamily||"Arial",onChange:t[12]||(t[12]=s=>H(v.value,"fontFamily",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[48]||(t[48]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],40,je)]),e("div",null,[n(o(x),null,{default:u(()=>[...t[49]||(t[49]=[r("Font Color",-1)])]),_:1}),n(o(N),{value:v.value.fontColor||"#000000",type:"color",class:"h-10",onInput:t[13]||(t[13]=s=>H(v.value,"fontColor",s.target.value))},null,8,["value"])]),e("div",Be,[e("div",null,[n(o(x),null,{default:u(()=>[...t[50]||(t[50]=[r("Font Weight",-1)])]),_:1}),e("select",{value:v.value.fontWeight||"normal",onChange:t[14]||(t[14]=s=>H(v.value,"fontWeight",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[51]||(t[51]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],40,Ge)]),e("div",null,[n(o(x),null,{default:u(()=>[...t[52]||(t[52]=[r("Font Style",-1)])]),_:1}),e("select",{value:v.value.fontStyle||"normal",onChange:t[15]||(t[15]=s=>H(v.value,"fontStyle",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[53]||(t[53]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],40,Xe)])]),e("div",null,[n(o(x),null,{default:u(()=>[...t[54]||(t[54]=[r("Text Decoration",-1)])]),_:1}),e("select",{value:v.value.textDecoration||"none",onChange:t[16]||(t[16]=s=>H(v.value,"textDecoration",s.target.value)),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...t[55]||(t[55]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],40,Ye)])]),_:1})]),_:1})):S("",!0)]),e("div",Oe,[n(o(Q),{class:"flex-1 flex flex-col min-h-0"},{default:u(()=>[n(o(ee),{class:"p-0 flex-1 overflow-hidden min-h-0"},{default:u(()=>[e("div",qe,[e("div",{class:"relative border-2 border-dashed border-gray-400 bg-white shadow-lg",ref_key:"canvasRef",ref:A,style:O({width:i.value+"px",height:_.value+"px",minWidth:i.value+"px",minHeight:_.value+"px",aspectRatio:(C.template.width/C.template.height).toString()})},[(p(!0),g(B,null,q(V.value,s=>(p(),g("div",{key:s.id,class:Z(["absolute border-2 cursor-move select-none",v.value?.id===s.id?"border-blue-600 bg-blue-200 shadow-lg z-20":"border-blue-400 bg-blue-100 z-10"]),style:O(j(s)),onMousedown:D(y=>ue(y,s),["prevent"]),onClick:D(y=>le(s),["stop"])},[e("div",{class:"h-full p-2 pointer-events-none w-full flex items-center",style:O({textAlign:s.textAlign||"left",justifyContent:s.textAlign==="center"?"center":s.textAlign==="right"?"flex-end":"flex-start"})},[e("span",{style:O({fontFamily:s.fontFamily||"Arial",color:s.fontColor||"#000000",fontWeight:s.fontWeight||"normal",fontStyle:s.fontStyle||"normal",textDecoration:s.textDecoration||"none",fontSize:`${(s.fontSize||16)*h.value}px`,display:"inline-block",width:"100%"})},L(s.label||s.column),5)],4),v.value?.id===s.id?(p(),g("div",{key:0,class:"resize-handle absolute bottom-0 right-0 h-2 w-2 cursor-se-resize bg-blue-500",onMousedown:t[17]||(t[17]=D(y=>R(y,"se"),["stop"]))},null,32)):S("",!0),v.value?.id===s.id?(p(),g("div",{key:1,class:"resize-handle absolute top-0 right-0 h-2 w-2 cursor-ne-resize bg-blue-500",onMousedown:t[18]||(t[18]=D(y=>R(y,"ne"),["stop"]))},null,32)):S("",!0),v.value?.id===s.id?(p(),g("div",{key:2,class:"resize-handle absolute bottom-0 left-0 h-2 w-2 cursor-sw-resize bg-blue-500",onMousedown:t[19]||(t[19]=D(y=>R(y,"sw"),["stop"]))},null,32)):S("",!0),v.value?.id===s.id?(p(),g("div",{key:3,class:"resize-handle absolute top-0 left-0 h-2 w-2 cursor-nw-resize bg-blue-500",onMousedown:t[20]||(t[20]=D(y=>R(y,"nw"),["stop"]))},null,32)):S("",!0)],46,Ze))),128))],4)])]),_:1})]),_:1})])]))}}),ll={class:"space-y-4"},tl={key:0,class:"text-center py-4"},ol={key:1,class:"mt-4"},nl={class:"flex items-center justify-between"},al={class:"flex items-center gap-2"},sl={key:1,class:"space-y-4"},ul={key:0,class:"text-center py-4"},il={key:1,class:"mt-4"},dl={class:"flex items-center justify-between"},rl={class:"flex items-center gap-2"},vl=ce({__name:"ExcelUploader",props:{excelData:{},noCard:{type:Boolean}},emits:["uploaded","viewFile"],setup(se,{emit:c}){const C=se,$=c,A=k(!1),v=k(null),W=k(C.excelData||[]),E=async z=>{const m=z.target.files?.[0];if(m){if(!m.name.match(/\.(xlsx|xls|csv)$/i)){alert("Please upload a valid Excel file (.xlsx, .xls, or .csv)");return}A.value=!0;try{const h=new FormData;h.append("excel_file",m);const i=await Ce.post("/pdf-templates/upload-excel",h,{headers:{"Content-Type":"multipart/form-data"}});W.value=i.data.data||[],$("uploaded",{data:i.data.data||[],columns:i.data.columns||[]})}catch(h){alert("Error uploading file: "+(h.response?.data?.message||h.message))}finally{A.value=!1,v.value&&(v.value.value="")}}},T=()=>{v.value?.click()};return(z,b)=>z.noCard?(p(),g("div",sl,[e("input",{ref_key:"fileInput",ref:v,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:E},null,544),e("button",{type:"button",onClick:T,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[n(o(ye),{class:"h-4 w-4"}),b[8]||(b[8]=e("span",null,"Upload Excel File",-1))]),A.value?(p(),g("div",ul,[...b[9]||(b[9]=[e("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):S("",!0),W.value.length>0?(p(),g("div",il,[e("div",dl,[e("div",rl,[n(o(he),{class:"h-5 w-5 text-green-500"}),b[10]||(b[10]=e("span",{class:"text-sm font-semibold text-gray-700"}," File uploaded ",-1))]),n(o(P),{size:"sm",variant:"outline",onClick:b[1]||(b[1]=m=>$("viewFile")),class:"flex items-center gap-2"},{default:u(()=>[n(o(we),{class:"h-4 w-4"}),b[11]||(b[11]=r(" View File ",-1))]),_:1})])])):S("",!0)])):(p(),K(o(Q),{key:0},{default:u(()=>[n(o(pe),null,{default:u(()=>[n(o(ge),null,{default:u(()=>[...b[2]||(b[2]=[r("Upload Excel File",-1)])]),_:1}),n(o(ze),null,{default:u(()=>[...b[3]||(b[3]=[r(" Upload an Excel file (.xlsx, .xls, or .csv) containing your data ",-1)])]),_:1})]),_:1}),n(o(ee),null,{default:u(()=>[e("div",ll,[e("input",{ref_key:"fileInput",ref:v,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:E},null,544),e("button",{type:"button",onClick:T,class:"w-full flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-md bg-white hover:bg-gray-50 text-gray-700 text-sm font-medium transition-colors cursor-pointer"},[n(o(ye),{class:"h-4 w-4"}),b[4]||(b[4]=e("span",null,"Upload Excel File",-1))]),A.value?(p(),g("div",tl,[...b[5]||(b[5]=[e("p",{class:"text-sm text-gray-600"},"Uploading and processing file...",-1)])])):S("",!0),W.value.length>0?(p(),g("div",ol,[e("div",nl,[e("div",al,[n(o(he),{class:"h-5 w-5 text-green-500"}),b[6]||(b[6]=e("span",{class:"text-sm font-semibold text-gray-700"}," File uploaded ",-1))]),n(o(P),{size:"sm",variant:"outline",onClick:b[0]||(b[0]=m=>$("viewFile")),class:"flex items-center gap-2"},{default:u(()=>[n(o(we),{class:"h-4 w-4"}),b[7]||(b[7]=r(" View File ",-1))]),_:1})])])):S("",!0)])]),_:1})]),_:1}))}}),ml={class:"h-[calc(100vh-4rem)] flex flex-col p-4 overflow-hidden"},fl={class:"flex items-center justify-between mb-4 flex-shrink-0"},pl={class:"flex items-center gap-4"},gl={class:"flex items-center gap-2"},xl={class:"flex items-center gap-1"},bl={class:"flex-1 flex gap-4 overflow-hidden min-h-0"},cl={class:"flex items-center justify-between mb-3"},yl={class:"space-y-4 py-4"},wl={class:"grid grid-cols-2 gap-2"},hl={class:"space-y-2"},Cl=["onClick"],kl={class:"flex items-center justify-between"},Fl={class:"flex flex-col"},Sl={class:"flex items-center gap-1 ml-2"},Al=["onClick"],$l=["onClick"],zl={key:0,class:"text-sm text-muted-foreground text-center py-4"},Vl={class:"border-t pt-4"},Dl={class:"space-y-4 py-4"},Ul={class:"grid grid-cols-2 gap-2"},Ml={class:"flex gap-2"},Pl={class:"flex-1 min-w-0 overflow-hidden"},Nl={class:"flex-1 overflow-auto"},Wl={key:0,class:"text-center py-8 text-gray-500"},El={key:1,class:"space-y-4"},Tl={class:"border rounded-lg overflow-hidden"},_l={class:"bg-white"},Ll={class:"aspect-[1/1.414] w-full",style:{"min-height":"600px"}},Rl=["src"],Hl={class:"flex justify-end gap-2 pt-4 border-t"},Il={class:"flex-1 overflow-auto"},jl={key:0,class:"text-center py-8 text-gray-500"},Bl={key:1,class:"border rounded-lg overflow-hidden"},Gl={class:"overflow-x-auto"},Xl={class:"w-full text-sm"},Yl={class:"bg-slate-700 sticky top-0 z-10 shadow-md"},Ol={class:"bg-white"},ql={class:"p-3 bg-gray-50 border-t text-sm text-gray-600 text-center"},Zl=210,Jl=297,ct=ce({__name:"Index",setup(se){const c=k({name:"",width:Zl,height:Jl,pages:[{id:"1",fields:[]}]}),C=k([]),$=k([]),A=k({}),v=k([]),W=k(!1),E=k(!1),T=k(!1),z=k(!1),b=k(!1),m=k(null),h=k(null),i=k({label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"}),_=k(0),V=G(()=>c.value.pages[_.value]||c.value.pages[0]),X=G(()=>c.value.pages.some(d=>d.fields.length>0)),J=G(()=>C.value.length>0),ve=()=>{if(c.value.pages.length>=10){alert("Maximum 10 pages allowed");return}const d=(c.value.pages.length+1).toString();c.value.pages.push({id:d,fields:[]}),_.value=c.value.pages.length-1,j(c.value)},me=d=>{if(c.value.pages.length<=1){alert("At least one page is required");return}c.value.pages.splice(d,1),_.value>=c.value.pages.length&&(_.value=c.value.pages.length-1),j(c.value),m.value=null},le=d=>{_.value=d,m.value=null},j=d=>{c.value={...d}},ue=d=>{C.value=d.data||[],$.value=d.columns||[];const l={};c.value.pages.forEach(a=>{a.fields.forEach(w=>{if(w.column){let F=$.value.find(Y=>Y.toLowerCase()===w.column.toLowerCase());F||(F=$.value.find(Y=>Y.toLowerCase()===w.label?.toLowerCase())),F||(F=$.value.find(Y=>Y.toLowerCase().includes(w.column.toLowerCase())||w.column.toLowerCase().includes(Y.toLowerCase()))),F&&(l[w.column]=F)}})}),A.value=l},fe=async()=>{if(!X.value){alert("Please create a template first");return}if(!J.value){alert("Please upload an Excel file first");return}const d=[];if(c.value.pages.forEach(l=>{l.fields.forEach(a=>{if(a.column&&!A.value[a.column]){const w=$.value.find(F=>F.toLowerCase()===a.column.toLowerCase()||F.toLowerCase()===a.label.toLowerCase());w?A.value[a.column]=w:d.push(a.label||a.column)}})}),d.length>0){alert(`Please map the following fields to Excel columns:
${d.join(", ")}

You can map them by matching field column names with Excel column names.`);return}if(Object.keys(A.value).length===0){alert("No column mappings found. Please ensure your field column names match Excel column names.");return}W.value=!0;try{const l=await Ce.post("/pdf-templates/generate",{template:c.value,excel_data:C.value,column_mapping:A.value});v.value=l.data.pdfs||[],v.value.length>0&&(E.value=!0)}catch(l){alert("Error generating PDFs: "+(l.response?.data?.message||l.message))}finally{W.value=!1}},R=d=>{const l=document.createElement("a");l.href=`data:application/pdf;base64,${d.base64}`,l.download=d.filename,document.body.appendChild(l),l.click(),document.body.removeChild(l)},ie=()=>{v.value.forEach(d=>{setTimeout(()=>{R(d)},100)})},H=G(()=>i.value.label?.trim()&&i.value.column?.trim()),f=()=>{if(!H.value)return;const d={id:Date.now().toString(),x:10,y:10,width:100,height:30,column:i.value.column.trim(),label:i.value.label.trim(),fontSize:i.value.fontSize||16,textAlign:i.value.textAlign||"left",fontFamily:i.value.fontFamily||"Arial",fontColor:i.value.fontColor||"#000000",fontWeight:i.value.fontWeight||"normal",fontStyle:i.value.fontStyle||"normal",textDecoration:i.value.textDecoration||"none"};V.value.fields.push(d),j(c.value),T.value=!1,i.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},m.value=d},t=d=>{const l=c.value.pages.find(a=>a.fields.some(w=>w.id===d));if(l){const a=l.fields.findIndex(w=>w.id===d);a>-1&&(l.fields.splice(a,1),j(c.value),m.value?.id===d&&(m.value=null))}},s=d=>{m.value=d},y=d=>{h.value=d,i.value={label:d.label,column:d.column,fontSize:d.fontSize,textAlign:d.textAlign,fontFamily:d.fontFamily||"Arial",fontColor:d.fontColor||"#000000",fontWeight:d.fontWeight||"normal",fontStyle:d.fontStyle||"normal",textDecoration:d.textDecoration||"none"},z.value=!0},I=()=>{if(!h.value)return;const d=c.value.pages.find(l=>l.fields.some(a=>a.id===h.value.id));if(d){const l=d.fields.find(a=>a.id===h.value.id);l&&(l.label=i.value.label.trim(),l.column=i.value.column.trim(),l.fontSize=i.value.fontSize||16,l.textAlign=i.value.textAlign||"left",l.fontFamily=i.value.fontFamily||"Arial",l.fontColor=i.value.fontColor||"#000000",l.fontWeight=i.value.fontWeight||"normal",l.fontStyle=i.value.fontStyle||"normal",l.textDecoration=i.value.textDecoration||"none",j(c.value),z.value=!1,h.value=null)}};return re(T,d=>{d&&(i.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})}),re(z,d=>{!d&&h.value===null&&(i.value={label:"",column:"",fontSize:16,textAlign:"left",fontFamily:"Arial",fontColor:"#000000",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"})}),(d,l)=>(p(),g(B,null,[n(o(Ae),{title:"PDF Template"}),n($e,null,{default:u(()=>[e("div",ml,[e("div",fl,[l[28]||(l[28]=e("div",null,[e("h1",{class:"text-2xl font-semibold"},"PDF Template")],-1)),e("div",pl,[e("div",gl,[n(o(x),{class:"text-sm whitespace-nowrap"},{default:u(()=>[...l[27]||(l[27]=[r("Page:",-1)])]),_:1}),e("div",xl,[(p(!0),g(B,null,q(c.value.pages,(a,w)=>(p(),K(o(P),{key:a.id,size:"sm",variant:"outline",class:Z(_.value===w?"bg-blue-500 text-white border-blue-500":""),onClick:F=>le(w)},{default:u(()=>[r(L(w+1),1)]),_:2},1032,["class","onClick"]))),128)),c.value.pages.length<10?(p(),K(o(P),{key:0,size:"sm",variant:"outline",onClick:ve,title:"Add Page"},{default:u(()=>[n(o(xe),{class:"h-4 w-4"})]),_:1})):S("",!0),c.value.pages.length>1?(p(),K(o(P),{key:1,size:"sm",variant:"outline",onClick:l[0]||(l[0]=a=>me(_.value)),title:"Delete Current Page"},{default:u(()=>[n(o(be),{class:"h-4 w-4"})]),_:1})):S("",!0)])]),n(o(P),{onClick:fe,disabled:!X.value||!J.value||W.value},{default:u(()=>[r(L(W.value?"Generatingâ€¦":"Generate & Preview"),1)]),_:1},8,["disabled"])])]),e("div",bl,[n(o(Q),{class:"w-80 flex-shrink-0 flex flex-col overflow-hidden"},{default:u(()=>[n(o(ee),{class:"flex-1 overflow-auto min-h-0 space-y-6"},{default:u(()=>[e("div",null,[e("div",cl,[n(o(x),{class:"text-base font-semibold"},{default:u(()=>[...l[29]||(l[29]=[r("Fields",-1)])]),_:1}),n(o(te),{open:T.value,"onUpdate:open":l[10]||(l[10]=a=>T.value=a)},{default:u(()=>[n(o(ke),{"as-child":""},{default:u(()=>[n(o(P),{size:"sm"},{default:u(()=>[n(o(xe),{class:"mr-2 h-4 w-4"}),l[30]||(l[30]=r(" Add Field ",-1))]),_:1})]),_:1}),n(o(oe),null,{default:u(()=>[n(o(ne),null,{default:u(()=>[n(o(ae),null,{default:u(()=>[...l[31]||(l[31]=[r("Add Field",-1)])]),_:1})]),_:1}),e("div",yl,[e("div",null,[n(o(x),null,{default:u(()=>[...l[32]||(l[32]=[r("Label",-1)])]),_:1}),n(o(N),{modelValue:i.value.label,"onUpdate:modelValue":l[1]||(l[1]=a=>i.value.label=a),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[33]||(l[33]=[r("Column Name",-1)])]),_:1}),n(o(N),{modelValue:i.value.column,"onUpdate:modelValue":l[2]||(l[2]=a=>i.value.column=a),placeholder:"e.g., name"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[34]||(l[34]=[r("Font Size",-1)])]),_:1}),n(o(N),{modelValue:i.value.fontSize,"onUpdate:modelValue":l[3]||(l[3]=a=>i.value.fontSize=a),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[35]||(l[35]=[r("Text Align",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[4]||(l[4]=a=>i.value.textAlign=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[36]||(l[36]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],512),[[M,i.value.textAlign]])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[37]||(l[37]=[r("Font Family",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[5]||(l[5]=a=>i.value.fontFamily=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[38]||(l[38]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[M,i.value.fontFamily]])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[39]||(l[39]=[r("Font Color",-1)])]),_:1}),n(o(N),{modelValue:i.value.fontColor,"onUpdate:modelValue":l[6]||(l[6]=a=>i.value.fontColor=a),type:"color",class:"h-10"},null,8,["modelValue"])]),e("div",wl,[e("div",null,[n(o(x),null,{default:u(()=>[...l[40]||(l[40]=[r("Font Weight",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[7]||(l[7]=a=>i.value.fontWeight=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[41]||(l[41]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],512),[[M,i.value.fontWeight]])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[42]||(l[42]=[r("Font Style",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[8]||(l[8]=a=>i.value.fontStyle=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[43]||(l[43]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],512),[[M,i.value.fontStyle]])])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[44]||(l[44]=[r("Text Decoration",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[9]||(l[9]=a=>i.value.textDecoration=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[45]||(l[45]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],512),[[M,i.value.textDecoration]])]),n(o(P),{onClick:f,class:"w-full",disabled:!H.value},{default:u(()=>[...l[46]||(l[46]=[r(" Add Field ",-1)])]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),e("div",hl,[(p(!0),g(B,null,q(V.value.fields,a=>(p(),g("div",{key:a.id,class:Z(["group p-2 border rounded cursor-pointer transition-colors",m.value?.id===a.id?"border-blue-500 bg-blue-100":"border-gray-200 hover:bg-gray-50"]),onClick:w=>s(a)},[e("div",kl,[e("div",Fl,[e("span",{class:Z(["text-sm font-semibold transition-colors",m.value?.id===a.id?"text-blue-700":"text-white group-hover:text-blue-600"])},L(a.label||a.column),3),a.label&&a.column?(p(),g("span",{key:0,class:Z(["text-xs mt-0.5 transition-colors",m.value?.id===a.id?"text-gray-500":"text-gray-300 group-hover:text-black"])}," Column: "+L(a.column),3)):S("",!0)]),e("div",Sl,[e("button",{onClick:D(w=>y(a),["stop"]),class:"text-blue-500 hover:text-blue-700 p-1",title:"Edit field"},[n(o(Ve),{class:"h-4 w-4"})],8,Al),e("button",{onClick:D(w=>t(a.id),["stop"]),class:"text-red-500 hover:text-red-700 p-1",title:"Delete field"},[n(o(be),{class:"h-4 w-4"})],8,$l)])])],10,Cl))),128)),V.value.fields.length===0?(p(),g("p",zl,' No fields yet. Click "Add Field" to create one. ')):S("",!0)])]),e("div",Vl,[n(o(x),{class:"text-base font-semibold mb-3 block"},{default:u(()=>[...l[47]||(l[47]=[r("Upload Excel",-1)])]),_:1}),n(vl,{onUploaded:ue,"excel-data":C.value,"no-card":!0,onViewFile:l[11]||(l[11]=a=>b.value=!0)},null,8,["excel-data"])])]),_:1})]),_:1}),n(o(te),{open:z.value,"onUpdate:open":l[22]||(l[22]=a=>z.value=a)},{default:u(()=>[n(o(oe),null,{default:u(()=>[n(o(ne),null,{default:u(()=>[n(o(ae),null,{default:u(()=>[...l[48]||(l[48]=[r("Edit Field",-1)])]),_:1})]),_:1}),e("div",Dl,[e("div",null,[n(o(x),null,{default:u(()=>[...l[49]||(l[49]=[r("Label",-1)])]),_:1}),n(o(N),{modelValue:i.value.label,"onUpdate:modelValue":l[12]||(l[12]=a=>i.value.label=a),placeholder:"e.g., Guest Name"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[50]||(l[50]=[r("Column Name",-1)])]),_:1}),n(o(N),{modelValue:i.value.column,"onUpdate:modelValue":l[13]||(l[13]=a=>i.value.column=a),placeholder:"e.g., name"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[51]||(l[51]=[r("Font Size",-1)])]),_:1}),n(o(N),{modelValue:i.value.fontSize,"onUpdate:modelValue":l[14]||(l[14]=a=>i.value.fontSize=a),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[52]||(l[52]=[r("Text Align",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[15]||(l[15]=a=>i.value.textAlign=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[53]||(l[53]=[e("option",{value:"left"},"Left",-1),e("option",{value:"center"},"Center",-1),e("option",{value:"right"},"Right",-1)])],512),[[M,i.value.textAlign]])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[54]||(l[54]=[r("Font Family",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[16]||(l[16]=a=>i.value.fontFamily=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[55]||(l[55]=[e("option",{value:"Arial"},"Arial",-1),e("option",{value:"Times New Roman"},"Times New Roman",-1),e("option",{value:"Courier New"},"Courier New",-1),e("option",{value:"Helvetica"},"Helvetica",-1),e("option",{value:"Georgia"},"Georgia",-1),e("option",{value:"Verdana"},"Verdana",-1),e("option",{value:"Comic Sans MS"},"Comic Sans MS",-1)])],512),[[M,i.value.fontFamily]])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[56]||(l[56]=[r("Font Color",-1)])]),_:1}),n(o(N),{modelValue:i.value.fontColor,"onUpdate:modelValue":l[17]||(l[17]=a=>i.value.fontColor=a),type:"color",class:"h-10"},null,8,["modelValue"])]),e("div",Ul,[e("div",null,[n(o(x),null,{default:u(()=>[...l[57]||(l[57]=[r("Font Weight",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[18]||(l[18]=a=>i.value.fontWeight=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[58]||(l[58]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"bold"},"Bold",-1)])],512),[[M,i.value.fontWeight]])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[59]||(l[59]=[r("Font Style",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[19]||(l[19]=a=>i.value.fontStyle=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[60]||(l[60]=[e("option",{value:"normal"},"Normal",-1),e("option",{value:"italic"},"Italic",-1)])],512),[[M,i.value.fontStyle]])])]),e("div",null,[n(o(x),null,{default:u(()=>[...l[61]||(l[61]=[r("Text Decoration",-1)])]),_:1}),U(e("select",{"onUpdate:modelValue":l[20]||(l[20]=a=>i.value.textDecoration=a),class:"w-full rounded-md border border-input bg-background px-3 py-2"},[...l[62]||(l[62]=[e("option",{value:"none"},"None",-1),e("option",{value:"underline"},"Underline",-1)])],512),[[M,i.value.textDecoration]])]),e("div",Ml,[n(o(P),{onClick:I,class:"flex-1",disabled:!i.value.label?.trim()||!i.value.column?.trim()},{default:u(()=>[...l[63]||(l[63]=[r(" Update Field ",-1)])]),_:1},8,["disabled"]),n(o(P),{variant:"outline",onClick:l[21]||(l[21]=()=>{z.value=!1,h.value=null}),class:"flex-1"},{default:u(()=>[...l[64]||(l[64]=[r(" Cancel ",-1)])]),_:1})])])]),_:1})]),_:1},8,["open"]),e("div",Pl,[n(el,{template:{name:c.value.name,width:c.value.width,height:c.value.height,fields:V.value.fields},"show-only-canvas":!0,"selected-field-id":m.value?.id||null,onUpdate:l[23]||(l[23]=a=>{V.value.fields=a.fields,j(c.value)}),onFieldSelected:s},null,8,["template","selected-field-id"])])])]),n(o(te),{open:E.value,"onUpdate:open":l[25]||(l[25]=a=>E.value=a)},{default:u(()=>[n(o(oe),{class:"!w-[80vw] !max-w-[80vw] max-h-[90vh] overflow-hidden flex flex-col mx-auto"},{default:u(()=>[n(o(ne),null,{default:u(()=>[n(o(ae),null,{default:u(()=>[...l[65]||(l[65]=[r("PDF Preview",-1)])]),_:1})]),_:1}),e("div",Nl,[v.value.length===0?(p(),g("div",Wl," No PDFs generated yet. ")):(p(),g("div",El,[e("div",Tl,[e("div",_l,[e("div",Ll,[e("iframe",{src:`data:application/pdf;base64,${v.value[0].base64}`,class:"w-full h-full border-0"},null,8,Rl)])])])]))]),e("div",Hl,[n(o(P),{variant:"outline",onClick:l[24]||(l[24]=a=>E.value=!1)},{default:u(()=>[...l[66]||(l[66]=[r(" Close ",-1)])]),_:1}),v.value.length>0?(p(),K(o(P),{key:0,onClick:ie},{default:u(()=>[r(" Download All PDFs ("+L(v.value.length)+") ",1)]),_:1})):S("",!0)])]),_:1})]),_:1},8,["open"]),n(o(te),{open:b.value,"onUpdate:open":l[26]||(l[26]=a=>b.value=a)},{default:u(()=>[n(o(oe),{class:"!w-[80vw] !max-w-[80vw] max-h-[90vh] overflow-hidden flex flex-col mx-auto"},{default:u(()=>[n(o(ne),null,{default:u(()=>[n(o(ae),null,{default:u(()=>[...l[67]||(l[67]=[r("Excel File Data",-1)])]),_:1})]),_:1}),e("div",Il,[C.value.length===0?(p(),g("div",jl," No Excel data available. ")):(p(),g("div",Bl,[e("div",Gl,[e("table",Xl,[e("thead",Yl,[e("tr",null,[(p(!0),g(B,null,q($.value,(a,w)=>(p(),g("th",{key:w,class:"px-4 py-3 text-left font-bold border-b border-slate-600 text-white uppercase tracking-wide"},L(a),1))),128))])]),e("tbody",Ol,[(p(!0),g(B,null,q(C.value,(a,w)=>(p(),g("tr",{key:w,class:"border-b border-gray-200 hover:bg-blue-50 transition-colors"},[(p(!0),g(B,null,q($.value,(F,Y)=>(p(),g("td",{key:Y,class:"px-4 py-2 text-gray-800 font-medium"},L(a[F]),1))),128))]))),128))])])]),e("div",ql," Total rows: "+L(C.value.length),1)]))])]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ct as default};
