import{d as me,p as S,c as K,a as P,o as _,b as $,f as n,e as B,h as ve,g as ee,k as te,F as re,r as ue,t as L,y as be,n as D,D as xe,E as we}from"./app-DT7a5EHS.js";import{S as q}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{T as ke,U as Pe}from"./upload-RxytHB1t.js";import{I as de,X as _e}from"./x-BG1mH9nC.js";import{c as ye}from"./createLucideIcon-Do8d3b6c.js";import{P as Se}from"./plus-BqdG-YKh.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=ye("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=ye("MinusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var pe={exports:{}},fe;function Ue(){return fe||(fe=1,(function(oe){(function(x){var y=se(),M=le(),X=b(),Y=ce(),W={imagePlaceholder:void 0,cacheBust:!1},w={toSvg:z,toPng:ae,toJpeg:Z,toBlob:N,toPixelData:he,impl:{fontFaces:X,images:Y,util:y,inliner:M,options:{}}};oe.exports=w;function z(i,a){return a=a||{},G(a),Promise.resolve(i).then(function(c){return O(c,a.filter,!0)}).then(Q).then(ne).then(s).then(function(c){return ie(c,a.width||y.width(i),a.height||y.height(i))});function s(c){return a.bgcolor&&(c.style.backgroundColor=a.bgcolor),a.width&&(c.style.width=a.width+"px"),a.height&&(c.style.height=a.height+"px"),a.style&&Object.keys(a.style).forEach(function(h){c.style[h]=a.style[h]}),c}}function he(i,a){return j(i,a||{}).then(function(s){return s.getContext("2d").getImageData(0,0,y.width(i),y.height(i)).data})}function ae(i,a){return j(i,a||{}).then(function(s){return s.toDataURL()})}function Z(i,a){return a=a||{},j(i,a).then(function(s){return s.toDataURL("image/jpeg",a.quality||1)})}function N(i,a){return j(i,a||{}).then(y.canvasToBlob)}function G(i){typeof i.imagePlaceholder>"u"?w.impl.options.imagePlaceholder=W.imagePlaceholder:w.impl.options.imagePlaceholder=i.imagePlaceholder,typeof i.cacheBust>"u"?w.impl.options.cacheBust=W.cacheBust:w.impl.options.cacheBust=i.cacheBust}function j(i,a){return z(i,a).then(y.makeImage).then(y.delay(100)).then(function(c){var h=s(i);return h.getContext("2d").drawImage(c,0,0),h});function s(c){var h=document.createElement("canvas");if(h.width=a.width||y.width(c),h.height=a.height||y.height(c),a.bgcolor){var g=h.getContext("2d");g.fillStyle=a.bgcolor,g.fillRect(0,0,h.width,h.height)}return h}}function O(i,a,s){if(!s&&a&&!a(i))return Promise.resolve();return Promise.resolve(i).then(c).then(function(l){return h(i,l,a)}).then(function(l){return g(i,l)});function c(l){return l instanceof HTMLCanvasElement?y.makeImage(l.toDataURL()):l.cloneNode(!1)}function h(l,p,C){var r=l.childNodes;if(r.length===0)return Promise.resolve(p);return t(p,y.asArray(r),C).then(function(){return p});function t(e,u,m){var U=Promise.resolve();return u.forEach(function(A){U=U.then(function(){return O(A,m)}).then(function(I){I&&e.appendChild(I)})}),U}}function g(l,p){if(!(p instanceof Element))return p;return Promise.resolve().then(C).then(r).then(t).then(e).then(function(){return p});function C(){u(window.getComputedStyle(l),p.style);function u(m,U){m.cssText?U.cssText=m.cssText:A(m,U);function A(I,E){y.asArray(I).forEach(function(o){E.setProperty(o,I.getPropertyValue(o),I.getPropertyPriority(o))})}}}function r(){[":before",":after"].forEach(function(m){u(m)});function u(m){var U=window.getComputedStyle(l,m),A=U.getPropertyValue("content");if(A===""||A==="none")return;var I=y.uid();p.className=p.className+" "+I;var E=document.createElement("style");E.appendChild(o(I,m,U)),p.appendChild(E);function o(d,f,v){var k="."+d+":"+f,T=v.cssText?V(v):H(v);return document.createTextNode(k+"{"+T+"}");function V(R){var F=R.getPropertyValue("content");return R.cssText+" content: "+F+";"}function H(R){return y.asArray(R).map(F).join("; ")+";";function F(J){return J+": "+R.getPropertyValue(J)+(R.getPropertyPriority(J)?" !important":"")}}}}}function t(){l instanceof HTMLTextAreaElement&&(p.innerHTML=l.value),l instanceof HTMLInputElement&&p.setAttribute("value",l.value)}function e(){p instanceof SVGElement&&(p.setAttribute("xmlns","http://www.w3.org/2000/svg"),p instanceof SVGRectElement&&["width","height"].forEach(function(u){var m=p.getAttribute(u);m&&p.style.setProperty(u,m)}))}}}function Q(i){return X.resolveAll().then(function(a){var s=document.createElement("style");return i.appendChild(s),s.appendChild(document.createTextNode(a)),i})}function ne(i){return Y.inlineAll(i).then(function(){return i})}function ie(i,a,s){return Promise.resolve(i).then(function(c){return c.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(c)}).then(y.escapeXhtml).then(function(c){return'<foreignObject x="0" y="0" width="100%" height="100%">'+c+"</foreignObject>"}).then(function(c){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+a+'" height="'+s+'">'+c+"</svg>"}).then(function(c){return"data:image/svg+xml;charset=utf-8,"+c})}function se(){return{escape:e,parseExtension:a,mimeType:s,dataAsUrl:t,isDataUrl:c,canvasToBlob:g,resolveUrl:l,getAndEncode:r,uid:p(),delay:u,asArray:m,escapeXhtml:U,makeImage:C,width:A,height:I};function i(){var o="application/font-woff",d="image/jpeg";return{woff:o,woff2:o,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:d,jpeg:d,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function a(o){var d=/\.([^\.\/]*?)$/g.exec(o);return d?d[1]:""}function s(o){var d=a(o).toLowerCase();return i()[d]||""}function c(o){return o.search(/^(data:)/)!==-1}function h(o){return new Promise(function(d){for(var f=window.atob(o.toDataURL().split(",")[1]),v=f.length,k=new Uint8Array(v),T=0;T<v;T++)k[T]=f.charCodeAt(T);d(new Blob([k],{type:"image/png"}))})}function g(o){return o.toBlob?new Promise(function(d){o.toBlob(d)}):h(o)}function l(o,d){var f=document.implementation.createHTMLDocument(),v=f.createElement("base");f.head.appendChild(v);var k=f.createElement("a");return f.body.appendChild(k),v.href=d,k.href=o,k.href}function p(){var o=0;return function(){return"u"+d()+o++;function d(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function C(o){return new Promise(function(d,f){var v=new Image;v.onload=function(){d(v)},v.onerror=f,v.src=o})}function r(o){var d=3e4;return w.impl.options.cacheBust&&(o+=(/\?/.test(o)?"&":"?")+new Date().getTime()),new Promise(function(f){var v=new XMLHttpRequest;v.onreadystatechange=V,v.ontimeout=H,v.responseType="blob",v.timeout=d,v.open("GET",o,!0),v.send();var k;if(w.impl.options.imagePlaceholder){var T=w.impl.options.imagePlaceholder.split(/,/);T&&T[1]&&(k=T[1])}function V(){if(v.readyState===4){if(v.status!==200){k?f(k):R("cannot fetch resource: "+o+", status: "+v.status);return}var F=new FileReader;F.onloadend=function(){var J=F.result.split(/,/)[1];f(J)},F.readAsDataURL(v.response)}}function H(){k?f(k):R("timeout of "+d+"ms occured while fetching resource: "+o)}function R(F){console.error(F),f("")}})}function t(o,d){return"data:"+d+";base64,"+o}function e(o){return o.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function u(o){return function(d){return new Promise(function(f){setTimeout(function(){f(d)},o)})}}function m(o){for(var d=[],f=o.length,v=0;v<f;v++)d.push(o[v]);return d}function U(o){return o.replace(/#/g,"%23").replace(/\n/g,"%0A")}function A(o){var d=E(o,"border-left-width"),f=E(o,"border-right-width");return o.scrollWidth+d+f}function I(o){var d=E(o,"border-top-width"),f=E(o,"border-bottom-width");return o.scrollHeight+d+f}function E(o,d){var f=window.getComputedStyle(o).getPropertyValue(d);return parseFloat(f.replace("px",""))}}function le(){var i=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:h,shouldProcess:a,impl:{readUrls:s,inline:c}};function a(g){return g.search(i)!==-1}function s(g){for(var l=[],p;(p=i.exec(g))!==null;)l.push(p[1]);return l.filter(function(C){return!y.isDataUrl(C)})}function c(g,l,p,C){return Promise.resolve(l).then(function(t){return p?y.resolveUrl(t,p):t}).then(C||y.getAndEncode).then(function(t){return y.dataAsUrl(t,y.mimeType(l))}).then(function(t){return g.replace(r(l),"$1"+t+"$3")});function r(t){return new RegExp(`(url\\(['"]?)(`+y.escape(t)+`)(['"]?\\))`,"g")}}function h(g,l,p){if(C())return Promise.resolve(g);return Promise.resolve(g).then(s).then(function(r){var t=Promise.resolve(g);return r.forEach(function(e){t=t.then(function(u){return c(u,e,l,p)})}),t});function C(){return!a(g)}}}function b(){return{resolveAll:i,impl:{readAll:a}};function i(){return a().then(function(s){return Promise.all(s.map(function(c){return c.resolve()}))}).then(function(s){return s.join(`
`)})}function a(){return Promise.resolve(y.asArray(document.styleSheets)).then(c).then(s).then(function(g){return g.map(h)});function s(g){return g.filter(function(l){return l.type===CSSRule.FONT_FACE_RULE}).filter(function(l){return M.shouldProcess(l.style.getPropertyValue("src"))})}function c(g){var l=[];return g.forEach(function(p){try{y.asArray(p.cssRules||[]).forEach(l.push.bind(l))}catch(C){console.log("Error while reading CSS rules from "+p.href,C.toString())}}),l}function h(g){return{resolve:function(){var p=(g.parentStyleSheet||{}).href;return M.inlineAll(g.cssText,p)},src:function(){return g.style.getPropertyValue("src")}}}}}function ce(){return{inlineAll:a,impl:{newImage:i}};function i(s){return{inline:c};function c(h){return y.isDataUrl(s.src)?Promise.resolve():Promise.resolve(s.src).then(h||y.getAndEncode).then(function(g){return y.dataAsUrl(g,y.mimeType(s.src))}).then(function(g){return new Promise(function(l,p){s.onload=l,s.onerror=p,s.src=g})})}}function a(s){if(!(s instanceof Element))return Promise.resolve(s);return c(s).then(function(){return s instanceof HTMLImageElement?i(s).inline():Promise.all(y.asArray(s.childNodes).map(function(h){return a(h)}))});function c(h){var g=h.style.getPropertyValue("background");return g?M.inlineAll(g).then(function(l){h.style.setProperty("background",l,h.style.getPropertyPriority("background"))}).then(function(){return h}):Promise.resolve(h)}}}})()})(pe)),pe.exports}var ge=Ue();const Ie={class:"mx-auto px-4 py-6 sm:px-6 lg:px-8"},Te={class:"grid gap-6 lg:grid-cols-4"},Ae={class:"lg:col-span-1"},$e={class:"space-y-4 max-h-[calc(100vh-2rem)] overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600"},Be={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},De={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Me={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Re={class:"p-4 space-y-4"},Fe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},We=["onUpdate:modelValue","placeholder"],je={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Oe={class:"p-4 border-b border-gray-200 dark:border-gray-700"},He={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Xe={class:"p-4"},ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Le={class:"space-y-2"},Ye=["id","onChange"],Ne={key:0},Ve=["for"],qe={class:"flex flex-col items-center justify-center py-3"},Ge={key:1,class:"relative group"},Je=["src","alt"],Ke=["onClick"],Ze={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Qe={class:"p-4 border-b border-gray-200 dark:border-gray-700"},et={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},tt={class:"p-4 space-y-4"},rt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ot={class:"flex items-center gap-3"},at=["disabled"],nt={class:"flex-1"},it=["value"],st=["disabled"],lt={class:"lg:col-span-3"},ct={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},ut={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},dt={class:"text-lg font-semibold text-gray-900 dark:text-white"},pt=["disabled"],gt={class:"p-4"},ht={class:"flex justify-center items-start min-h-[400px]"},ft={class:"relative",style:{margin:"20px 0"}},yt=["onMousedown"],mt=["onMousedown"],vt=["src","alt","onClick","onMousedown"],bt={key:1,class:"flex items-center justify-center text-gray-400 bg-gray-50 dark:bg-gray-800/50 w-full h-full"},Ct=me({__name:"Share",props:{template:{}},setup(oe){const x=oe,y=S(null),M=S(!1);S(!1),S("");const X=S(null);S(.62),S(0),S(0),S(1);const Y=S(!1),W=S({x:0,y:0,posX:0,posY:0}),w=S(null),z=S([]);(()=>{let r;if(Array.isArray(x.template.canvas_data))r=x.template.canvas_data;else if(typeof x.template.canvas_data=="string")try{r=JSON.parse(x.template.canvas_data)}catch{r=[]}else r=[];r.filter(e=>e.type==="image").length>0,z.value=r.map(e=>({...e,properties:{text:e.properties?.text||"",fontSize:e.properties?.fontSize||16,fontFamily:e.properties?.fontFamily||"Arial",fontWeight:e.properties?.fontWeight||"normal",fontStyle:e.properties?.fontStyle||"normal",textDecoration:e.properties?.textDecoration||"none",textAlign:e.properties?.textAlign||"left",lineHeight:e.properties?.lineHeight||1.2,color:e.properties?.color||"#000000",backgroundColor:e.properties?.backgroundColor||(e.type==="text"?"transparent":"#f3f4f6"),hasBorder:e.properties?.hasBorder||!1,borderWidth:e.properties?.borderWidth||1,borderColor:e.properties?.borderColor||"#000000",borderStyle:e.properties?.borderStyle||"solid",borderRadius:e.properties?.borderRadius||0,boxShadow:e.properties?.boxShadow||"none",textShadow:e.properties?.textShadow||"none",imageUrl:e.properties?.imageUrl||"",imageFit:e.properties?.imageFit||"cover",imagePlaceholder:e.properties?.imagePlaceholder||(e.type==="image",""),imageShape:e.properties?.imageShape||"rectangle"}}))})();const ae=K(()=>[...z.value].sort((r,t)=>r.zIndex-t.zIndex)),Z=K(()=>z.value.filter(r=>r.type==="text")),N=K(()=>z.value.filter(r=>r.type==="image")),G=S(!1),j=S({x:0,y:0}),O=S(null),Q=(r,t)=>{y.value=t,t.type!=="image"&&(w.value=null),t.type==="text"&&(r.preventDefault(),G.value=!0,j.value={x:r.clientX-t.x*b.value,y:r.clientY-t.y*b.value},O.value=t)},ne=r=>{G.value&&O.value&&(O.value.x=(r.clientX-j.value.x)/b.value,O.value.y=(r.clientY-j.value.y)/b.value)},ie=r=>{G.value=!1,O.value=null},se=r=>{switch(r){case"circle":return"circle(50% at 50% 50%)";case"triangle":return"polygon(50% 0%, 0% 100%, 100% 100%)";case"star":return"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)";case"diamond":return"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)";case"hexagon":return"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)";case"octagon":return"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)";case"rectangle":default:return"none"}},le=K(()=>{const e=800/x.template.width,u=600/x.template.height,m=Math.min(e,u,1),U=x.template.width*m,A=x.template.height*m;return{width:U+"px",height:A+"px",transform:"none",backgroundImage:x.template.background_image_url?`url(${x.template.background_image_url})`:x.template.background_image?`url(/storage/${x.template.background_image})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",position:"relative"}}),b=K(()=>{const e=800/x.template.width,u=600/x.template.height;return Math.min(e,u,1)}),ce=(r,t)=>{const e=r.target.files?.[0];if(!e)return;if(!e.type.startsWith("image/")){alert("Please select a valid image file.");return}if(e.size>10*1024*1024){alert("File size must be less than 10MB.");return}const u=URL.createObjectURL(e);t.properties.imageUrl=u,t.properties.cropScale||(t.properties.cropScale=.62),t.properties.cropPositionX||(t.properties.cropPositionX=0),t.properties.cropPositionY||(t.properties.cropPositionY=0),t.uploadedFile=e},i=r=>{const t=r.properties.cropScale||1,e=Math.min(t+.1,3);r.properties.cropScale=e},a=r=>{const t=r.properties.cropScale||1,e=Math.max(t-.1,.5);r.properties.cropScale=e},s=(r,t)=>{r.properties.cropScale=Math.max(.5,Math.min(3,t))},c=(r,t)=>{r.stopPropagation(),w.value=t},h=(r,t)=>{r.stopPropagation(),Y.value=!0,X.value=t,w.value=t,W.value={x:r.clientX,y:r.clientY,posX:t.properties.cropPositionX||0,posY:t.properties.cropPositionY||0}},g=r=>{if(!Y.value||!X.value)return;const t=r.clientX-W.value.x,e=r.clientY-W.value.y,u=W.value.posX+t/b.value,m=W.value.posY+e/b.value;X.value.properties.cropPositionX=u,X.value.properties.cropPositionY=m},l=()=>{Y.value=!1},p=r=>{r.properties.imageUrl&&r.properties.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(r.properties.imageUrl),r.properties.imageUrl="",r.uploadedFile=null},C=async()=>{M.value=!0,q.fire({title:"Generating Image...",text:"Please wait while we create your image.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{q.showLoading()}});try{const r=document.querySelector(".template-preview-container");if(!r)throw new Error("Preview container not found");await(async()=>{const o=r.querySelectorAll("img"),d=Array.from(o).map(async(f,v)=>{if(f.src.startsWith("blob:"))try{const k=await fetch(f.src);if(!k.ok)throw new Error(`HTTP ${k.status}: ${k.statusText}`);const T=await k.blob();return new Promise(V=>{const H=new FileReader;H.onload=()=>{f.src=H.result,V(!0)},H.onerror=()=>{V(!1)},H.readAsDataURL(T)})}catch{return!1}else return!0});await Promise.all(d)})();let e;const u=x.template.width*b.value,m=x.template.height*b.value,U=x.template.width,A=x.template.height;try{const d=u*4,f=m*4;e=await ge.toPng(r,{quality:1,bgcolor:"#ffffff",width:d,height:f,style:{transform:"scale(4)",transformOrigin:"top left",width:u+"px",height:m+"px",imageRendering:"crisp-edges"},pixelRatio:4,cacheBust:!0,filter:v=>!0,useCORS:!0,allowTaint:!0})}catch{try{e=await ge.toPng(r,{quality:1,bgcolor:"#ffffff",width:u*2,height:m*2,style:{transform:"scale(2)",transformOrigin:"top left",width:u+"px",height:m+"px"},pixelRatio:3,cacheBust:!0,useCORS:!0})}catch{e=await ge.toPng(r,{quality:1,bgcolor:"#ffffff",width:u,height:m,pixelRatio:2,cacheBust:!0})}}const I=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),E=document.createElement("a");E.href=e,E.download=`${x.template.name}_${I}.png`,document.body.appendChild(E),E.click(),document.body.removeChild(E);try{const o=await fetch(`/template/${x.template.share_token}/track-download`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json"},body:JSON.stringify({file_name:`${x.template.name}_${I}.png`,file_size:e.length})})}catch{}q.close(),q.fire({icon:"success",title:"Download Complete!",text:"Your image has been downloaded successfully.",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(r){q.close();let t="Unknown error occurred while generating image.";r.message?t=r.message:r.name==="SecurityError"?t="Security error: Cannot access the preview element. Please try refreshing the page.":r.name==="InvalidStateError"?t="Invalid state error: The preview element may not be ready. Please try again.":r.toString().includes("canvas")&&(t="Canvas rendering error: Please check if all images are loaded and try again."),q.fire({icon:"error",title:"Download Failed",text:t,confirmButtonText:"Try Again"})}finally{M.value=!1}};return(r,t)=>(_(),P(re,null,[$(B(ve),{title:r.template.name},null,8,["title"]),n("div",{class:"min-h-screen bg-gray-50 dark:bg-gray-900",onMouseup:l,onMousemove:g},[n("div",Ie,[n("div",Te,[n("div",Ae,[n("div",$e,[Z.value.length>0?(_(),P("div",Be,[n("div",De,[n("h2",Me,[$(B(ke),{class:"h-5 w-5"}),t[3]||(t[3]=te(" Text Content ",-1))])]),n("div",Re,[(_(!0),P(re,null,ue(Z.value,(e,u)=>(_(),P("div",{key:e.id,class:"space-y-2"},[n("label",Fe," Text "+L(u+1),1),xe(n("textarea",{"onUpdate:modelValue":m=>e.properties.text=m,rows:"2",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors text-sm",placeholder:`Enter text ${u+1}`},null,8,We),[[we,e.properties.text]])]))),128))])])):ee("",!0),N.value.length>0?(_(),P("div",je,[n("div",Oe,[n("h2",He,[$(B(de),{class:"h-5 w-5"}),te(" Image Upload ("+L(N.value.length)+") ",1)])]),n("div",Xe,[n("div",{class:be(["grid gap-3",N.value.length>3?"grid-cols-2":"grid-cols-1"])},[(_(!0),P(re,null,ue(N.value,(e,u)=>(_(),P("div",{key:e.id,class:"space-y-2"},[n("label",ze," Image "+L(u+1),1),n("div",Le,[n("input",{id:`image-${e.id}`,type:"file",accept:"image/*",onChange:m=>ce(m,e),class:"hidden"},null,40,Ye),e.properties.imageUrl?(_(),P("div",Ge,[n("img",{src:e.properties.imageUrl,alt:`Image ${u+1}`,class:"w-full h-20 object-cover rounded-lg border border-gray-300 dark:border-gray-600"},null,8,Je),n("button",{type:"button",onClick:m=>p(e),class:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100"},[$(B(_e),{class:"w-3 h-3"})],8,Ke)])):(_(),P("div",Ne,[n("label",{for:`image-${e.id}`,class:"flex flex-col items-center justify-center w-full h-20 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"},[n("div",qe,[$(B(Pe),{class:"w-5 h-5 mb-1 text-gray-500 dark:text-gray-400"}),t[4]||(t[4]=n("p",{class:"text-xs text-gray-500 dark:text-gray-400"},[n("span",{class:"font-semibold"},"Upload")],-1))])],8,Ve)]))])]))),128))],2)])])):ee("",!0),w.value&&w.value.properties.imageUrl?(_(),P("div",Ze,[n("div",Qe,[n("h2",et,[$(B(de),{class:"h-5 w-5"}),t[5]||(t[5]=te(" Image Controls ",-1))])]),n("div",tt,[n("div",null,[n("label",rt," Zoom: "+L(Math.round((w.value.properties.cropScale||1)*100))+"% ",1),n("div",ot,[n("button",{onClick:t[0]||(t[0]=e=>a(w.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",disabled:(w.value.properties.cropScale||1)<=.5},[$(B(Ee),{class:"w-4 h-4"})],8,at),n("div",nt,[n("input",{type:"range",value:w.value.properties.cropScale||1,onInput:t[1]||(t[1]=e=>s(w.value,parseFloat(e.target.value))),min:"0.5",max:"3",step:"0.1",class:"w-full"},null,40,it)]),n("button",{onClick:t[2]||(t[2]=e=>i(w.value)),class:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",disabled:(w.value.properties.cropScale||1)>=3},[$(B(Se),{class:"w-4 h-4"})],8,st)])]),t[6]||(t[6]=n("div",{class:"text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg"},[n("p",{class:"font-medium mb-1"},"How to use:"),n("ul",{class:"space-y-1"},[n("li",null,"• Click and drag the image to position it"),n("li",null,"• Use zoom controls to adjust the size"),n("li",null,"• The image will be cropped to the shape")])],-1))])])):ee("",!0)])]),n("div",lt,[n("div",ct,[n("div",ut,[n("h2",dt,L(r.template.name),1),n("button",{onClick:C,disabled:M.value,class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"},[$(B(Ce),{class:"h-4 w-4"}),te(" "+L(M.value?"Generating...":"Download Image"),1)],8,pt)]),n("div",gt,[n("div",ht,[n("div",ft,[n("div",{class:"template-preview-container relative overflow-hidden bg-gray-50 dark:bg-gray-700 shadow-lg",style:D(le.value),onMousemove:ne,onMouseup:ie},[(_(!0),P(re,null,ue(ae.value,e=>(_(),P("div",{key:e.id,class:"absolute",style:D({left:e.x*b.value+"px",top:e.y*b.value+"px",width:e.width*b.value+"px",height:e.height*b.value+"px",zIndex:e.zIndex,transform:`rotate(${e.rotation}deg)`,filter:e.properties.boxShadow!=="none"?`drop-shadow(${e.properties.boxShadow})`:"none"})},[e.type==="text"?(_(),P("div",{key:0,class:"w-full h-full flex items-center justify-center cursor-move select-none",style:D({color:e.properties.color,backgroundColor:e.properties.backgroundColor,fontSize:e.properties.fontSize*b.value+"px",fontFamily:e.properties.fontFamily,fontWeight:e.properties.fontWeight,fontStyle:e.properties.fontStyle,textDecoration:e.properties.textDecoration,textAlign:e.properties.textAlign,lineHeight:e.properties.lineHeight,border:e.properties.hasBorder?`${e.properties.strokeWidth*b.value}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.borderRadius*b.value+"px",padding:8*b.value+"px",boxSizing:"border-box",wordWrap:"break-word",overflow:"hidden"}),onMousedown:u=>Q(u,e)},L(e.properties.text||"Your text here"),45,yt)):e.type==="image"?(_(),P("div",{key:1,class:"w-full h-full flex items-center justify-center overflow-hidden relative group",style:D({backgroundColor:e.properties.backgroundColor||"transparent",border:e.properties.hasBorder?`${e.properties.strokeWidth*b.value}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:e.properties.imageShape==="rectangle"?(e.properties.borderRadius||0)*b.value+"px":"0px",clipPath:se(e.properties.imageShape||"rectangle")}),onMousedown:u=>Q(u,e)},[e.properties.imageUrl?(_(),P("img",{key:0,src:e.properties.imageUrl,alt:e.properties.imagePlaceholder,class:"absolute cursor-move select-none",style:D({width:"auto",height:"auto",maxWidth:"none",maxHeight:"none",objectFit:"none",transform:e.properties.cropScale?`translate(-50%, -50%) scale(${e.properties.cropScale}) translate(${(e.properties.cropPositionX||0)*b.value}px, ${(e.properties.cropPositionY||0)*b.value}px)`:"translate(-50%, -50%)",top:"50%",left:"50%",transformOrigin:"center"}),onClick:u=>c(u,e),onMousedown:u=>h(u,e)},null,44,vt)):(_(),P("div",bt,[$(B(de),{class:"opacity-60",style:D({width:Math.min(e.width*b.value*.4,32)+"px",height:Math.min(e.height*b.value*.4,32)+"px"})},null,8,["style"])]))],44,mt)):e.type==="rectangle"?(_(),P("div",{key:2,class:"w-full h-full",style:D({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",borderRadius:(e.properties.borderRadius||0)+"px"})},null,4)):e.type==="circle"?(_(),P("div",{key:3,class:"w-full h-full rounded-full",style:D({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none"})},null,4)):e.type==="triangle"?(_(),P("div",{key:4,class:"w-full h-full",style:D({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 0% 100%, 100% 100%)"})},null,4)):e.type==="star"?(_(),P("div",{key:5,class:"w-full h-full",style:D({backgroundColor:e.properties.fillColor||"#ffffff",border:e.properties.hasBorder?`${e.properties.strokeWidth}px ${e.properties.borderStyle} ${e.properties.strokeColor}`:"none",clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)"})},null,4)):ee("",!0)],4))),128))],36)])])])])])])])],32)],64))}});export{Ct as default};
